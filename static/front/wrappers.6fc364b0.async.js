(self.webpackChunktone_front=self.webpackChunktone_front||[]).push([[5275],{83707:function(F,b,s){"use strict";s.r(b);var p=s(39428),r=s(11849),B=s(3182),I=s(67294),l=s(20009),w=s(16917),R=s(85304),n=s(24480),U=s(60035);b.default=function(y){var K=y.children,W=(0,l.TH)(),a=W.pathname,M=(0,l.$B)(),k=M.url,S=M.path,g=(0,l.UO)(),t=g.ws_id,O=(0,w.tT)("@@initialState"),D=O.initialState,d=O.setInitialState,P=D.authList,j=function(){var o=(0,B.Z)((0,p.Z)().mark(function L(){var c,f,T,_,i,u,m,C,v,h,Z,A;return(0,p.Z)().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(c=P,f=P.ws_id,!(!f||f!==t)){e.next=20;break}return d(function(E){return(0,r.Z)((0,r.Z)({},E),{},{listFetchLoading:!0,wsList:void 0})}),e.next=6,(0,R.Z9)({ws_id:t});case 6:return T=e.sent,_=T.data,d((0,r.Z)((0,r.Z)({},D),{},{authList:(0,r.Z)((0,r.Z)({},_),{},{ws_id:t}),listFetchLoading:!0})),c=_,e.next=12,(0,U.lB)(t);case 12:if(i=e.sent,d(function(E){return(0,r.Z)((0,r.Z)((0,r.Z)({},E),i),{},{listFetchLoading:!1})}),!(i!=null&&i.first_entry&&(_==null?void 0:_.ws_role_title)==="ws_owner")){e.next=17;break}return w.m8.push("/ws/".concat(t,"/workspace/initSuccess")),e.abrupt("return");case 17:if(_){e.next=20;break}return(0,n.CT)(500),e.abrupt("return");case 20:if(u=c,m=u.ws_role_title,C=u.ws_is_exist,v=u.sys_role_title,e.prev=21,!(!!~(a==null||(h=a.replace(k,S))===null||h===void 0?void 0:h.indexOf("/ws/:ws_id/device"))&&(0,n.Jq)().includes(t))){e.next=27;break}if(Z=["ws_member","ws_tourist"].includes(m),A=["sys_admin"].includes(v),!(!A&&Z)){e.next=27;break}return e.abrupt("return",(0,n.CT)(401));case 27:e.next=31;break;case 29:e.prev=29,e.t0=e.catch(21);case 31:if(C){e.next=33;break}return e.abrupt("return",(0,n.CT)(404));case 33:if(!(v!=="sys_admin"&&!m)){e.next=35;break}return e.abrupt("return",(0,n.CT)(401));case 35:case"end":return e.stop()}},L,null,[[21,29]])}));return function(){return o.apply(this,arguments)}}();return(0,I.useEffect)(function(){[404,401,500].map(function(o){return"/ws/".concat(t,"/").concat(o)}).includes(a)||j()},[a,t]),K}}}]);
