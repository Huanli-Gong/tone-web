(self.webpackChunktone_front=self.webpackChunktone_front||[]).push([[476,2485],{88062:function($){$.exports={pagination:"pagination___ooSI8",hidden:"hidden___3mzqN",table_empty:"table_empty___KRJ5E"}},19137:function($){$.exports={filter:"filter___1IKYx",confirm:"confirm___3RbBO",domain:"domain___1-UgM"}},65113:function($){$.exports={layout:"layout___3rpA5",side:"side___1Eun6",menu:"menu___3HFIQ",menuItem:"menuItem___3mKuU",selected:"selected___1JoUm",tab_style:"tab_style___qheVA"}},15468:function($){$.exports={roleStyle:"roleStyle___3h1c4"}},82078:function($,N,e){"use strict";var a=e(67448),m=e(47548),i=e(36142),w=e(76837),B=e(20418),te=e(488),H=e(22374),F=e(22812),M=e(88062),n=e.n(M),V=e(79390),u=e(52454),A=["total","loading","handlePage","showPagination","page","paginationBottom","pageSize","className"],_=function(E){var Re=E.total,D=Re===void 0?0:Re,Se=E.loading,I=E.handlePage,W=E.showPagination,K=W===void 0?!0:W,Ze=E.page,Oe=Ze===void 0?1:Ze,ye=E.paginationBottom,v=ye===void 0?!1:ye,ce=E.pageSize,fe=ce===void 0?10:ce,ne=E.className,t=(0,te.Z)(E,A),j=(0,F.YB)(),d=j.formatMessage,x=(0,H.useRef)(null),C=function L(f){var O=f.offsetTop;return f.offsetParent!=null&&(O+=L(f.offsetParent)),O},T=function(){var f=C(x.current);if(f!=0){var O=f-200;f<=377&&(O=f-377),window.scrollTo({top:O,behavior:"smooth"})}};return(0,u.jsxs)(m.Z,{spinning:Se,children:[(0,u.jsx)("div",{ref:x}),(0,u.jsx)(V.sL,(0,B.Z)({size:"small",className:"".concat(n().table_empty," ").concat(ne),pagination:!1},t)),K&&(0,u.jsx)("div",{className:"".concat(v?null:"common_pagination"," ").concat(!Se&&D?n().pagination:n().hidden),children:D>=1&&(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)("div",{className:D==0?n().hidden:"",children:d({id:"pagination.total.strip"},{data:D})}),(0,u.jsx)(w.Z,{className:D==0?n().hidden:"",showQuickJumper:!0,showSizeChanger:!0,current:Oe,pageSize:fe,defaultCurrent:1,size:"small",onChange:function(f,O){I(f,O),T()},onShowSizeChange:function(f,O){I(f,O),T()},total:D})]})})]})};N.Z=_},15122:function($,N,e){"use strict";var a=e(46721),m=e(94867),i=e(8281),w=e(58591),B=e(57359),te=e(34423),H=e(88966),F=e(11048),M=e(39190),n=e(22374),V=e(19137),u=e.n(V),A=e(39935),_=e(22812),l=e(52454),E=function(D){var Se=D.list,I=D.confirm,W=D.onConfirm,K=D.roleType,Ze=(0,_.YB)(),Oe=Ze.formatMessage,ye=(0,n.useState)(),v=(0,M.Z)(ye,2),ce=v[0],fe=v[1],ne=function(j){fe(j.target.value)};return(0,l.jsxs)("div",{className:u().filter,children:[(0,l.jsx)(F.ZP.Group,{onChange:ne,value:ce,children:(0,l.jsx)(te.Z,{direction:"vertical",children:Se.map(function(t){return(0,l.jsx)(F.ZP,{className:u().domain,value:t.id,children:K==="role"?(0,A.u)(t.name,Oe):t.name},t.id)})})}),(0,l.jsx)(w.Z,{style:{margin:"10px 0"}}),(0,l.jsxs)("div",{className:u().confirm,children:[(0,l.jsx)(m.Z,{size:"small",type:"link",style:{border:"none"},onClick:function(){I==null||I(),W(ce)},children:(0,l.jsx)(_._H,{id:"operation.ok"})}),(0,l.jsx)(m.Z,{size:"small",type:"text",onClick:function(){I==null||I(),fe(void 0),W(void 0)},children:(0,l.jsx)(_._H,{id:"operation.reset"})})]})]})};N.Z=E},75073:function($,N,e){"use strict";e.d(N,{mQ:function(){return M},gM:function(){return n},nU:function(){return u}});var a=e(40204),m=e(10724),i=e(41428),w=e(97939),B,te,H,F,M=(0,w.ZP)(m.Z)(B||(B=(0,i.Z)([`
    border:none !important;
    .ant-card-head {
        min-height: 48px;
        .ant-tabs-tab { min-height : 48px; }
        .ant-card-head-title{
            padding: 0;
        }
        .ant-card-extra {
            padding: 0;
        }
    }
    .common_pagination { padding-bottom:0 ;}
`]))),n=(0,w.ZP)(M)(te||(te=(0,i.Z)([`
    border:none!important;
    .ant-card-head .ant-card-head-wrapper { min-height:48px; }
    .ant-card-head-title { font-weight: normal; font-size:14px;}
    .commom_pagination { margin-bottom:0 ;}
    .ant-tabs-nav { margin : 0 ;}
    .ant-spin-nested-loading > div > .ant-spin {
        position: fixed;
        left: 50%;
        top: 50%;
        transform: translate(-50%, -50%);
    }
`]))),V=(0,w.ZP)(m.Z)(H||(H=(0,i.Z)([`
    border:none !important;
    .ant-card-head {
        min-height: 48px;
        padding: 0 32px;
        .ant-tabs-tab { min-height : 48px; }
        .ant-card-head-title{
            padding: 0;
        }
        .ant-card-extra {
            padding: 0;
        }
    }
    .ant-card-body{
        padding: 24px 24px 24px 0px;
    }
    .common_pagination { padding-bottom:0 ;}
`]))),u=(0,w.ZP)(V)(F||(F=(0,i.Z)([`
    border:none!important;
    .ant-card-head .ant-card-head-wrapper { min-height:48px; }
    .ant-card-head-title { font-weight: normal; font-size:14px;}
    .commom_pagination { margin-bottom:0 ;}
    .ant-tabs-nav { margin : 0 ;}
    .ant-spin-nested-loading > div > .ant-spin {
        position: fixed;
        left: 50%;
        top: 50%;
        transform: translate(-50%, -50%);
    }
`])))},28391:function($,N,e){"use strict";e.r(N),e.d(N,{default:function(){return le}});var a=e(35832),m=e(32326),i=e(39190),w=e(69230),B=e(33821),te=e(20693),H=e(3278),F=e(54905),M=e(90087),n=e(22374),V=e(20632),u=e(71853),A=e(31650),_=e(25100),l=e(57359),E=e(34423),Re=e(98604),D=e(68917),Se=e(81138),I=e(96146),W=e(20418),K=e(66804),Ze=e(76742),Oe=e(67448),ye=e(47548),v=e(22812),ce=e(15468),fe=e.n(ce),ne=e(39935),t=e(52454),j=function(h){var b=h.row,Z=h.select,U=(0,v.YB)(),o=U.formatMessage,Y=(0,n.useState)(!1),X=(0,i.Z)(Y,2),J=X[0],ie=X[1],Q=(0,n.useState)(void 0),G=(0,i.Z)(Q,2),ue=G[0],k=G[1],S=B.Z.Option,q=function(){var P=(0,m.Z)((0,a.Z)().mark(function me(p){var _e;return(0,a.Z)().wrap(function(ve){for(;;)switch(ve.prev=ve.next){case 0:return ie(!0),ve.next=3,(0,K.C2)({user_id:b.id,role_id:p});case 3:_e=ve.sent,ie(!1),_e.code===200?(I.default.success(o({id:"user.role.edit.successfully"})),k(p)):(0,ne.EV)(_e.code,_e.msg);case 6:case"end":return ve.stop()}},me)}));return function(p){return P.apply(this,arguments)}}();return(0,n.useEffect)(function(){k(b.role_list.map(function(P){return P.id})[0])},[b.role_list]),(0,t.jsx)(ye.Z,{spinning:J,children:(0,t.jsx)("div",{className:fe().roleStyle,children:(0,t.jsx)(B.Z,{size:"small",placeholder:(0,t.jsx)(v._H,{id:"user.please.select.role"}),value:ue,style:{marginLeft:-10},dropdownMatchSelectWidth:!1,bordered:!1,showArrow:!0,onSelect:q,children:Z.map(function(P){return(0,t.jsx)(S,{value:P.id,children:(0,ne.u)(P.name,o)},P.id)})})})})},d=j,x=e(15122),C=e(44851),T=e.n(C),L=e(12590),f=e(31784),O=e(67515),ze=e(41083),Le=e(14320),Ee=e(53479),xe=function(h,b){var Z=(0,n.useState)({}),U=(0,i.Z)(Z,2),o=U[0],Y=U[1],X=(0,n.useState)(!1),J=(0,i.Z)(X,2),ie=J[0],Q=J[1],G=(0,n.useState)(""),ue=(0,i.Z)(G,2),k=ue[0],S=ue[1];(0,n.useImperativeHandle)(b,function(){return{show:function(me,p){Y(me),Q(!0),p&&S(p)}}});var q=function(){Y({}),Q(!1),S("")};return(0,t.jsx)(ze.Z,{title:k||(0,t.jsx)(v._H,{id:"operation.reset.password.succeeded"}),open:ie,onCancel:q,okText:(0,t.jsx)(v._H,{id:"operation.ok"}),footer:!1,onOk:q,width:"40%",children:(0,t.jsx)(Ee.Z,{style:{padding:30},children:(0,t.jsxs)(E.Z,{direction:"vertical",children:[(0,t.jsxs)(E.Z,{children:[(0,t.jsx)(_.Z.Text,{children:(0,t.jsx)(v._H,{id:"user.username"})}),(0,t.jsx)(_.Z.Text,{children:o==null?void 0:o.username})]}),(0,t.jsxs)(E.Z,{align:"center",children:[(0,t.jsx)(_.Z.Text,{children:(0,t.jsx)(v._H,{id:"user.new.password"})}),(0,t.jsx)(_.Z.Paragraph,{style:{marginBottom:0},copyable:{text:o.password},children:o==null?void 0:o.password})]})]})})})},Pe=(0,n.forwardRef)(xe),De=e(96579),ae=e(6130),be=e(79390),Ie=function(h){var b={};return h&&Object.keys(h).forEach(function(Z){(h[Z]||[0,!1].includes(h[Z]))&&(b[Z]=h[Z])}),b},Me=function(h){var b=h.onRef,Z=h.select,U=h.rolelist,o=h.callbackTotal,Y=(0,v.YB)(),X=Y.formatMessage,J=(0,n.useState)(!0),ie=(0,i.Z)(J,2),Q=ie[0],G=ie[1],ue=(0,n.useState)({data:[],total:0,total_page:0,page_num:1,page_size:10}),k=(0,i.Z)(ue,2),S=k[0],q=k[1],P=(0,n.useState)({last_name:"",role_id:""}),me=(0,i.Z)(P,2),p=me[0],_e=me[1],Ke=(0,n.useState)(!0),ve=(0,i.Z)(Ke,2),Ue=ve[0],$e=ve[1],Be=(0,n.useRef)(null),Ae=function(){var c=(0,m.Z)((0,a.Z)().mark(function s(r){var g,R,de;return(0,a.Z)().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:return g=(0,W.Z)((0,W.Z)({},p),r),R=Ie(g),G(!0),y.prev=3,y.next=6,(0,K.wD)(R);case 6:de=y.sent,de.code===200?(q(de),o(de.total)):(q({data:[],total:0,total_page:0,page_num:1,page_size:10}),o(0)),G(!1),y.next=14;break;case 11:y.prev=11,y.t0=y.catch(3),G(!1);case 14:case"end":return y.stop()}},s,null,[[3,11]])}));return function(r){return c.apply(this,arguments)}}();(0,n.useEffect)(function(){Ae({page_num:1,page_size:S.page_size})},[p.last_name,p.role_id]);var Ve=function(s,r){Ae({page_num:s,page_size:r})},Ye=function(){var c=(0,m.Z)((0,a.Z)().mark(function s(r,g){var R,de;return(0,a.Z)().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:return R={user_id:g.id,role_id:r},y.next=3,(0,K.C2)(R);case 3:de=y.sent,de.code===200?(I.default.success(X({id:"operation.success"})),Ae({page_num:S.page_num,page_size:S.page_size})):I.default.error(de.msg);case 5:case"end":return y.stop()}},s)}));return function(r,g){return c.apply(this,arguments)}}(),Ce=function(){var c=(0,m.Z)((0,a.Z)().mark(function s(r){var g,R,de,We,y;return(0,a.Z)().wrap(function(Te){for(;;)switch(Te.prev=Te.next){case 0:return Te.next=2,(0,K.VK)({user_id:r.id});case 2:if(R=Te.sent,de=R.code,We=R.data,y=R.msg,de===200){Te.next=9;break}return I.default.error(y!=null?y:We),Te.abrupt("return");case 9:(g=Be.current)===null||g===void 0||g.show({password:We,username:r.username});case 10:case"end":return Te.stop()}},s)}));return function(r){return c.apply(this,arguments)}}(),ee=[{title:(0,t.jsx)(v._H,{id:"user.last_name"}),dataIndex:"last_name",width:200,ellipsis:{showTitle:!1},render:function(s,r){return(0,t.jsxs)(E.Z,{children:[r.avatar?(0,t.jsx)(D.C,{size:25,src:r.avatar,alt:r.last_name}):(0,t.jsx)(De.Z,{size:25,show_name:r.last_name||r.username,theme_color:r.avatar_color,shape:"circle"}),(0,t.jsx)(T(),{highlightStyle:{backgroundColor:"#ffc069",padding:0},searchWords:[p.last_name||""],autoEscape:!0,textToHighlight:r.last_name.toString()})]})},filterIcon:function(){return(0,t.jsx)(f.Z,{style:{color:p.last_name?"#1890ff":void 0}})},filterDropdown:function(s){var r=s.confirm;return(0,t.jsx)(L.Z,{confirm:r,autoFocus:Ue,onConfirm:function(R){return _e((0,W.Z)((0,W.Z)({},p),{},{last_name:R}))}})},onFilterDropdownVisibleChange:function(s){s&&$e(!Ue)}},{title:(0,t.jsx)(v._H,{id:"user.email"}),dataIndex:"email",width:200,ellipsis:{showTitle:!1},render:function(s,r){return(0,t.jsx)(ae.K,{ellipsis:{tooltip:!0},children:r.username})}},{title:(0,t.jsx)(v._H,{id:"user.role_list"}),dataIndex:"role_list",render:function(s,r){return Z&&Z.length>0&&(0,t.jsx)(d,{row:r,select:Z,handleChange:Ye})},width:170,filterIcon:function(){return(0,t.jsx)(f.Z,{style:{color:p.role_id?"#1890ff":void 0}})},filterDropdown:function(s){var r=s.confirm;return(0,t.jsx)(x.Z,{list:U,confirm:r,onConfirm:function(R){return _e((0,W.Z)((0,W.Z)({},p),{},{role_id:R}))},roleType:"role"})},onFilterDropdownVisibleChange:function(s){s&&$e(!Ue)}},{title:"Workspace",dataIndex:"ws_list",render:function(s,r){return r.ws_list&&r.ws_list.length>0&&(0,t.jsx)(ae.K,{ellipsis:{tooltip:!0},children:r.ws_list.join("\u3001")})},ellipsis:{showTitle:!1},width:300},{title:(0,t.jsx)(v._H,{id:"user.gmt_created"}),dataIndex:"gmt_created",width:145,ellipsis:{showTitle:!1}},{title:(0,t.jsx)(v._H,{id:"Table.columns.operation"}),key:"operation",fixed:"right",width:200,render:function(s,r){return(0,t.jsx)(u.Z,{title:(0,t.jsx)(v._H,{id:"user.Popconfirm.title"}),onConfirm:function(){return Ce(r)},okButtonProps:{type:"primary",danger:!0},okText:(0,t.jsx)(v._H,{id:"operation.confirm.reset"}),onVisibleChange:function(){return console.log("visible change")},children:(0,t.jsx)(_.Z.Link,{children:(0,t.jsx)(v._H,{id:"operation.reset.password"})})})}}].filter(function(c){return c});return(0,t.jsxs)("div",{children:[(0,t.jsx)(be.sL,{loading:Q,name:"system-user-management-column",rowKey:"id",size:"small",columns:ee,dataSource:S.data,pagination:!1,scroll:{x:"100%"}}),(0,t.jsx)(Ze.Z,{size:"default",pageSize:S.page_size,currentPage:S.page_num,total:(S==null?void 0:S.total)||0,onPageChange:Ve}),(0,t.jsx)(Pe,{ref:Be})]})},je=Me,re=e(82078),se=function(){var h=(0,v.YB)(),b=h.formatMessage,Z=(0,n.useState)(),U=(0,i.Z)(Z,2),o=U[0],Y=U[1],X=(0,n.useState)(!1),J=(0,i.Z)(X,2),ie=J[0],Q=J[1],G=function(){var k=(0,m.Z)((0,a.Z)().mark(function S(){var q,P;return(0,a.Z)().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return Q(!0),p.next=3,(0,K.Uy)({role_type:""});case 3:q=p.sent,P=q.data,Q(!1),P&&Y(P);case 7:case"end":return p.stop()}},S)}));return function(){return k.apply(this,arguments)}}();(0,n.useEffect)(function(){G()},[]);var ue=[{title:(0,t.jsx)(v._H,{id:"user.role_name"}),dataIndex:"title",render:function(S){return(0,ne.u)(S,b)}},{title:(0,t.jsx)(v._H,{id:"user.role_desc"}),dataIndex:"description"}];return(0,t.jsx)("div",{children:(0,t.jsx)(re.Z,{size:"small",columns:ue,name:"sys-user-manage",dataSource:(o==null?void 0:o.list)||[],loading:ie,page:o==null?void 0:o.page_num,pageSize:o==null?void 0:o.page_size,totalPage:o==null?void 0:o.total_page,total:o==null?void 0:o.total,scroll:{x:"100%"}})})},we=se,He=e(65113),Ne=e.n(He),Fe=e(75073),oe=M.Z.TabPane,z=H.Z.Search,ge=B.Z.Option,he=function(){var h=(0,v.YB)(),b=h.formatMessage,Z=(0,n.useState)([]),U=(0,i.Z)(Z,2),o=U[0],Y=U[1],X=(0,n.useState)([]),J=(0,i.Z)(X,2),ie=J[0],Q=J[1],G=(0,n.useState)(0),ue=(0,i.Z)(G,2),k=ue[0],S=ue[1],q=(0,n.useState)(0),P=(0,i.Z)(q,2),me=P[0],p=P[1],_e=function(){var Ce=(0,m.Z)((0,a.Z)().mark(function ee(){var c,s;return(0,a.Z)().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,(0,K.Uy)({role_type:"system",is_filter:"1"});case 2:c=g.sent,s=c.data,s&&Y(s.list),s&&S(s.num);case 6:case"end":return g.stop()}},ee)}));return function(){return Ce.apply(this,arguments)}}(),Ke=function(){var Ce=(0,m.Z)((0,a.Z)().mark(function ee(){var c,s;return(0,a.Z)().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,(0,K.Uy)({role_type:""});case 2:c=g.sent,s=c.total,s&&p(s);case 5:case"end":return g.stop()}},ee)}));return function(){return Ce.apply(this,arguments)}}(),ve=function(){var Ce=(0,m.Z)((0,a.Z)().mark(function ee(){var c,s,r;return(0,a.Z)().wrap(function(R){for(;;)switch(R.prev=R.next){case 0:return R.next=2,(0,K.Uy)({role_type:"system",is_filter:"0"});case 2:c=R.sent,s=c.data,r=[{id:"",name:"all",title:"all"}],s&&Q(r.concat(s.list||[]));case 6:case"end":return R.stop()}},ee)}));return function(){return Ce.apply(this,arguments)}}();(0,n.useEffect)(function(){return Ke(),_e(),ve(),function(){Q([])}},[]);var Ue=(0,n.useRef)(null),$e=(0,n.useState)("1"),Be=(0,i.Z)($e,2),Ae=Be[0],Ve=Be[1],Ye=function(ee){Ve(ee)};return(0,t.jsx)(Fe.mQ,{title:(0,t.jsxs)(M.Z,{defaultActiveKey:"1",onChange:Ye,className:Ne().tab_style,children:[(0,t.jsx)(oe,{tab:"".concat(b({id:"user.tab.user"})," ").concat(k)},"1"),(0,t.jsx)(oe,{tab:"".concat(b({id:"user.tab.role"})," ").concat(me)},"2")]}),children:Ae==="1"?!!o.length&&(0,t.jsx)(je,{onRef:Ue,select:o,rolelist:ie,callbackTotal:S}):(0,t.jsx)(we,{})})},le=he},66804:function($,N,e){"use strict";e.d(N,{Uy:function(){return w},wD:function(){return te},C2:function(){return F},VK:function(){return n}});var a=e(35832),m=e(32326),i=e(22812);function w(u){return B.apply(this,arguments)}function B(){return B=(0,m.Z)((0,a.Z)().mark(function u(A){return(0,a.Z)().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",(0,i.WY)("/api/auth/role/",{params:A}));case 1:case"end":return l.stop()}},u)})),B.apply(this,arguments)}function te(u){return H.apply(this,arguments)}function H(){return H=(0,m.Z)((0,a.Z)().mark(function u(A){return(0,a.Z)().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",(0,i.WY)("/api/auth/user/",{params:A}));case 1:case"end":return l.stop()}},u)})),H.apply(this,arguments)}function F(u){return M.apply(this,arguments)}function M(){return M=(0,m.Z)((0,a.Z)().mark(function u(A){return(0,a.Z)().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",(0,i.WY)("/api/auth/user/",{method:"POST",data:A}));case 1:case"end":return l.stop()}},u)})),M.apply(this,arguments)}function n(u){return V.apply(this,arguments)}function V(){return V=(0,m.Z)((0,a.Z)().mark(function u(A){return(0,a.Z)().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",(0,i.WY)("/api/auth/reset_password/",{method:"POST",data:A}));case 1:case"end":return l.stop()}},u)})),V.apply(this,arguments)}},79390:function($,N,e){"use strict";e.d(N,{sL:function(){return t},ny:function(){return fe},Fu:function(){return ne}});var a=e(20418),m=e(39190),i=e(488),w=e(26388),B=e(11407),te=e(41604),H=e(2605),F=e(74127),M=e(41428),n=e(22374),V=e(48434),u=e(97939),A=e(99648),_=e(52454),l=["width","onResizeStart","onResize","onResizeStop","resize"],E=["columns","name","onColumnsChange"],Re,D,Se,I=u.ZP.div(Re||(Re=(0,M.Z)([`
    position: relative;
    width: 100%;
`]))),W=u.ZP.div.attrs(function(j){return{style:{left:j.left,height:j==null?void 0:j.height}}})(D||(D=(0,M.Z)([`
    width: 0px;
    position: absolute;
    left: 0;
    top: 0;
    border-left: 1px dashed #d9d9d9;
    z-index: 99;
`]))),K=(0,u.ZP)(V.Resizable)(Se||(Se=(0,M.Z)([`
    user-select: none;
    &::before {
        position: absolute;
        top: 50%;
        right: 0;
        width: 1px;
        height: 1.6em;
        background-color: rgba(0,0,0,.06);
        transform: translateY(-50%);
        transition: background-color .3s;
        content: "";
    }
    
    &:last-child::before {
        display: none;
    }

    .react-resizable {
        position: relative;
        background-clip: padding-box;
    }
    
    .react-resizable-handle {
        position: absolute;
        width: 10px;
        height: 100%;
        bottom: 0;
        right: -5px;
        cursor: `,`;
        background-image:none;
        z-index: 1;
    }
`])),function(j){var d=j.resize;return d?"col-resize":"default"}),Ze=function(d){var x=d.width,C=d.onResizeStart,T=d.onResize,L=d.onResizeStop,f=d.resize,O=(0,i.Z)(d,l);return(0,_.jsx)(K,(0,a.Z)((0,a.Z)({width:x||100,height:0,draggableOpts:{enableUserSelectHack:!1},onResizeStart:C,onResize:T,onResizeStop:L,resize:f?1:0},O),{},{children:(0,_.jsx)("th",(0,a.Z)({},O))}))},Oe=function(d){var x=d.columns,C=x===void 0?[]:x,T=d.name,L=d.onColumnsChange,f=(0,i.Z)(d,E),O=n.useState(0),ze=(0,m.Z)(O,2),Le=ze[0],Ee=ze[1],xe=n.useState(0),Pe=(0,m.Z)(xe,2),De=Pe[0],ae=Pe[1],be=n.useState(!1),Ie=(0,m.Z)(be,2),Me=Ie[0],je=Ie[1],re=n.useRef(null),se=(0,A.Z)(re),we=function(z){return function(ge,he){var le;if((0,F.Z)(he),!!C[z].ellipsis){var pe=ge.clientX,h=pe-((le=re.current)===null||le===void 0?void 0:le.getBoundingClientRect().x);ae(h),Ee(h),je(!0)}}},He=function(){return function(z){var ge,he=z.clientX,le=he-((ge=re.current)===null||ge===void 0?void 0:ge.getBoundingClientRect().x);Ee(le)}},Ne=function(z){return function(ge,he){var le,pe=he.size,h=ge.clientX,b=h-((le=re.current)===null||le===void 0?void 0:le.getBoundingClientRect().x),Z=(0,H.Z)(C);if(Z[z].ellipsis){var U=pe.width+=b-De,o=Z[z],Y=o.dataIndex,X=o.key;U>20&&(Z[z]=(0,a.Z)((0,a.Z)({},Z[z]),{},{width:U}),T&&ne(T,Y||X,U),L==null||L())}Ee(0),ae(0),je(!1)}},Fe=n.useMemo(function(){return C.reduce(function(oe,z){return z.width?oe+=z==null?void 0:z.width:oe},0)},[C]);return(0,_.jsxs)(I,{ref:re,className:"resize-table-wrapper",children:[(0,_.jsx)(te.Z,(0,a.Z)((0,a.Z)({},f),{},{components:{header:{cell:Ze}},scroll:(d==null?void 0:d.scroll)||{x:Fe||(se==null?void 0:se.width)},columns:C.filter(Boolean).map(function(oe,z){return(0,a.Z)((0,a.Z)({},oe),{},{onHeaderCell:function(he){return{resize:!!oe.ellipsis,width:he.width,onResizeStart:we(z),onResize:He(),onResizeStop:Ne(z)}}})})})),Me&&(0,_.jsx)(W,{height:se==null?void 0:se.height,left:Le||De})]})},ye=Oe,v=["name","columns","refreshDeps","onColumnsChange"],ce="umi_locale",fe=function(d,x){var C=localStorage.getItem(d),T=localStorage.getItem(ce)||"zh-CN";if(!!C)return JSON.parse(C)["".concat(T,"-").concat(x)]},ne=function(d,x,C){var T=localStorage.getItem(d),L=localStorage.getItem(ce)||"zh-CN",f=(0,w.Z)({},"".concat(L,"-").concat(x),C);T?localStorage.setItem(d,JSON.stringify(Object.assign(JSON.parse(T),f))):localStorage.setItem(d,JSON.stringify(f))},t=function(d){var x=d.name,C=d.columns,T=d.refreshDeps,L=T===void 0?[]:T,f=d.onColumnsChange,O=(0,i.Z)(d,v),ze=n.useState([]),Le=(0,m.Z)(ze,2),Ee=Le[0],xe=Le[1],Pe=function(){return(C==null?void 0:C.filter(Boolean).map(function(ae){var be=ae.dataIndex,Ie=ae.key,Me=ae.width,je=be||Ie,re=fe(x,je);!re&&Me&&ne(x,je,Me);var se=re||Me;return se&&(ae.width=se),ae}))||[]};return n.useEffect(function(){xe(Pe())},L),(0,_.jsx)(ye,(0,a.Z)({name:x,columns:Ee,setColumns:xe,size:"small",onColumnsChange:function(){f==null||f(),xe(Pe())}},O))}}}]);
