(self.webpackChunktone_front=self.webpackChunktone_front||[]).push([[2974],{64834:function(Qt,rt,t){"use strict";t.r(rt),t.d(rt,{default:function(){return qe}});var Xt=t(89032),K=t(15746),kt=t(57663),Ce=t(71577),vt=t(32059),v=t(11849),qt=t(34792),Oe=t(48086),M=t(39428),z=t(3182),x=t(2824),s=t(67294),de=t(54732),ee=t(20009),o=t(16917),Le=t(50238),ht=t(58491),At=t(54564);function mt(S){return w.apply(this,arguments)}function w(){return w=_asyncToGenerator(_regeneratorRuntime().mark(function S(u){return _regeneratorRuntime().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",request("/api/sys/workspace/",{params:u}));case 1:case"end":return r.stop()}},S)})),w.apply(this,arguments)}function Ft(S){return Ye.apply(this,arguments)}function Ye(){return Ye=_asyncToGenerator(_regeneratorRuntime().mark(function S(u){return _regeneratorRuntime().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",request("/api/job/result/compare/chart/",{data:u,method:"post"}));case 1:case"end":return r.stop()}},S)})),Ye.apply(this,arguments)}function _t(S){return J.apply(this,arguments)}function J(){return J=(0,z.Z)((0,M.Z)().mark(function S(u){return(0,M.Z)().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(0,o.WY)("/api/job/result/compare/form/",{data:u,method:"post"}));case 1:case"end":return r.stop()}},S)})),J.apply(this,arguments)}function te(S){return Qe.apply(this,arguments)}function Qe(){return Qe=(0,z.Z)((0,M.Z)().mark(function S(u){return(0,M.Z)().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(0,o.WY)("/api/job/result/compare/form/",{params:u}));case 1:case"end":return r.stop()}},S)})),Qe.apply(this,arguments)}var nt=t(51017),m=(0,s.createContext)(null),Te=t(66886),l=t(80015),xt=t(49301),e=t(85893),jt=function(){var u=(0,s.useContext)(m),a=u.envData,r=u.environmentResult,n=u.group,d=(0,o.Kd)()==="en-US";return(0,e.jsxs)(l.KP,{id:"need_test_env",children:[(0,e.jsxs)(l.DK,{children:[(0,e.jsx)("span",{className:"line"}),(0,e.jsx)(o._H,{id:"analysis.test.env"})]}),(0,e.jsxs)(l.HA,{children:[(0,e.jsx)(l.i1,{enLocale:d,children:(0,e.jsx)(o._H,{id:"analysis.comparison.group.name"})}),(0,e.jsx)(Te.Z,{enLocale:d,envData:a,group:n})]}),(0,e.jsx)(xt.c,{envData:a,environmentResult:r,group:n})]})},gt=(0,s.memo)(jt),ge=t(13254),re=t(14277),Ht=t(22385),yt=t(89456),Gt=t(13062),Y=t(71230),Wt=t(49111),U=t(19650),Bt=t(402),$=t(97272),Zt=t(20310),st=t(43358),ce=t(34041),Xe=t(21118),lt=t(59954),it=t(1870),ne=t(39954),ot=t(56079),ke=t(76161),St=t(96486),ve=t.n(St),ut=t(95545),ye=t(14552),Et=t(12788),Ie=t(60035),he=t(24480),me,_e=ce.Z.Option,Dt=Et.ZP.div(me||(me=(0,Zt.Z)([`
    background: #fff;
    position: absolute;
    top: 57px;
    height: 50px;
    // willChange: transform;
    border: 1px solid rgba(0,0,0,0.10);
    z-index: 5;
    width:`,`px;
    transform:translateY(`,`px);
`])),function(S){var u=S.width;return u||0},function(S){var u=S.y;return u||0}),dt=function(u){var a=u.groupRowRef,r=u.parentDom,n=u.groupLen,d=u.envData,y=(0,Le.Z)(document.querySelector(".ant-layout-has-sider .ant-layout")),P=y.top,_=a.current,se=r.current;if(!_&&!se)return(0,e.jsx)(e.Fragment,{});var b=se.offsetTop||0,xe=_==null?void 0:_.offsetWidth,G=P>b+_.offsetTop;return G?(0,e.jsx)(Dt,{width:xe,y:P-b-_.offsetTop,children:(0,e.jsx)(l.ER,{style:{border:"none",paddingLeft:18,paddingRight:15},children:(0,e.jsxs)(l.ZA,{children:[(0,e.jsx)(l.Ll,{gLen:n,children:(0,e.jsx)(o._H,{id:"analysis.comparison.group.name"})}),(0,e.jsx)(Te.Z,{envData:d,group:n,isData:!0})]})})}):(0,e.jsx)(e.Fragment,{})},Ze=["decline","increase","normal","invalid","na"],Rt=function(u){return function(a,r){return a[u]-r[u]}},Pt=function(u){var a=(0,o.YB)(),r=a.formatMessage,n=(0,s.useContext)(m),d=n.compareResult,y=n.allGroupData,P=n.environmentResult,_=n.baselineGroupIndex,se=n.envData,b=n.group,xe=n.wsId,G=n.containerRef,be=u.parentDom,Ae=u.scrollLeft,Ee=(0,s.useState)([]),le=(0,x.Z)(Ee,2),Fe=le[0],He=le[1],Ge=(0,s.useState)([]),We=(0,x.Z)(Ge,2),fe=We[0],ie=We[1],pe=(0,s.useState)(!0),Be=(0,x.Z)(pe,2),Q=Be[0],Ke=Be[1],we=(0,s.useState)(""),X=(0,x.Z)(we,2),$e=X[0],Ue=X[1],oe=(0,s.useState)("all"),k=(0,x.Z)(oe,2),Ne=k[0],Ve=k[1],ae=(0,s.useRef)(),W=(0,s.useRef)(null),De=d.perf_data_result,Re=(0,s.useMemo)(function(){return _===-1?0:_},[_]);(0,s.useEffect)(function(){var L=ve().cloneDeep(De);ie(Q?L:L.map(function(A){return(0,v.Z)((0,v.Z)({},A),{},{chartType:"1"})}))},[De,Q]);var je=function(){Ke(!Q)};(0,s.useEffect)(function(){Ue(Q?"chart":"list")},[Q]);var ze=function(){return(0,e.jsx)(l.JI,{children:(0,e.jsxs)(U.Z,{children:[(0,e.jsx)(Ce.Z,{onClick:je,children:(0,e.jsx)(o._H,{id:$e==="chart"?"analysis.chart.mode":"analysis.list.mode"})}),Q&&(0,e.jsxs)(U.Z,{children:[(0,e.jsxs)($.Z.Text,{children:[(0,e.jsx)(o._H,{id:"analysis.filter"}),": "]}),(0,e.jsxs)(ce.Z,{defaultValue:"all",style:{width:200},value:Ne,onSelect:tt,children:[(0,e.jsx)(_e,{value:"all",children:(0,e.jsx)(o._H,{id:"analysis.all"})}),(0,e.jsx)(_e,{value:"invalid",children:(0,e.jsx)(o._H,{id:"analysis.invalid"})}),(0,e.jsx)(_e,{value:"volatility",title:r({id:"analysis.volatility"}),children:(0,e.jsx)(o._H,{id:"analysis.volatility"})}),(0,e.jsx)(_e,{value:"increase",children:(0,e.jsx)(o._H,{id:"analysis.increase"})}),(0,e.jsx)(_e,{value:"decline",children:(0,e.jsx)(o._H,{id:"analysis.decline"})}),(0,e.jsx)(_e,{value:"normal",children:(0,e.jsx)(o._H,{id:"analysis.normal"})})]})]})]})})},et=function(A,T,I){ae.current=T;var c=[];He(c.concat(I.conf_id));var p=A.conf_list.reduce(function(f,h){return h.conf_id===I.conf_id?f.concat((0,v.Z)((0,v.Z)({},h),{},{metric_list:h.metric_list.reduce(function(j,E){var g=E.compare_data[T].compare_result,C=4;if(g){var R=Ze.indexOf(g);C=R}return j.concat((0,v.Z)((0,v.Z)({},E),{},{sortNum:C}))},[]).sort(Rt("sortNum"))})):f.concat(h)},[]);ie(fe.map(function(f){return f.suite_id===A.suite_id?(0,v.Z)((0,v.Z)({},f),{},{conf_list:p}):f}))},tt=function(A){Ve(A);var T=ve().cloneDeep(De);ie(A==="all"?T:T.map(function(I){var c=I.conf_list.map(function(p){return(0,v.Z)((0,v.Z)({},p),{},{metric_list:p.metric_list.filter(function(f){return(0,ke.w)(f.compare_data,A)})})});return(0,v.Z)((0,v.Z)({},I),{},{conf_list:c})}))},Je=function(A){var T=A.conf_compare_data||A.compare_conf_list||[];return T.map(function(I,c){return(0,e.jsx)(l.r0,{gLen:b,children:(0,he.cO)(I)?(0,e.jsx)("div",{style:{height:38}}):(0,e.jsx)(Ie.zA,{ws_id:xe,job_id:I.obj_id||I})},c)})},V=(0,Le.Z)(G);return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(l.ER,{ref:W,children:(0,e.jsxs)(l.ZA,{style:{border:"1px solid rgba(0,0,0,0.10)"},children:[(0,e.jsx)(l.Ll,{gLen:b,children:(0,e.jsx)(o._H,{id:"analysis.comparison.group.name"})}),(0,e.jsx)(Te.Z,{envData:se,group:b,isData:!0})]})}),(0,e.jsx)(dt,{groupRowRef:W,parentDom:be,envData:se,groupLen:b}),(0,e.jsxs)(Y.Z,{style:{maxWidth:document.body.clientWidth-40+Ae},children:[(0,e.jsx)(K.Z,{span:12,children:(0,e.jsx)(l.Xb,{id:"perf_item",children:(0,e.jsx)(o._H,{id:"performance.test"})})}),(0,e.jsx)(K.Z,{span:12,children:(0,e.jsx)(ze,{})})]}),(0,e.jsx)(l.Rr,{children:fe&&!!fe.length?fe.map(function(L,A){return(0,e.jsxs)(l.gb,{children:[(0,e.jsxs)(l.yO,{style:{textIndent:V==null?void 0:V.left},children:[L.suite_name,(0,e.jsx)(ut.Z,{containerScroll:V,btn:Q,isReport:!1,obj:fe,suiteId:L.suite_id,setPerData:ie})]}),(0,e.jsx)(l.uP,{children:Q?L.conf_list&&L.conf_list.length?L.conf_list.map(function(T,I){return!!T.metric_list.length&&(0,e.jsxs)("div",{children:[(0,e.jsxs)(l.h$,{children:[(0,e.jsx)(l.h,{gLen:b,children:(0,e.jsx)(o._H,{id:"analysis.TestConf/metric"})}),y==null?void 0:y.map(function(c,p){return(0,e.jsx)(l.iM,{gLen:b,children:p!==Re?(0,e.jsxs)(Y.Z,{justify:"space-between",children:[(0,e.jsx)(K.Z,{span:12,children:(0,e.jsx)($.Z.Text,{style:{color:"rgba(0,0,0,0.45)"},children:(0,e.jsx)(o._H,{id:"analysis.result"})})}),(0,e.jsx)(K.Z,{span:12,children:(0,e.jsxs)(l.Qz,{children:[(0,e.jsx)(o._H,{id:"analysis.comparison/tracking.results"}),(0,e.jsx)("span",{onClick:function(){return et(L,p,T)},style:{margin:"0 5px 0 3px",verticalAlign:"middle",cursor:"pointer"},children:Fe.includes(T.conf_id)&&ae.current===p?(0,e.jsx)(lt.r,{}):(0,e.jsx)(Xe.r,{})}),(0,e.jsx)(yt.Z,{color:"#fff",overlayStyle:{minWidth:350},title:(0,e.jsxs)("span",{style:{color:"rgba(0,0,0,0.65)"},children:[(0,e.jsx)(o._H,{id:"analysis.the.greater.difference"}),(0,e.jsx)("br",{}),(0,e.jsx)(o._H,{id:"analysis.rules"}),"\uFF1A",(0,e.jsx)("br",{}),(0,e.jsx)(o._H,{id:"analysis.decline"}),">",(0,e.jsx)(o._H,{id:"analysis.increase"}),">",(0,e.jsx)(o._H,{id:"analysis.fluctuation"}),">",(0,e.jsx)(o._H,{id:"analysis.invalid"})]}),children:(0,e.jsx)(it.Z,{})})]})})]}):(0,e.jsx)($.Z.Text,{style:{color:"rgba(0,0,0,0.45)"},children:y.length>1?(0,e.jsx)(o._H,{id:"analysis.benchmark"}):(0,e.jsx)(o._H,{id:"analysis.result"})})},p)})]}),(0,e.jsxs)("div",{style:{border:"1px solid rgba(0,0,0,0.10)"},children:[(0,e.jsxs)(l.TG,{children:[(0,e.jsx)(l.j3,{gLen:b,children:(0,e.jsx)(ye.Z,{title:T.conf_name})}),Je(T)]}),T.metric_list.map(function(c,p){var f,h;return(0,e.jsxs)(l.WF,{children:[(0,e.jsx)(l.KW,{gLen:b,children:(0,e.jsxs)(Y.Z,{justify:"space-between",children:[(0,e.jsx)(K.Z,{span:16,children:(0,e.jsx)(Y.Z,{justify:"start",children:(0,e.jsx)(ye.Z,{title:"".concat(c.metric).concat(c.unit?"("+c.unit+")":""),children:(0,e.jsxs)($.Z.Text,{style:{color:"rgba(0,0,0,0.65)"},children:[c.metric,c.unit&&(0,e.jsxs)("span",{children:["(",c.unit,")"]})]})})})}),(0,e.jsx)(K.Z,{span:8,children:(0,e.jsx)(Y.Z,{justify:"end",children:(0,e.jsxs)(l.Qz,{children:["(","".concat((0,ne.gt)(c.cv_threshold),"/").concat((0,ne.gt)(c.cmp_threshold)),")"]})})})]})}),Array.isArray(c.compare_data)&&!!c.compare_data.length&&((f=c.compare_data)===null||f===void 0||(h=f.slice(0,b))===null||h===void 0?void 0:h.map(function(j,E){return(0,e.jsx)(l.LQ,{gLen:b,children:(0,e.jsxs)(Y.Z,{justify:"space-between",children:[(0,e.jsx)(K.Z,{span:j&&j.compare_result?12:20,children:(0,e.jsx)(Y.Z,{justify:"start",children:(0,e.jsx)(ye.Z,{title:(0,ke.U)(j),children:(0,e.jsx)($.Z.Text,{style:{color:"rgba(0,0,0,0.65)"},children:(0,ke.U)(j)})})})}),j&&j.compare_result&&(0,e.jsx)(K.Z,{span:12,children:(0,e.jsx)(Y.Z,{justify:"end",children:(0,e.jsxs)(l.Qz,{children:[(0,e.jsx)("span",{className:(0,ne.B1)(j.compare_result),children:j.compare_value||"-"}),(0,e.jsx)("span",{className:(0,ne.B1)(j.compare_result),style:{padding:" 0px 9px "},children:(0,ne.PV)(j.compare_result)})]})})})]})},E)}))]},p)})]})]},I)}):(0,e.jsx)(re.Z,{image:re.Z.PRESENTED_IMAGE_SIMPLE}):(0,e.jsx)(ot.Z,(0,v.Z)((0,v.Z)({},L),{},{envData:P,base_index:Re}))})]},A)}):(0,e.jsx)(re.Z,{image:re.Z.PRESENTED_IMAGE_SIMPLE})})]})},ct=(0,s.memo)(Pt),Se=t(39632),Ct=t(63880),Ot=function(u){var a=(0,o.YB)(),r=a.formatMessage,n=(0,s.useContext)(m),d=n.allGroupData,y=n.compareResult,P=n.baselineGroupIndex,_=n.group,se=n.wsId,b=n.containerRef,xe=u.scrollLeft,G=y.func_data_result,be=(0,s.useState)(null),Ae=(0,x.Z)(be,2),Ee=Ae[0],le=Ae[1],Fe=(0,s.useState)(0),He=(0,x.Z)(Fe,2),Ge=He[0],We=He[1],fe=(0,s.useState)(!1),ie=(0,x.Z)(fe,2),pe=ie[0],Be=ie[1],Q=(0,s.useState)("All"),Ke=(0,x.Z)(Q,2),we=Ke[0],X=Ke[1],$e=(0,s.useState)([]),Ue=(0,x.Z)($e,2),oe=Ue[0],k=Ue[1],Ne=(0,s.useState)([]),Ve=(0,x.Z)(Ne,2),ae=Ve[0],W=Ve[1],De=s.useState({}),Re=(0,x.Z)(De,2),je=Re[0],ze=Re[1];(0,s.useEffect)(function(){Array.isArray(G)&&!!G.length&&W(G)},[G]),s.useEffect(function(){return function(){ze({})}},[]);var et=function(p){var f=p.sub_case_list,h=p.conf_id,j=oe.includes(h);return j&&(f==null?void 0:f.map(function(E){var g,C;return(0,e.jsxs)(l.GH,{children:[(0,e.jsx)(l.ly,{gLen:_,children:(0,e.jsx)($.Z.Text,{children:(0,e.jsx)(ye.Z,{title:E.sub_case_name})})}),E.compare_data.length?(g=E.compare_data)===null||g===void 0||(C=g.slice(0,_))===null||C===void 0?void 0:C.map(function(R,q){return(0,e.jsx)(Ct.p,{glen:_,tp:R,desc:E.baseline_desc},q)}):(0,e.jsx)(l.bH,{gLen:_,children:(0,e.jsx)($.Z.Text,{children:"-"})})]},E.sub_case_name)}))},tt=function(p){var f=oe.includes(p);k(f?oe.filter(function(h){return h!==p}):oe.concat(p))},Je=function(p,f){if(console.log("func test handleArrow"),Ee==p.suite_id){W(ae.map(function(g){return g.suite_id==p.suite_id?(0,v.Z)((0,v.Z)({},g),{},{conf_list:je==null?void 0:je[g.suite_id]}):g})),le(null);return}We(f),le(p.suite_id);var h=f>V?f-1:f,j=p.conf_list.map(function(g){var C,R=[[],[],[],[],[]];return g.sub_case_list.forEach(function(q){var ue=q.compare_data;ue[V]==="Pass"&&ue[h]==="Fail"?R[0].push(q):ue[V]==="Fail"&&ue[h]==="Pass"?R[1].push(q):ue[V]==="Fail"&&ue[h]==="Fail"?R[2].push(q):ue[V]==="Pass"&&ue[h]==="Pass"?R[3].push(q):R[4].push(q)}),(0,v.Z)((0,v.Z)({},g),{},{sub_case_list:(C=[]).concat.apply(C,R)})}),E=ae.map(function(g){return g.suite_id==p.suite_id?(ze(function(C){return(0,v.Z)((0,v.Z)({},C),{},(0,vt.Z)({},g.suite_id,g.conf_list))}),(0,v.Z)((0,v.Z)({},g),{},{conf_list:j})):g});W(E)},V=(0,s.useMemo)(function(){return P===-1?0:P},[P]),L=function(){Be(!pe)};(0,s.useEffect)(function(){k([]),k(pe?ae.reduce(function(c,p){return c.concat(p.conf_list.map(function(f){return f.conf_id}))},[]):[])},[pe]);var A=function(p){X(p);var f=ve().cloneDeep(G),h=[];p=="All"?W(f):(f.map(function(j){var E=[];j.conf_list.map(function(g){var C=g.sub_case_list.filter(function(R){return R.compare_data.includes(p)});E.push((0,v.Z)((0,v.Z)({},g),{},{sub_case_list:C}))}),h.push((0,v.Z)((0,v.Z)({},j),{},{conf_list:E}))}),W(h))},T=function(){return(0,e.jsx)(l.JI,{children:(0,e.jsxs)(U.Z,{children:[(0,e.jsx)(Ce.Z,{onClick:L,children:(0,e.jsx)(o._H,{id:pe?"analysis.folded.all":"analysis.expand.all"})}),(0,e.jsxs)(U.Z,{children:[(0,e.jsxs)($.Z.Text,{children:[(0,e.jsx)(o._H,{id:"analysis.filter"}),": "]}),(0,e.jsxs)(ce.Z,{defaultValue:"All",style:{width:200},value:we,onSelect:A,children:[(0,e.jsx)(ce.Z.Option,{value:"All",children:(0,e.jsx)(o._H,{id:"analysis.all"})}),(0,e.jsx)(ce.Z.Option,{value:"Pass",children:(0,e.jsx)(o._H,{id:"analysis.pass"})}),(0,e.jsx)(ce.Z.Option,{value:"Fail",children:(0,e.jsx)(o._H,{id:"analysis.fail"})}),(0,e.jsx)(ce.Z.Option,{value:"Skip",children:(0,e.jsx)(o._H,{id:"analysis.skip"})})]})]})]})})},I=(0,Le.Z)(b);return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)(Y.Z,{style:{maxWidth:document.body.clientWidth-40+xe},children:[(0,e.jsx)(K.Z,{span:12,children:(0,e.jsx)(l.Xb,{id:"func_item",children:(0,e.jsx)(o._H,{id:"functional.test"})})}),(0,e.jsx)(K.Z,{span:12,children:(0,e.jsx)(T,{})})]}),(0,e.jsx)(l.Rr,{children:ae.length?ae.map(function(c,p){var f;return(0,e.jsx)(s.Fragment,{children:(0,e.jsxs)(l.gb,{children:[(0,e.jsx)(l.yO,{style:{textIndent:I==null?void 0:I.left},children:c.suite_name}),(0,e.jsx)(l.h$,{children:c.conf_list&&c.conf_list.length?(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(l.h,{gLen:_,children:"Conf"}),d==null?void 0:d.map(function(h,j){return(0,e.jsx)(l.iM,{gLen:_,children:(0,e.jsxs)(Y.Z,{children:[(0,e.jsx)(K.Z,{span:12,children:(0,e.jsx)(o._H,{id:"analysis.total/pass/fail"})}),j!==V&&(0,e.jsxs)(K.Z,{span:12,style:{textAlign:"right",paddingRight:10},children:[(0,e.jsx)(o._H,{id:"analysis.comparison.results"}),(0,e.jsx)("span",{onClick:function(){return Je(c,j)},style:{margin:"0 5px 0 3px",verticalAlign:"middle",cursor:"pointer"},children:Ee==c.suite_id&&Ge==j?(0,e.jsx)(lt.r,{}):(0,e.jsx)(Xe.r,{title:r({id:"analysis.differentiated.sorting"})})}),(0,e.jsx)(Se.F,{})]})]})},j)})]}):null}),(0,e.jsx)(l.uP,{children:c.conf_list&&c.conf_list.length?(f=c.conf_list)===null||f===void 0?void 0:f.map(function(h,j){var E,g=oe.includes(h.conf_id),C=h.conf_compare_data||h.compare_conf_list;return(0,e.jsxs)(s.Fragment,{children:[(0,e.jsxs)(l.lu,{expand:g,children:[(0,e.jsx)(l.Km,{gLen:_,children:(0,e.jsxs)(ye.Z,{title:h.conf_name,children:[(0,e.jsx)(l.Qq,{rotate:g?90:0,onClick:function(){return tt(h.conf_id)}}),(0,e.jsx)($.Z.Text,{style:{marginLeft:"12px"},children:h.conf_name})]})}),C==null||(E=C.slice(0,_))===null||E===void 0?void 0:E.map(function(R,q){return(0,e.jsx)(l.Lc,{gLen:_,children:(0,e.jsxs)(U.Z,{size:16,children:[(0,e.jsx)($.Z.Text,{style:{color:"#649FF6"},children:(0,ne.YL)(R.all_case)}),(0,e.jsx)($.Z.Text,{style:{color:"#81BF84"},children:(0,ne.YL)(R.success_case)}),(0,e.jsx)($.Z.Text,{style:{color:"#C84C5A"},children:(0,ne.YL)(R.fail_case)}),R&&!R.is_baseline?(0,e.jsx)(Ie.zA,{ws_id:se,job_id:R.obj_id,style:{paddingLeft:10}}):(0,e.jsx)(e.Fragment,{})]})},q)})]}),(0,e.jsx)(et,(0,v.Z)({},h))]},j)}):(0,e.jsx)(re.Z,{image:re.Z.PRESENTED_IMAGE_SIMPLE})})]})},p)}):(0,e.jsx)(re.Z,{image:re.Z.PRESENTED_IMAGE_SIMPLE})})]})},Lt=(0,s.memo)(Ot),Me=t(38924),Tt=function(){var u=(0,ee.TH)(),a=u.state,r=(0,o.YB)(),n=r.formatMessage,d=(0,ee.UO)(),y=d.ws_id,P=d.form_id,_=(0,o.md)(),se=(0,s.useRef)(null),b=(0,s.useState)({}),xe=(0,x.Z)(b,2),G=xe[0],be=xe[1],Ae=(0,s.useState)({}),Ee=(0,x.Z)(Ae,2),le=Ee[0],Fe=Ee[1],He=(0,s.useState)({}),Ge=(0,x.Z)(He,2),We=Ge[0],fe=Ge[1],ie=(0,s.useState)({}),pe=(0,x.Z)(ie,2),Be=pe[0],Q=pe[1],Ke=(0,s.useState)([]),we=(0,x.Z)(Ke,2),X=we[0],$e=we[1],Ue=(0,s.useState)(0),oe=(0,x.Z)(Ue,2),k=oe[0],Ne=oe[1],Ve=(0,s.useState)({}),ae=(0,x.Z)(Ve,2),W=ae[0],De=ae[1],Re=(0,s.useState)([]),je=(0,x.Z)(Re,2),ze=je[0],et=je[1],tt=(0,s.useState)(void 0),Je=(0,x.Z)(tt,2),V=Je[0],L=Je[1],A=(0,s.useState)(1),T=(0,x.Z)(A,2),I=T[0],c=T[1],p=(0,s.useState)(0),f=(0,x.Z)(p,2),h=f[0],j=f[1],E=(0,s.useRef)(null),g=s.useState(void 0),C=(0,x.Z)(g,2),R=C[0],q=C[1],ue=s.useState(!1),Kt=(0,x.Z)(ue,2),ea=Kt[0],wt=Kt[1],ta=document.querySelector(".ant-layout-has-sider .ant-layout"),aa=(0,Le.Z)(ta),ra=aa.top,na=(0,Ie.CR)(),sa=na.height,la=function(){var O=(0,z.Z)((0,M.Z)().mark(function Z(){var i,F,D;return(0,M.Z)().wrap(function(H){for(;;)switch(H.prev=H.next){case 0:return H.next=2,te({form_id:P});case 2:if(i=H.sent,i.code!=200){H.next=13;break}if(i!=null&&i.data){H.next=6;break}return H.abrupt("return");case 6:be(i==null?void 0:i.data.testDataParam),Fe(i==null?void 0:i.data.envDataParam),$e(i==null?void 0:i.data.allGroupData),Ne(i==null?void 0:i.data.baselineGroupIndex),L(i==null||(F=i.data.allGroupData[0])===null||F===void 0||(D=F.members[0])===null||D===void 0?void 0:D.ws_id),H.next=14;break;case 13:i.code===500?(0,he.CT)(500):(0,he.EV)(i.code,i.msg);case 14:case"end":return H.stop()}},Z)}));return function(){return O.apply(this,arguments)}}();(0,s.useEffect)(function(){P?la():a&&JSON.stringify(a)!=="{}"&&(be(a==null?void 0:a.testDataParam),Fe(a==null?void 0:a.envDataParam),Q(a==null?void 0:a.compareGroupData),$e(a==null?void 0:a.allGroupData),Ne(a==null?void 0:a.baselineGroupIndex),fe(a==null?void 0:a.domainGroupResult))},[P,a]);var It=X==null?void 0:X.length,ia=function(){return document.querySelector(".ant-layout-has-sider .ant-layout").scrollTop=0},oa=(0,s.useState)({func_data_result:[],perf_data_result:[]}),$t=(0,x.Z)(oa,2),at=$t[0],ua=$t[1],da=function(){var O=(0,z.Z)((0,M.Z)().mark(function Z(i){var F;return(0,M.Z)().wrap(function(N){for(;;)switch(N.prev=N.next){case 0:return N.next=2,(0,nt.on)(i);case 2:return F=N.sent,N.abrupt("return",F);case 4:case"end":return N.stop()}},Z)}));return function(i){return O.apply(this,arguments)}}(),ca=function(){var O=(0,z.Z)((0,M.Z)().mark(function Z(){var i,F,D,N,H,Pe;return(0,M.Z)().wrap(function(B){for(;;)switch(B.prev=B.next){case 0:return B.next=2,(0,nt.gQ)(le);case 2:if(i=B.sent,i.code==200&&De(i.data),i.code!==1358){B.next=7;break}return Oe.default.error(n({id:"analysis.please.add.comparison.group"})),B.abrupt("return");case 7:i.code!==200&&Oe.default.error(i.msg),F=G.perf_suite_dic,D=G.func_suite_dic,N=[],H=[],F&&JSON.stringify(F)!=="{}"&&(N=(0,Me.$7)(F)),D&&JSON.stringify(D)!=="{}"&&(H=(0,Me.$7)(D)),Pe=[],Pe=N.concat(H),c(Pe.length),Pe.map(function(ft){return da(ft).then(function(pt){var Mt=pt.code,bt=pt.data;if(i.code===500){(0,he.CT)(500);return}if(i.code!==200){Oe.default.error(i.msg);return}var zt=bt.test_type;if(Mt===200&&JSON.stringify(bt)!=="{}"&&["functional","performance"].includes(zt)){var Jt=zt==="functional"?"func_data_result":"perf_data_result";ua(function(Yt){return(0,v.Z)((0,v.Z)({},Yt),{},(0,vt.Z)({},Jt,Yt[Jt].concat(bt)))})}})});case 17:case"end":return B.stop()}},Z)}));return function(){return O.apply(this,arguments)}}(),Ut=(0,s.useMemo)(function(){var O=at.func_data_result,Z=at.perf_data_result,i=Z.length,F=O.length;return i+F},[at]);(0,s.useEffect)(function(){JSON.stringify(G)!=="{}"&&JSON.stringify(le)!=="{}"&&ca()},[G,le]);var fa=function(){var O=(0,z.Z)((0,M.Z)().mark(function Z(){var i,F,D,N,H,Pe;return(0,M.Z)().wrap(function(B){for(;;)switch(B.prev=B.next){case 0:return i=X.map(function(ft){var pt=ft.members.map(function(Mt){return Mt.id});return(0,v.Z)((0,v.Z)({},ft),{},{members:pt})}),F={allGroupData:i,baselineGroupIndex:k,testDataParam:G,envDataParam:le},B.next=4,_t({form_data:F});case 4:if(D=B.sent,N=D.data,H=D.code,Pe=D.msg,H===200){B.next=11;break}return(0,he.EV)(H,Pe),B.abrupt("return");case 11:return B.abrupt("return",N);case 12:case"end":return B.stop()}},Z)}));return function(){return O.apply(this,arguments)}}(),pa=(0,Ie.oM)(n({id:"analysis.copy.sharing.link.succeeded"})),va=function(){var O=(0,z.Z)((0,M.Z)().mark(function Z(){var i;return(0,M.Z)().wrap(function(D){for(;;)switch(D.prev=D.next){case 0:if(!ea){D.next=2;break}return D.abrupt("return");case 2:if(i=R,i){D.next=9;break}return wt(!0),D.next=7,fa();case 7:i=D.sent,wt(!1);case 9:q(i),pa(location.origin+"/share/analysis_result/".concat(i));case 11:case"end":return D.stop()}},Z)}));return function(){return O.apply(this,arguments)}}(),ha=function(){var Z;(Z=E.current)===null||Z===void 0||Z.show({})},ma=function(Z){o.m8.push({pathname:"/ws/".concat(y,"/test_create_report"),state:{environmentResult:W,baselineGroupIndex:k,allGroupData:X,testDataParam:ve().cloneDeep(G),compareResult:ve().cloneDeep(at),compareGroupData:Be,domainGroupResult:We,saveReportData:Z}})},Nt=function(Z){var i=Z.srcElement.scrollLeft||0;j(i)};(0,s.useEffect)(function(){return window.addEventListener("scroll",Nt,!0),function(){window.removeEventListener("scroll",Nt,!0)}},[]),(0,s.useEffect)(function(){if(JSON.stringify(W)!=="{}"){var O=ve().cloneDeep(W);O.base_group&&(O.base_group.is_group=!0);var Z=O.compare_groups,i=O.base_group;Z.splice(k,0,i),et(Z)}},[W.compare_groups]);var Vt=s.useRef(null);return(0,e.jsx)(m.Provider,{value:{allGroupData:X,baselineGroupIndex:k,environmentResult:W,compareResult:at,envData:ze,group:It,wsId:y||V,containerRef:Vt},children:(0,e.jsxs)("div",{style:{width:"100%",minHeight:sa-50,position:"relative",overflow:"auto",background:"#f5f5f5"},ref:Vt,children:[Ut!==I&&(0,e.jsx)(l.he,{children:(0,e.jsxs)("span",{className:"my-loading-span",children:[(0,e.jsx)("i",{}),(0,e.jsx)("i",{}),(0,e.jsx)("i",{}),(0,e.jsx)("i",{})]})}),(0,e.jsx)(l.dv,{style:{width:It>3?It*390:1200},children:(0,e.jsxs)(K.Z,{span:24,children:[(0,e.jsxs)(l.BK,{style:{maxWidth:document.body.clientWidth-40+h},children:[(0,e.jsx)(l.ZI,{children:(0,e.jsx)(o._H,{id:"analysis.comparison.result"})}),(0,e.jsxs)("span",{className:"btn",children:[(0,e.jsx)("span",{className:"test_result_copy_link"}),!P&&(0,e.jsxs)("span",{onClick:va,style:{cursor:"pointer"},children:[(0,e.jsx)(de.r,{style:{marginRight:5}}),(0,e.jsx)(o._H,{id:"operation.share"})]}),(0,e.jsx)(o.Nv,{accessible:_.IsWsSetting(),children:!P&&(0,e.jsx)(Ce.Z,{type:"primary",loading:Ut!==I,onClick:ha,style:{marginLeft:8},children:(0,e.jsx)(o._H,{id:"analysis.create.report"})})})]})]}),(0,e.jsxs)(l.Xv,{children:[W&&JSON.stringify(W)!=="{}"&&(0,e.jsx)(gt,{}),(0,e.jsxs)(l.KP,{style:{position:"relative"},id:"test_data",ref:se,children:[(0,e.jsxs)(l.DK,{children:[(0,e.jsx)("span",{className:"line"}),(0,e.jsx)(o._H,{id:"analysis.job.data"})]}),(0,e.jsx)(ct,{parentDom:se,scrollLeft:h}),(0,e.jsx)(Lt,{scrollLeft:h})]})]})]})}),ra>600&&(0,e.jsx)("div",{style:{width:44,height:44,borderRadius:2,backgroundColor:"rgb(0, 0, 0, 0.1)",position:"fixed",bottom:10,right:20},onClick:ia,children:(0,e.jsx)(ht.Z,{style:{fontSize:30,padding:7,color:"rgb(0, 0, 0, 0.7)"}})}),y&&(0,e.jsx)(At.Z,{ref:E,onOk:ma,allGroup:X})]})})},qe=(0,s.memo)(Tt)},54564:function(Qt,rt,t){"use strict";var Xt=t(20228),K=t(11382),kt=t(47673),Ce=t(4107),vt=t(49111),v=t(19650),qt=t(57663),Oe=t(71577),M=t(11849),z=t(39428),x=t(3182),s=t(9715),de=t(20526),ee=t(2824),o=t(57338),Le=t(440),ht=t(20310),At=t(43358),mt=t(34041),w=t(67294),Ft=t(50310),Ye=t(12788),_t=t(96486),J=t.n(_t),te=t(16917),Qe=t(20009),nt=t(24480),m=t(85893),Te,l=mt.Z.Option,xt=(0,Ye.ZP)(Le.Z)(Te||(Te=(0,ht.Z)([`
    .ant-drawer-title{
        font-weight: 600;
    }
    .server_provider {
        margin-bottom: 5px;  
    }
    .script_right_name{
        font-size: 14px;
        color: rgba(0,0,0,0.85);
    }
`])));rt.Z=(0,w.forwardRef)(function(e,jt){var gt=(0,te.YB)(),ge=gt.formatMessage,re=(0,Qe.UO)(),Ht=re.ws_id,yt=e.onOk,Gt=e.allGroup,Y=de.Z.useForm(),Wt=(0,ee.Z)(Y,1),U=Wt[0],Bt=(0,w.useState)(!1),$=(0,ee.Z)(Bt,2),Zt=$[0],st=$[1],ce=(0,w.useState)(!1),Xe=(0,ee.Z)(ce,2),lt=Xe[0],it=Xe[1],ne=(0,w.useState)({}),ot=(0,ee.Z)(ne,2),ke=ot[0],St=ot[1],ve=(0,w.useState)(!0),ut=(0,ee.Z)(ve,2),ye=ut[0],Et=ut[1],Ie=(0,w.useState)([]),he=(0,ee.Z)(Ie,2),me=he[0],_e=he[1],Dt=(0,w.useState)([]),dt=(0,ee.Z)(Dt,2),Ze=dt[0],Rt=dt[1],Pt=(0,w.useState)([]),ct=(0,ee.Z)(Pt,2),Se=ct[0],Ct=ct[1];(0,w.useImperativeHandle)(jt,function(){return{show:function(){var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};it(!0),St(a),U.setFieldsValue(a),Lt()}}});var Ot=function(){var u=(0,x.Z)((0,z.Z)().mark(function a(){var r,n,d,y;return(0,z.Z)().wrap(function(_){for(;;)switch(_.prev=_.next){case 0:return _.next=2,(0,Ft.MD)({page_size:9999,page_num:1,ws_id:Ht});case 2:r=_.sent,n=r.data,d=r.code,y=r.msg,d===200&&Ct(n),Et(!1),d!==200&&(0,nt.EV)(d,y);case 9:case"end":return _.stop()}},a)}));return function(){return u.apply(this,arguments)}}();(0,w.useEffect)(function(){Ot()},[]),(0,w.useEffect)(function(){var u=J().find(Se,"is_default"),a=null;u&&(a=u.id);var r=null;Ze.length===1&&(r=Ze[0]);var n=null;me.length===1&&(n=me[0].id);var d=U.getFieldsValue();d.template=a,d.productVersion=r,d.project=n,U.setFieldsValue(d)},[Se,Ze,me]);var Lt=function(){var a=[],r=[];try{Gt.forEach(function(n,d){n&&J().isArray(n.members)&&n.members.length&&(a.push(n.members[0].product_version),n.members.forEach(function(y){return r.push({id:y.project_id,name:y.project_name})}))}),a=J().uniq(a),r=J().uniqWith(r,J().isEqual),r=r.filter(function(n){return n.id!==void 0}),Rt(a),_e(r)}catch(n){console.log(n)}},Me=function(){U.resetFields(),st(!1),it(!1)},Tt=function(){st(!0),U.validateFields().then(function(){var a=(0,x.Z)((0,z.Z)().mark(function r(n){var d,y;return(0,z.Z)().wrap(function(_){for(;;)switch(_.prev=_.next){case 0:d=n.template,y=J().find(Se,{id:d}),yt((0,M.Z)((0,M.Z)({},n),{},{is_default:J().get(y,"is_default")}),ke),Me();case 4:case"end":return _.stop()}},r)}));return function(r){return a.apply(this,arguments)}}()).catch(function(a){console.log(a),st(!1)})},qe=function(a){var r="",n=Se;if(a==="template"){var d=J().find(n,"is_default");d&&(r=d.id)}return a==="productVersion"&&(n=Ze.filter(function(y){return y}),n.length===1&&(r=n[0])),a==="project"&&(n=me,n.length===1&&(r=n[0].id)),r},S=function(a){var r="",n=Se;return a==="template"&&(r=ge({id:"report.please.select.template"})),a==="productVersion"&&(n=Ze.filter(function(d){return d}),r=ge({id:"report.select.productVersion"})),a==="project"&&(n=me,r=ge({id:"report.select.project"})),(0,m.jsx)(mt.Z,{showSearch:!0,allowClear:!0,placeholder:r,optionFilterProp:"children",style:{width:"100%"},onChange:function(y){var P=U.getFieldsValue();P[a]=y,U.setFieldsValue(P)},showArrow:!0,filterOption:function(y,P){return P.children.toLowerCase().indexOf(y.toLowerCase())>=0},children:n.map(function(d){return a==="productVersion"?(0,m.jsx)(l,{value:d,children:d},d):(0,m.jsx)(l,{value:d.id,children:d.name},d.id)})})};return(0,m.jsx)(m.Fragment,{children:(0,m.jsx)(K.Z,{spinning:ye,children:(0,m.jsx)(xt,{title:(0,m.jsx)(te._H,{id:"report.generate.report"}),width:"375",onClose:Me,visible:lt,footer:(0,m.jsx)("div",{style:{textAlign:"right"},children:(0,m.jsxs)(v.Z,{children:[(0,m.jsx)(Oe.Z,{onClick:Me,children:(0,m.jsx)(te._H,{id:"operation.cancel"})}),(0,m.jsx)(Oe.Z,{type:"primary",disabled:Zt,onClick:Tt,children:(0,m.jsx)(te._H,{id:"operation.ok"})})]})}),children:(0,m.jsxs)(de.Z,{form:U,layout:"vertical",initialValues:{template:qe("template"),productVersion:qe("productVersion"),project:qe("project")},children:[(0,m.jsx)(de.Z.Item,{label:(0,m.jsx)(te._H,{id:"report.columns.name"}),name:"name",rules:[{required:!0,message:ge({id:"report.please.enter.name"})}],children:(0,m.jsx)(Ce.Z,{autoComplete:"auto",placeholder:ge({id:"report.please.enter.name"})})}),(0,m.jsx)(de.Z.Item,{label:(0,m.jsx)(te._H,{id:"report.select.template"}),name:"template",rules:[{required:!0}],children:S("template")}),(0,m.jsx)(de.Z.Item,{label:(0,m.jsx)(te._H,{id:"report.columns.product_version"}),name:"productVersion",children:S("productVersion")}),(0,m.jsx)(de.Z.Item,{label:(0,m.jsx)(te._H,{id:"report.columns.project"}),name:"project",children:S("project")}),(0,m.jsx)(de.Z.Item,{label:(0,m.jsx)(te._H,{id:"report.description.input"}),name:"description",children:(0,m.jsx)(Ce.Z.TextArea,{placeholder:ge({id:"report.description.placeholder"})})})]})})})})})}}]);
