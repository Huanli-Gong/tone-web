(self.webpackChunktone_front=self.webpackChunktone_front||[]).push([[3044],{55580:function(V){V.exports={create_layout:"create_layout___3WAVM",systerm_init:"systerm_init___1UTPY",create_main:"create_main___1hAqa",title:"title___3apRx",red:"red___3VnqD",mb_8:"mb_8___2bk5m",mb_16:"mb_16___2LzdW",ml_97:"ml_97___1oAnL",mb_55:"mb_55___2OoKp",form_layout:"form_layout___2QDDM",full_width:"full_width___330c9",line:"line___3GlT2",create_banner:"create_banner___3yyFE",rigth_content:"rigth_content___1QKa8",issue_title:"issue_title___1i0g3",performance_ul:"performance_ul___3n1iZ",performace_more:"performace_more___1K_IM",close_btn:"close_btn___4_Wkf",upload_style:"upload_style___2LEu-",question_icon:"question_icon___11JAi",question_tip_wrapper:"question_tip_wrapper___3_aWX",question_tip_layout:"question_tip_layout___3RkKh",w_384:"w_384___cP7u3",init_box:"init_box___1IwnL",init_container:"init_container___3RZrR",init_text:"init_text___3MYIA",icon_gif:"icon_gif___dttQN",init_sucess_text:"init_sucess_text___1ttsu",init_sucess_opreate:"init_sucess_opreate___3hChT",icon:"icon___qfcqn",desc:"desc___3or4A",last_line:"last_line___19fIw",create_doc:"create_doc___2WcXq",button:"button___3C83h",init_success_box:"init_success_box___3Q6Vb",init_sucess_box:"init_sucess_box___3MYty"}},37834:function(V,B,s){"use strict";var Me=s(67515),Q=s(41083),Oe=s(14320),U=s(53479),z=s(35832),Y=s(32326),G=s(39190),y=s(41428),C=s(22374),g=s(20669),ae=s(22812),K=s(97939),A=s(52454),S,H,m=K.ZP.div(S||(S=(0,y.Z)([`
    width: calc(100% - 200px - 20px);
    height: 100px;
    overflow: hidden;
    margin-left: 20px;
`]))),ie=(0,K.ZP)(g.Z)(H||(H=(0,y.Z)([`
    & {
        height: 200px;
        width: 200px;  
    }
`]))),J=function(P,oe){var u=P.onCancel,le=P.onOk,E=C.useState(""),X=(0,G.Z)(E,2),h=X[0],q=X[1],x=C.useState(!1),M=(0,G.Z)(x,2),p=M[0],n=M[1];C.useImperativeHandle(oe,function(){return{show:function(w){n(!0),q(w)}}});var N=(0,C.useRef)(null),k=function(){n(!1),q(""),u&&u()},ee=function(){N.current.getCroppedCanvas().toBlob(function(){var w=(0,Y.Z)((0,z.Z)().mark(function $(se){var L,I;return(0,z.Z)().wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return L=new FormData,L.append("file",se),j.next=4,(0,ae.WY)("/api/sys/upload/",{method:"post",data:L});case 4:I=j.sent,le(I),k();case 7:case"end":return j.stop()}},$)}));return function($){return w.apply(this,arguments)}}())};return(0,A.jsx)(Q.Z,{open:p,onCancel:k,onOk:ee,title:"\u56FE\u7247\u88C1\u5207",maskClosable:!1,children:(0,A.jsxs)(U.Z,{children:[(0,A.jsx)(ie,{ref:N,src:h,aspectRatio:1,guides:!0,preview:".preview"}),(0,A.jsx)(m,{className:"preview"})]})})};B.Z=(0,C.forwardRef)(J)},43562:function(V,B,s){"use strict";s.r(B);var Me=s(16832),Q=s(69827),Oe=s(46721),U=s(94867),z=s(29143),Y=s(34517),G=s(88966),y=s(11048),C=s(20693),g=s(3278),ae=s(57359),K=s(34423),A=s(163),S=s(60318),H=s(26388),m=s(35832),ie=s(81138),J=s(96146),Z=s(32326),P=s(20418),oe=s(65790),u=s(17187),le=s(14320),E=s(53479),X=s(70772),h=s(6701),q=s(31650),x=s(25100),M=s(39190),p=s(22374),n=s(22812),N=s(68591),k=s.n(N),ee=s(55580),a=s.n(ee),w=s(74066),$=s(72882),se=s(53770),L=s(5888),I=s(29197),ce=s(37834),j=s(97207),O=s.n(j),xe=s(39935),e=s(52454),de=function(f){var _e=(0,p.useState)(!1),b=(0,M.Z)(_e,2),D=b[0],R=b[1];return(0,e.jsx)(E.Z,{children:(0,e.jsxs)(h.Z,{span:24,children:[(0,e.jsx)(x.Z.Text,{children:f.name}),(0,e.jsxs)("span",{className:a().question_tip_layout,onMouseEnter:function(){return R(!0)},onMouseLeave:function(){return R(!1)},children:[(0,e.jsx)(w.Z,{className:a().question_icon}),(0,e.jsx)("div",{style:{display:D?"block":"none"},className:k()(a().question_tip_wrapper,a().w_384),children:(0,e.jsx)("p",{children:f.tip})})]})]})})};B.default=function(){var ue=(0,n.YB)(),f=ue.formatMessage,_e=(0,p.useState)({path:"",link:""}),b=(0,M.Z)(_e,2),D=b[0],R=b[1],ne=(0,n.md)(),je=(0,p.useState)(!1),me=(0,M.Z)(je,2),re=me[0],pe=me[1],De=u.Z.useForm(),ye=(0,M.Z)(De,1),te=ye[0],Ce=(0,p.useState)(!1),fe=(0,M.Z)(Ce,2),ge=fe[0],T=fe[1],Ze=(0,p.useState)(innerHeight),Ee=(0,M.Z)(Ze,2),Ie=Ee[0],Re=Ee[1],F=(0,p.useRef)(null),he=p.useRef();(0,p.useEffect)(function(){var _=window.sessionStorage.getItem("create_ws_info");_&&(window.sessionStorage.removeItem("create_ws_info"),_=JSON.parse(_),te.setFieldsValue({show_name:O().get(_,"ws_info.show_name")&&O().get(_,"ws_info.show_name").split("[")[0],name:O().get(_,"ws_info.name")&&O().get(_,"ws_info.name").split("[")[0],description:O().get(_,"ws_info.description"),reason:O().get(_,"reason"),is_public:O().get(_,"ws_info.is_public"),logo:O().get(_,"ws_info.logo")}),R((0,P.Z)((0,P.Z)({},D),{},{link:O().get(_,"ws_info.logo")})))},[]);var Te=function(r){var i=new FileReader;return i.onload=function(l){var o;(o=he.current)===null||o===void 0||o.show(l.target.result)},i.readAsDataURL(r),!1},We=function(){var _=(0,Z.Z)((0,m.Z)().mark(function r(i){var l,o,v,t;return(0,m.Z)().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,(0,I.MB)(i);case 2:l=c.sent,o=l.data,v=l.code,t=l.msg,v===200?(clearInterval(F.current),n.m8.push("/ws/".concat(o.id,"/workspace/initSuccess"))):J.default.error(t||f({id:"workspace.submit.failed"}),2,function(){clearInterval(F.current),pe(!1)});case 7:case"end":return c.stop()}},r)}));return function(i){return _.apply(this,arguments)}}();(0,p.useEffect)(function(){var _=document.querySelector("#createWs #rigthContent");_&&Re(_.offsetHeight+26)},[]);var ve=function(){var r=document.querySelectorAll("#createWs .dot");if(r)return Array.from(r).forEach(function(i){i.style.opacity=0}),r};(0,p.useEffect)(function(){if(re){var _=ve();if(_&&_.length){_[0].style.opacity=1;var r=0;F.current=setInterval(function(){r=r+1<3?r+1:0,r===0&&ve(),_[r].style.opacity=1},500)}}return function(){clearInterval(F.current)}},[re]);var Pe=function(){var _=(0,Z.Z)((0,m.Z)().mark(function r(i,l){var o,v,t;return(0,m.Z)().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,(0,I.Ex)((0,H.Z)({},i,l));case 2:if(o=c.sent,v=o.code,t=o.msg,v===200){c.next=8;break}return te.setFields([{name:i,errors:[t]}]),c.abrupt("return");case 8:return c.abrupt("return",!0);case 9:case"end":return c.stop()}},r)}));return function(i,l){return _.apply(this,arguments)}}();return(0,e.jsxs)(Q.Z.Content,{className:a().create_layout,id:"createWs",children:[(0,e.jsxs)(E.Z,{className:a().create_main,gutter:8,justify:"space-between",children:[(0,e.jsx)(h.Z,{span:10,className:a().mb_55,style:{marginTop:20},children:(0,e.jsx)(h.Z,{span:18,offset:6,children:(0,e.jsxs)(u.Z,{form:te,layout:"vertical",className:a().full_width,initialValues:{is_public:!1},onFinish:function(){var _=(0,Z.Z)((0,m.Z)().mark(function r(i){var l,o,v,t,W;return(0,m.Z)().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return T(!0),l=i.show_name,o=i.name,d.next=4,Pe("show_name",l);case 4:if(v=d.sent,v){d.next=7;break}return d.abrupt("return",T(!1));case 7:return d.next=9,Pe("name",o);case 9:if(t=d.sent,t){d.next=12;break}return d.abrupt("return",T(!1));case 12:if(!ne.IsAdmin()){d.next=18;break}pe(!0),We((0,P.Z)((0,P.Z)({},i),{},{logo:D.path})),T(!1),d.next=22;break;case 18:return d.next=20,(0,I.MB)((0,P.Z)((0,P.Z)({},i),{},{logo:D.path}));case 20:W=d.sent,W.code===200?(S.default.open({message:(0,e.jsx)(n._H,{id:"workspace.submit.success"}),description:(0,e.jsxs)("span",{children:[(0,e.jsx)(n._H,{id:"workspace.submit.desc1"}),(0,e.jsx)("span",{style:{color:"#1890FF",cursor:"pointer"},onClick:function(){return n.m8.push("/personCenter?person=approve")},children:(0,e.jsx)(n._H,{id:"workspace.submit.desc2"})})]}),icon:(0,e.jsx)(L.Z,{style:{color:"#52c41a"}}),duration:3}),T(!1),n.m8.go(-1)):((0,xe.EV)(W.code,W.msg),T(!1));case 22:case"end":return d.stop()}},r)}));return function(r){return _.apply(this,arguments)}}(),children:[(0,e.jsx)(u.Z.Item,{label:" ",children:(0,e.jsx)(K.Z,{children:(0,e.jsx)(x.Z.Title,{level:3,children:(0,e.jsx)(n._H,{id:"workspace.ws.create"})})})}),(0,e.jsx)(u.Z.Item,{rules:[{required:!0,validator:function(){var _=(0,Z.Z)((0,m.Z)().mark(function i(l,o){return(0,m.Z)().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(o){t.next=2;break}return t.abrupt("return",Promise.reject(f({id:"workspace.show_name.rules1"})));case 2:if(/^[A-Za-z0-9\u4e00-\u9fa5\._-]{1,30}$/.test(o)){t.next=4;break}return t.abrupt("return",Promise.reject(f({id:"workspace.show_name.rules2"})));case 4:return t.abrupt("return",Promise.resolve());case 5:case"end":return t.stop()}},i)}));function r(i,l){return _.apply(this,arguments)}return r}()}],label:(0,e.jsx)(n._H,{id:"workspace.show_name.s"}),name:"show_name",children:(0,e.jsx)(g.Z,{autoComplete:"off",placeholder:f({id:"workspace.show_name.placeholder"}),allowClear:!0})}),(0,e.jsx)(u.Z.Item,{rules:[{required:!0,validator:function(){var _=(0,Z.Z)((0,m.Z)().mark(function i(l,o){return(0,m.Z)().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(o){t.next=2;break}return t.abrupt("return",Promise.reject(f({id:"workspace.ws.name.rules1"})));case 2:if(/^[a-z0-9_-]{0,30}$/.test(o)){t.next=4;break}return t.abrupt("return",Promise.reject(f({id:"workspace.ws.name.rules2"})));case 4:return t.abrupt("return",Promise.resolve());case 5:case"end":return t.stop()}},i)}));function r(i,l){return _.apply(this,arguments)}return r}()}],label:(0,e.jsx)(de,{name:(0,e.jsx)(n._H,{id:"workspace.ws.name"}),tip:(0,e.jsx)(n._H,{id:"workspace.ws.tip"}),path:""}),name:"name",children:(0,e.jsx)(g.Z,{autoComplete:"off",placeholder:f({id:"workspace.ws.name.placeholder"}),allowClear:!0})}),(0,e.jsx)(u.Z.Item,{rules:[{required:!0,max:200}],label:(0,e.jsx)(n._H,{id:"workspace.description"}),name:"description",children:(0,e.jsx)(g.Z.TextArea,{rows:3,allowClear:!0,placeholder:f({id:"workspace.description.placeholder"})})}),(0,e.jsx)(u.Z.Item,{rules:[{required:!0,max:200}],label:(0,e.jsx)(n._H,{id:"workspace.reason"}),name:"reason",children:(0,e.jsx)(g.Z.TextArea,{allowClear:!0,rows:4,placeholder:f({id:"workspace.reason.placeholder"})})}),(0,e.jsx)(u.Z.Item,{rules:[{required:!0}],name:"is_public",label:(0,e.jsx)(de,{name:(0,e.jsx)(n._H,{id:"workspace.is_public"}),tip:(0,e.jsx)(n._H,{id:"workspace.is_public.tip"}),path:""}),children:(0,e.jsxs)(y.ZP.Group,{children:[(0,e.jsx)(y.ZP,{value:!1,className:a().mb_16,children:(0,e.jsx)("span",{children:(0,e.jsx)(n._H,{id:"workspace.private.ps"})})}),(0,e.jsx)("br",{}),(0,e.jsx)(y.ZP,{value:!0,children:(0,e.jsx)("span",{children:(0,e.jsx)(n._H,{id:"workspace.public.ps"})})})]})}),(0,e.jsx)(u.Z.Item,{label:(0,e.jsx)(n._H,{id:"workspace.project.cover"}),children:(0,e.jsx)(u.Z.Item,{name:"logo",noStyle:!0,children:(0,e.jsxs)("div",{style:{display:"flex",justifyContent:"flex-start",alignItems:"center"},children:[(0,e.jsx)("div",{style:{marginRight:16},children:(0,e.jsx)(Y.Z,{name:"file",listType:"picture-card",className:"avatar-uploader",showUploadList:!1,action:"/api/sys/upload/",beforeUpload:Te,onChange:function(r){r.file.status==="done"&&R(r)},children:D.link?(0,e.jsx)("img",{src:D.link,alt:"avatar",style:{width:"100%"}}):(0,e.jsx)($.Z,{})})}),(0,e.jsx)("div",{style:{display:"flex",alignItems:"center"},children:(0,e.jsxs)(E.Z,{children:[(0,e.jsx)(h.Z,{span:24,children:(0,e.jsx)(n._H,{id:"workspace.cover.drag"})}),(0,e.jsx)(h.Z,{span:24,children:(0,e.jsx)(n._H,{id:"workspace.cover.size"})})]})})]})})}),(0,e.jsx)(u.Z.Item,{style:{marginTop:30},children:(0,e.jsx)(U.Z,{type:"primary",disabled:ge,htmlType:"submit",children:(0,e.jsx)(n._H,{id:"workspace.submit.review"})})})]})})}),(0,e.jsx)(h.Z,{span:14,className:a().rigth_content,id:"rigthContent",children:(0,e.jsxs)(E.Z,{children:[(0,e.jsx)(h.Z,{offset:3,span:3,style:{borderLeft:"1px solid rgba(0,0,0,.06)"}}),(0,e.jsxs)(h.Z,{span:12,children:[(0,e.jsx)(E.Z,{className:a().create_banner}),(0,e.jsx)(E.Z,{className:a().issue_title,children:(0,e.jsx)(n._H,{id:"workspace.ws.about"})}),(0,e.jsx)(E.Z,{children:(0,e.jsxs)("ul",{className:a().performance_ul,children:[(0,e.jsx)("li",{children:(0,e.jsx)(x.Z.Text,{type:"secondary",children:(0,e.jsx)(n._H,{id:"workspace.li1"})})}),(0,e.jsx)("li",{children:(0,e.jsx)(x.Z.Text,{type:"secondary",children:(0,e.jsx)(n._H,{id:"workspace.li2"})})}),(0,e.jsx)("li",{children:(0,e.jsx)(x.Z.Text,{type:"secondary",children:(0,e.jsx)(n._H,{id:"workspace.li3"})})})]})}),(0,e.jsx)(E.Z,{children:(0,e.jsx)(U.Z,{type:"link",onClick:function(){return n.m8.push("/help_doc")},children:(0,e.jsx)(n._H,{id:"workspace.see.more"})})})]})]})}),(0,e.jsxs)(U.Z,{className:a().close_btn,onClick:function(){return n.m8.go(-1)},children:[(0,e.jsx)(se.Z,{}),(0,e.jsx)(n._H,{id:"operation.close"})]}),(0,e.jsx)(ce.Z,{ref:he,onOk:function(r){r&&R(r)}})]}),re&&(0,e.jsx)("div",{style:{height:Ie},className:a().systerm_init,children:(0,e.jsx)("div",{className:a().init_box,children:(0,e.jsxs)("div",{className:a().init_container,children:[(0,e.jsx)("div",{className:a().icon_gif}),(0,e.jsxs)("div",{className:a().init_text,children:[(0,e.jsx)(n._H,{id:"workspace.system.initialization"}),(0,e.jsx)("span",{className:"dot"}),(0,e.jsx)("span",{className:"dot"}),(0,e.jsx)("span",{className:"dot"})]})]})})})]})}}}]);
