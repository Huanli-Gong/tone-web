(self.webpackChunktone_front=self.webpackChunktone_front||[]).push([[4864,2485],{88737:function(G){G.exports={roleStyle:"roleStyle___36aEv"}},57476:function(G){G.exports={layout:"layout___2yFTo",ws_slider:"ws_slider___1zVuy",ws_menu_styles:"ws_menu_styles___3L0T1",ws_sb_st:"ws_sb_st___3rvCe",content:"content___2Oc8K",tab_style:"tab_style___3GIsz",select_baseline:"select_baseline___1y8k4"}},58136:function(){},87415:function(G,K,e){"use strict";e.d(K,{mQ:function(){return N},gM:function(){return x},nU:function(){return c}});var y=e(58024),b=e(91894),E=e(20310),w=e(12788),A,j,$,g,N=(0,w.ZP)(b.Z)(A||(A=(0,E.Z)([`
    border:none !important;
    .ant-card-head {
        min-height: 48px;
        .ant-tabs-tab { min-height : 48px; }
        .ant-card-head-title{
            padding: 0;
        }
        .ant-card-extra {
            padding: 0;
        }
    }
    .common_pagination { padding-bottom:0 ;}
`]))),x=(0,w.ZP)(N)(j||(j=(0,E.Z)([`
    border:none!important;
    .ant-card-head .ant-card-head-wrapper { min-height:48px; }
    .ant-card-head-title { font-weight: normal; font-size:14px;}
    .commom_pagination { margin-bottom:0 ;}
    .ant-tabs-nav { margin : 0 ;}
    .ant-spin-nested-loading > div > .ant-spin {
        position: fixed;
        left: 50%;
        top: 50%;
        transform: translate(-50%, -50%);
    }
`]))),H=(0,w.ZP)(b.Z)($||($=(0,E.Z)([`
    border:none !important;
    .ant-card-head {
        min-height: 48px;
        padding: 0 32px;
        .ant-tabs-tab { min-height : 48px; }
        .ant-card-head-title{
            padding: 0;
        }
        .ant-card-extra {
            padding: 0;
        }
    }
    .ant-card-body{
        padding: 24px 24px 24px 0px;
    }
    .common_pagination { padding-bottom:0 ;}
`]))),c=(0,w.ZP)(H)(g||(g=(0,E.Z)([`
    border:none!important;
    .ant-card-head .ant-card-head-wrapper { min-height:48px; }
    .ant-card-head-title { font-weight: normal; font-size:14px;}
    .commom_pagination { margin-bottom:0 ;}
    .ant-tabs-nav { margin : 0 ;}
    .ant-spin-nested-loading > div > .ant-spin {
        position: fixed;
        left: 50%;
        top: 50%;
        transform: translate(-50%, -50%);
    }
`])))},769:function(G,K,e){"use strict";e.d(K,{Uy:function(){return w},wD:function(){return j},C2:function(){return g},VK:function(){return x}});var y=e(39428),b=e(3182),E=e(16917);function w(c){return A.apply(this,arguments)}function A(){return A=(0,b.Z)((0,y.Z)().mark(function c(D){return(0,y.Z)().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",(0,E.WY)("/api/auth/role/",{params:D}));case 1:case"end":return l.stop()}},c)})),A.apply(this,arguments)}function j(c){return $.apply(this,arguments)}function $(){return $=(0,b.Z)((0,y.Z)().mark(function c(D){return(0,y.Z)().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",(0,E.WY)("/api/auth/user/",{params:D}));case 1:case"end":return l.stop()}},c)})),$.apply(this,arguments)}function g(c){return N.apply(this,arguments)}function N(){return N=(0,b.Z)((0,y.Z)().mark(function c(D){return(0,y.Z)().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",(0,E.WY)("/api/auth/user/",{method:"POST",data:D}));case 1:case"end":return l.stop()}},c)})),N.apply(this,arguments)}function x(c){return H.apply(this,arguments)}function H(){return H=(0,b.Z)((0,y.Z)().mark(function c(D){return(0,y.Z)().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",(0,E.WY)("/api/auth/reset_password/",{method:"POST",data:D}));case 1:case"end":return l.stop()}},c)})),H.apply(this,arguments)}},48192:function(G,K,e){"use strict";e.r(K),e.d(K,{default:function(){return Je}});var y=e(24793),b=e(97183),E=e(71194),w=e(50146),A=e(43358),j=e(34041),$=e(13062),g=e(71230),N=e(402),x=e(97272),H=e(89032),c=e(15746),D=e(94233),V=e(51890),l=e(18106),X=e(73272),Q=e(49111),ce=e(19650),Ce=e(57663),me=e(71577),Me=e(65011),ge=e(49288),_e=e(47673),he=e(4107),ee=e(34792),J=e(48086),I=e(11849),u=e(39428),O=e(3182),T=e(9715),z=e(20526),p=e(2824),v=e(67294),d=e(16917),ne=e(90105),We=e(57476),be=e.n(We),En=e(66456),Ae=e(79764),xn=e(62350),Ie=e(24565),On=e(71153),Ue=e(60331),Be=e(88737),Ke=e.n(Be),ae=e(24480),$e=e(20009),n=e(85893),Ne=function(U){var m=(0,d.YB)(),_=m.formatMessage,te=(0,$e.UO)(),F=te.ws_id,C=U.user_info,Y=U.select,re=C.role_list,fe=C.id,oe=C.can_update,ie=re.map(function(R){return R.name}),k=function(){var R=(0,O.Z)((0,u.Z)().mark(function se(Z){var q;return(0,u.Z)().wrap(function(B){for(;;)switch(B.prev=B.next){case 0:return B.next=2,(0,ne.Am)({ws_id:F,role_id:Z,user_id:fe});case 2:q=B.sent,q.code===200?(J.default.success(_({id:"member.role.modified.success"})),U.handleOk(),U.onOk()):(0,ae.EV)(q.code,q.msg);case 4:case"end":return B.stop()}},se)}));return function(Z){return R.apply(this,arguments)}}();return oe?(0,n.jsx)("div",{className:Ke().roleStyle,children:(0,n.jsx)(j.Z,{size:"small",value:(0,ae.u)(ie[0],_),showSearch:!1,bordered:!1,dropdownMatchSelectWidth:!1,style:{fontSize:14,marginLeft:-10},onSelect:k,children:Y==null?void 0:Y.map(function(R){return(0,n.jsx)(j.Z.Option,{value:R.id,children:(0,ae.u)(R.name,_)},R.id)})})}):(0,n.jsx)("span",{children:(0,ae.u)(re[0].name,_)})},He=e(86213),ze=function(U){var m=U.user_info,_=(0,d.YB)(),te=_.formatMessage,F=m.first_name,C=m.last_name;return F&&C?(0,n.jsx)(x.Z.Text,{children:F+"(".concat(C,")")}):(0,n.jsx)(x.Z.Text,{children:F||C})},Fe=function(L){var U=(0,d.YB)(),m=U.formatMessage,_=L.role,te=L.keyword,F=L.refresh,C=L.onOk,Y=L.roleData,re=L.match.params.ws_id,fe=(0,d.md)(),oe=(0,v.useState)({}),ie=(0,p.Z)(oe,2),k=ie[0],R=ie[1],se=(0,v.useState)(!0),Z=(0,p.Z)(se,2),q=Z[0],ve=Z[1],B=(0,v.useState)({page_num:1,page_size:10}),ue=(0,p.Z)(B,2),de=ue[0],Ze=ue[1],le=function(){var S=(0,O.Z)((0,u.Z)().mark(function r(P){var W;return(0,u.Z)().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return ve(!0),f.next=3,(0,ne.bu)((0,I.Z)((0,I.Z)((0,I.Z)({},de),P),{},{ws_id:re,role:_,keyword:te}));case 3:W=f.sent,R(W),ve(!1);case 6:case"end":return f.stop()}},r)}));return function(P){return S.apply(this,arguments)}}();(0,v.useEffect)(function(){le()},[de,F]),(0,v.useEffect)(function(){le({page_num:1})},[te]);var ye=[{title:(0,n.jsx)(d._H,{id:"member.member"}),render:function(r){return(0,n.jsxs)(ce.Z,{children:[(0,n.jsx)(V.C,{src:r.user_info.avatar}),(0,n.jsx)(ze,{user_info:r.user_info}),r.user_info.is_admin?(0,n.jsx)("div",{style:{backgroundColor:"#F9AD10",borderRadius:2,fontSize:12,padding:"0 4px"},children:(0,n.jsx)("span",{style:{color:"#fff"},children:(0,n.jsx)(d._H,{id:"member.manage.tag"})})}):null,r.user_info.is_self?(0,n.jsx)(Ue.Z,{color:"rgba(140,140,140,0.1)",style:{color:"rgba(0,0,0,0.65)",marginRight:0},children:(0,n.jsx)(d._H,{id:"member.oneself"})}):null]})}},{title:(0,n.jsx)(d._H,{id:"member.account"}),render:function(r){return(0,n.jsx)(x.Z.Text,{children:r.user_info.username})}},{title:(0,n.jsx)(d._H,{id:"member.role"}),render:function(r){return(0,n.jsx)(Ne,(0,I.Z)((0,I.Z)({},r),{},{select:Y,handleOk:le,onOk:C}))}},{title:(0,n.jsx)(d._H,{id:"member.join_date"}),dataIndex:"join_date"},fe.WsBtnPermission()&&{title:(0,n.jsx)(d._H,{id:"Table.columns.operation"}),align:"center",render:function(r){return r.user_info.is_self||!r.user_info.can_update?(0,n.jsx)(me.Z,{type:"link",disabled:!0,children:(0,n.jsx)(d._H,{id:"member.remove"})}):(0,n.jsx)(Ie.Z,{title:(0,n.jsx)(d._H,{id:"member.Are.you.sure.remove.user"}),okText:(0,n.jsx)(d._H,{id:"operation.ok"}),cancelText:(0,n.jsx)(d._H,{id:"operation.cancel"}),onConfirm:function(){return Ee(r.user_info.id)},children:(0,n.jsx)(me.Z,{type:"link",children:(0,n.jsx)(d._H,{id:"member.remove"})})})}}].filter(Boolean),Ee=function(){var S=(0,O.Z)((0,u.Z)().mark(function r(P){var W;return(0,u.Z)().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.prev=0,f.next=3,(0,ne.A7)({ws_id:re,user_id:P});case 3:W=f.sent,W.code===200?(J.default.success(m({id:"operation.success"})),C()):(0,ae.EV)(W.code,W.msg),le(),f.next=12;break;case 8:f.prev=8,f.t0=f.catch(0),console.log(f.t0),J.default.error(m({id:"member.an.error.occurred,please.try.again"}));case 12:case"end":return f.stop()}},r,null,[[0,8]])}));return function(P){return S.apply(this,arguments)}}();return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(Ae.Z,{size:"small",loading:q,rowKey:function(r){return r.user_info.id},rowClassName:function(){return"editable-row"},columns:ye,dataSource:k.data,pagination:!1}),(0,n.jsx)(He.Z,{pageSize:de.page_size,total:k.total,currentPage:de.page_num,onPageChange:function(r,P){return Ze({page_num:r,page_size:P})}})]})},Se=e(769),Ye=e(87415),Ge=e(96486),Ve=e.n(Ge),Xe,Qe,Je=function(L){var U=(0,d.YB)(),m=U.formatMessage,_=L.match.params.ws_id,te=(0,d.md)(),F=(0,v.useState)("ws_owner"),C=(0,p.Z)(F,2),Y=C[0],re=C[1],fe=(0,v.useState)(""),oe=(0,p.Z)(fe,2),ie=oe[0],k=oe[1],R=(0,v.useState)({all_count:0,ws_owner:0,ws_admin:0,ws_test_admin:0,ws_member:0}),se=(0,p.Z)(R,2),Z=se[0],q=se[1],ve=(0,v.useState)([]),B=(0,p.Z)(ve,2),ue=B[0],de=B[1],Ze=(0,v.useState)([]),le=(0,p.Z)(Ze,2),ye=le[0],Ee=le[1],S=(0,v.useState)(!1),r=(0,p.Z)(S,2),P=r[0],W=r[1],xe=(0,v.useState)(new Date().getTime()),f=(0,p.Z)(xe,2),Pe=f[0],ke=f[1],qe=(0,v.useState)(!1),we=(0,p.Z)(qe,2),en=we[0],Oe=we[1],nn=(0,v.useState)([]),De=(0,p.Z)(nn,2),an=De[0],tn=De[1],rn=(0,v.useState)([]),Te=(0,p.Z)(rn,2),sn=Te[0],ln=Te[1],on=z.Z.useForm(),un=(0,p.Z)(on,1),je=un[0],Le=function(){var a=(0,O.Z)((0,u.Z)().mark(function t(){var o,s,h,i=arguments;return(0,u.Z)().wrap(function(pe){for(;;)switch(pe.prev=pe.next){case 0:return o=i.length>0&&i[0]!==void 0?i[0]:"",pe.next=3,(0,ne.tR)({keyword:o,scope:"aligroup"});case 3:s=pe.sent,h=s.data,de(h);case 6:case"end":return pe.stop()}},t)}));return function(){return a.apply(this,arguments)}}(),dn=function(){var a=(0,O.Z)((0,u.Z)().mark(function t(){var o,s;return(0,u.Z)().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,(0,Se.Uy)({role_type:"workspace",ws_id:_,is_filter:"1"});case 2:o=i.sent,s=o.data,s&&ln(s.list);case 5:case"end":return i.stop()}},t)}));return function(){return a.apply(this,arguments)}}();(0,v.useEffect)(function(){dn()},[_]);var cn=function(){var a=(0,O.Z)((0,u.Z)().mark(function t(){var o,s;return(0,u.Z)().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,(0,Se.Uy)({role_type:"workspace",ws_id:_});case 2:o=i.sent,s=o.data,s&&tn(s.list);case 5:case"end":return i.stop()}},t)}));return function(){return a.apply(this,arguments)}}();(0,v.useEffect)(function(){return cn(),function(){clearTimeout(Xe),clearTimeout(Qe)}},[P]);var mn=function(t,o){return t.replace(new RegExp("(".concat(o,")")),'<span style="color:#1890ff">$1</span>')},fn=function(t,o){return t.map(function(s){var h=s.user_info;return{value:h.last_name,label:(0,n.jsx)("div",{style:{display:"flex",justifyContent:"space-between"},children:(0,n.jsx)("div",{dangerouslySetInnerHTML:{__html:mn(h.last_name,o)}})})}})},vn=Ve().debounce(function(){var a=(0,O.Z)((0,u.Z)().mark(function t(o){var s,h;return(0,u.Z)().wrap(function(M){for(;;)switch(M.prev=M.next){case 0:if(!o){M.next=6;break}return M.next=3,(0,ne.bu)({keyword:o,ws_id:_});case 3:s=M.sent,h=s.data,Ee(h?fn(h,o):[]);case 6:case"end":return M.stop()}},t)}));return function(t){return a.apply(this,arguments)}}(),200),pn=function(t){k(t)},hn=function(){en||je.validateFields().then(function(){var t=(0,O.Z)((0,u.Z)().mark(function o(s){var h;return(0,u.Z)().wrap(function(M){for(;;)switch(M.prev=M.next){case 0:return console.log(s),Oe(!0),M.next=4,(0,ne.TP)((0,I.Z)({ws_id:_},s));case 4:h=M.sent,Oe(!1),h.code===200?(J.default.success(m({id:"operation.success"})),W(!1),ke(new Date().getTime())):(0,ae.EV)(h.code,h.msg);case 7:case"end":return M.stop()}},o)}));return function(o){return t.apply(this,arguments)}}()).catch(function(t){console.log(t),Oe(!1)})},gn=function(){return W(!1)},_n=function(){var a=(0,O.Z)((0,u.Z)().mark(function t(){return(0,u.Z)().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:je.resetFields(),W(!0),Le();case 3:case"end":return s.stop()}},t)}));return function(){return a.apply(this,arguments)}}(),Zn=[{name:"".concat(m({id:"member.ws_owner"})," ").concat(Z.ws_owner),role:"ws_owner"},{name:"".concat(m({id:"member.ws_admin"})," ").concat(Z==null?void 0:Z.ws_admin),role:"ws_admin"},{name:"".concat(m({id:"member.ws_test_admin"})," ").concat(Z==null?void 0:Z.ws_test_admin),role:"ws_test_admin"},{name:"".concat(m({id:"member.ws_member"})," ").concat(Z.ws_member),role:"ws_member"}],Re=function(){var a=(0,O.Z)((0,u.Z)().mark(function t(){var o,s;return(0,u.Z)().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,(0,ne.X9)({ws_id:_});case 2:o=i.sent,s=o.data,q(s);case 5:case"end":return i.stop()}},t)}));return function(){return a.apply(this,arguments)}}();(0,v.useEffect)(function(){Re()},[Y,Pe]);var yn=function(t){k(""),re(t)};return(0,n.jsxs)(b.Z.Content,{children:[(0,n.jsx)(Ye.gM,{title:"".concat(m({id:"all"})," ").concat(Z.all_count),extra:(0,n.jsxs)(ce.Z,{children:[(0,n.jsx)(ge.Z,{dropdownMatchSelectWidth:!0,style:{width:200},options:ye,onSelect:pn,onSearch:vn,children:(0,n.jsx)(he.Z.Search,{placeholder:m({id:"member.search.users"}),onPressEnter:function(t){return k(t.target.value)}})}),(0,n.jsx)(d.Nv,{accessible:te.WsBtnPermission(),children:(0,n.jsx)(me.Z,{type:"primary",onClick:_n,children:(0,n.jsx)(d._H,{id:"member.add.member"})})})]}),children:(0,n.jsx)(X.Z,{className:be().tab_style,onChange:yn,type:"card",children:Zn.map(function(a){return(0,n.jsx)(X.Z.TabPane,{tab:a.name,children:Y===a.role&&(0,n.jsx)(Fe,(0,I.Z)((0,I.Z)({refresh:Pe,role:Y,keyword:ie},L),{},{roleData:sn,onOk:Re}))},a.role)})})}),P&&(0,n.jsx)(w.Z,{title:m({id:"member.add.member"}),open:P,onOk:hn,onCancel:gn,maskClosable:!1,children:(0,n.jsxs)(z.Z,{layout:"vertical",form:je,children:[(0,n.jsx)(z.Z.Item,{label:(0,n.jsx)(d._H,{id:"member.user"}),name:"emp_id_list",rules:[{required:!0,message:m({id:"member.please.select.user"})}],children:(0,n.jsx)(j.Z,{style:{width:"100%"},optionLabelProp:"label",className:be().select_baseline,mode:"multiple",defaultActiveFirstOption:!1,filterOption:!1,onSearch:function(t){return Le(t)},children:ue==null?void 0:ue.map(function(a){return(0,n.jsx)(j.Z.Option,{value:a.emp_id,label:a.last_name,children:(0,n.jsxs)(g.Z,{children:[(0,n.jsx)(c.Z,{span:2,children:(0,n.jsx)(V.C,{size:25,src:a.avatar})}),(0,n.jsxs)(c.Z,{span:22,children:[(0,n.jsx)(g.Z,{children:(0,n.jsx)(ce.Z,{children:(0,n.jsxs)(x.Z.Text,{children:[a.last_name,"(",a.first_name===""?a.last_name:a.first_name,") - ",a.emp_id]})})}),(0,n.jsx)(g.Z,{children:(0,n.jsx)(x.Z.Text,{children:a.job_desc})}),(0,n.jsx)(g.Z,{children:(0,n.jsx)(x.Z.Text,{children:a.dep_desc})})]})]})},a.id)})})}),(0,n.jsx)(z.Z.Item,{label:(0,n.jsx)(d._H,{id:"member.role"}),name:"role_id",rules:[{required:!0,message:m({id:"member.please.select.role"})}],children:(0,n.jsx)(j.Z,{style:{width:"100%",minHeight:32},placeholder:m({id:"member.please.select.role"}),allowClear:!0,showArrow:!0,children:an.map(function(a){return(0,n.jsx)(j.Z.Option,{value:a.id,children:(0,ae.u)(a.name,m)},a.id)})})})]})})]})}},49288:function(G,K,e){"use strict";var y=e(22122),b=e(90484),E=e(28481),w=e(94184),A=e.n(w),j=e(37419),$=e(10366),g=e(67294),N=e(53124),x=e(34041),H=e(96159),c=x.Z.Option;function D(X){return X&&X.type&&(X.type.isSelectOption||X.type.isSelectOptGroup)}var V=function(Q,ce){var Ce=Q.prefixCls,me=Q.className,Me=Q.popupClassName,ge=Q.dropdownClassName,_e=Q.children,he=Q.dataSource,ee=(0,j.Z)(_e),J;if(ee.length===1&&(0,H.l$)(ee[0])&&!D(ee[0])){var I=(0,E.Z)(ee,1);J=I[0]}var u=J?function(){return J}:void 0,O;return ee.length&&D(ee[0])?O=_e:O=he?he.map(function(T){if((0,H.l$)(T))return T;switch((0,b.Z)(T)){case"string":return g.createElement(c,{key:T,value:T},T);case"object":{var z=T.value;return g.createElement(c,{key:z,value:z},T.text)}default:return}}):[],g.createElement(N.C,null,function(T){var z=T.getPrefixCls,p=z("select",Ce);return g.createElement(x.Z,(0,y.Z)({ref:ce},(0,$.Z)(Q,["dataSource"]),{prefixCls:p,popupClassName:Me||ge,className:A()("".concat(p,"-auto-complete"),me),mode:x.Z.SECRET_COMBOBOX_MODE_DO_NOT_USE},{getInputElement:u}),O)})},l=g.forwardRef(V);l.Option=c,K.Z=l},65011:function(G,K,e){"use strict";var y=e(38663),b=e.n(y),E=e(58136),w=e.n(E),A=e(43358)}}]);
