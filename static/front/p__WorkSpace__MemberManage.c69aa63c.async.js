(self.webpackChunktone_front=self.webpackChunktone_front||[]).push([[4864,2485],{60645:function(G){G.exports={roleStyle:"roleStyle___36aEv"}},60363:function(G){G.exports={layout:"layout___2yFTo",ws_slider:"ws_slider___1zVuy",ws_menu_styles:"ws_menu_styles___3L0T1",ws_sb_st:"ws_sb_st___3rvCe",content:"content___2Oc8K",tab_style:"tab_style___3GIsz",select_baseline:"select_baseline___1y8k4"}},51812:function(){},75073:function(G,I,e){"use strict";e.d(I,{mQ:function(){return K},gM:function(){return E},nU:function(){return c}});var Z=e(40204),b=e(10724),y=e(41428),w=e(97939),W,C,B,h,K=(0,w.ZP)(b.Z)(W||(W=(0,y.Z)([`
    border:none !important;
    .ant-card-head {
        min-height: 48px;
        .ant-tabs-tab { min-height : 48px; }
        .ant-card-head-title{
            padding: 0;
        }
        .ant-card-extra {
            padding: 0;
        }
    }
    .common_pagination { padding-bottom:0 ;}
`]))),E=(0,w.ZP)(K)(C||(C=(0,y.Z)([`
    border:none!important;
    .ant-card-head .ant-card-head-wrapper { min-height:48px; }
    .ant-card-head-title { font-weight: normal; font-size:14px;}
    .commom_pagination { margin-bottom:0 ;}
    .ant-tabs-nav { margin : 0 ;}
    .ant-spin-nested-loading > div > .ant-spin {
        position: fixed;
        left: 50%;
        top: 50%;
        transform: translate(-50%, -50%);
    }
`]))),$=(0,w.ZP)(b.Z)(B||(B=(0,y.Z)([`
    border:none !important;
    .ant-card-head {
        min-height: 48px;
        padding: 0 32px;
        .ant-tabs-tab { min-height : 48px; }
        .ant-card-head-title{
            padding: 0;
        }
        .ant-card-extra {
            padding: 0;
        }
    }
    .ant-card-body{
        padding: 24px 24px 24px 0px;
    }
    .common_pagination { padding-bottom:0 ;}
`]))),c=(0,w.ZP)($)(h||(h=(0,y.Z)([`
    border:none!important;
    .ant-card-head .ant-card-head-wrapper { min-height:48px; }
    .ant-card-head-title { font-weight: normal; font-size:14px;}
    .commom_pagination { margin-bottom:0 ;}
    .ant-tabs-nav { margin : 0 ;}
    .ant-spin-nested-loading > div > .ant-spin {
        position: fixed;
        left: 50%;
        top: 50%;
        transform: translate(-50%, -50%);
    }
`])))},66804:function(G,I,e){"use strict";e.d(I,{Uy:function(){return w},wD:function(){return C},C2:function(){return h},VK:function(){return E}});var Z=e(35832),b=e(32326),y=e(22812);function w(c){return W.apply(this,arguments)}function W(){return W=(0,b.Z)((0,Z.Z)().mark(function c(D){return(0,Z.Z)().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.abrupt("return",(0,y.WY)("/api/auth/role/",{params:D}));case 1:case"end":return o.stop()}},c)})),W.apply(this,arguments)}function C(c){return B.apply(this,arguments)}function B(){return B=(0,b.Z)((0,Z.Z)().mark(function c(D){return(0,Z.Z)().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.abrupt("return",(0,y.WY)("/api/auth/user/",{params:D}));case 1:case"end":return o.stop()}},c)})),B.apply(this,arguments)}function h(c){return K.apply(this,arguments)}function K(){return K=(0,b.Z)((0,Z.Z)().mark(function c(D){return(0,Z.Z)().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.abrupt("return",(0,y.WY)("/api/auth/user/",{method:"POST",data:D}));case 1:case"end":return o.stop()}},c)})),K.apply(this,arguments)}function E(c){return $.apply(this,arguments)}function $(){return $=(0,b.Z)((0,Z.Z)().mark(function c(D){return(0,Z.Z)().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.abrupt("return",(0,y.WY)("/api/auth/reset_password/",{method:"POST",data:D}));case 1:case"end":return o.stop()}},c)})),$.apply(this,arguments)}},81415:function(G,I,e){"use strict";e.r(I),e.d(I,{default:function(){return Xe}});var Z=e(16832),b=e(69827),y=e(67515),w=e(12238),W=e(69230),C=e(33821),B=e(14320),h=e(53479),K=e(31650),E=e(25100),$=e(70772),c=e(6701),D=e(98604),V=e(68917),o=e(54905),X=e(90087),Q=e(57359),me=e(34423),je=e(46721),fe=e(94867),be=e(47721),Ze=e(47152),ye=e(20693),ge=e(3278),ne=e(81138),J=e(96146),N=e(20418),u=e(35832),O=e(32326),T=e(65790),H=e(17187),f=e(39190),v=e(22374),d=e(22812),ae=e(29197),Ue=e(60363),Se=e.n(Ue),Zn=e(11407),Ae=e(68077),yn=e(20632),Ie=e(71853),En=e(51937),Be=e(34516),Ke=e(60645),$e=e.n(Ke),te=e(39935),Ne=e(24812),n=e(52454),He=function(U){var m=(0,d.YB)(),_=m.formatMessage,re=(0,Ne.UO)(),z=re.ws_id,M=U.user_info,F=U.select,se=M.role_list,pe=M.id,oe=M.can_update,ie=se.map(function(R){return R.name}),k=function(){var R=(0,O.Z)((0,u.Z)().mark(function le(g){var q;return(0,u.Z)().wrap(function(A){for(;;)switch(A.prev=A.next){case 0:return A.next=2,(0,ae.Am)({ws_id:z,role_id:g,user_id:pe});case 2:q=A.sent,q.code===200?(J.default.success(_({id:"member.role.modified.success"})),U.handleOk(),U.onOk()):(0,te.EV)(q.code,q.msg);case 4:case"end":return A.stop()}},le)}));return function(g){return R.apply(this,arguments)}}();return oe?(0,n.jsx)("div",{className:$e().roleStyle,children:(0,n.jsx)(C.Z,{size:"small",value:(0,te.u)(ie[0],_),showSearch:!1,bordered:!1,dropdownMatchSelectWidth:!1,style:{fontSize:14,marginLeft:-10},onSelect:k,children:F==null?void 0:F.map(function(R){return(0,n.jsx)(C.Z.Option,{value:R.id,children:(0,te.u)(R.name,_)},R.id)})})}):(0,n.jsx)("span",{children:(0,te.u)(se[0].name,_)})},ze=e(76742),Fe=function(U){var m=U.user_info,_=(0,d.YB)(),re=_.formatMessage,z=m.first_name,M=m.last_name;return z&&M?(0,n.jsx)(E.Z.Text,{children:z+"(".concat(M,")")}):(0,n.jsx)(E.Z.Text,{children:z||M})},Ye=function(L){var U=(0,d.YB)(),m=U.formatMessage,_=L.role,re=L.keyword,z=L.refresh,M=L.onOk,F=L.roleData,se=L.match.params.ws_id,pe=(0,d.md)(),oe=(0,v.useState)({}),ie=(0,f.Z)(oe,2),k=ie[0],R=ie[1],le=(0,v.useState)(!0),g=(0,f.Z)(le,2),q=g[0],he=g[1],A=(0,v.useState)({page_num:1,page_size:10}),ue=(0,f.Z)(A,2),de=ue[0],Ee=ue[1],ce=function(){var S=(0,O.Z)((0,u.Z)().mark(function r(){var P;return(0,u.Z)().wrap(function(ee){for(;;)switch(ee.prev=ee.next){case 0:return he(!0),ee.next=3,(0,ae.bu)((0,N.Z)((0,N.Z)({},de),{},{ws_id:se,role:_,keyword:re}));case 3:P=ee.sent,R(P),he(!1);case 6:case"end":return ee.stop()}},r)}));return function(){return S.apply(this,arguments)}}();(0,v.useEffect)(function(){ce()},[de,re,z]);var Oe=[{title:(0,n.jsx)(d._H,{id:"member.member"}),render:function(r){return(0,n.jsxs)(me.Z,{children:[(0,n.jsx)(V.C,{src:r.user_info.avatar}),(0,n.jsx)(Fe,{user_info:r.user_info}),r.user_info.is_admin?(0,n.jsx)("div",{style:{backgroundColor:"#F9AD10",borderRadius:2,fontSize:12,padding:"0 4px"},children:(0,n.jsx)("span",{style:{color:"#fff"},children:(0,n.jsx)(d._H,{id:"member.manage.tag"})})}):null,r.user_info.is_self?(0,n.jsx)(Be.Z,{color:"rgba(140,140,140,0.1)",style:{color:"rgba(0,0,0,0.65)",marginRight:0},children:(0,n.jsx)(d._H,{id:"member.oneself"})}):null]})}},{title:(0,n.jsx)(d._H,{id:"member.account"}),render:function(r){return(0,n.jsx)(E.Z.Text,{children:r.user_info.username})}},{title:(0,n.jsx)(d._H,{id:"member.role"}),render:function(r){return(0,n.jsx)(He,(0,N.Z)((0,N.Z)({},r),{},{select:F,handleOk:ce,onOk:M}))}},{title:(0,n.jsx)(d._H,{id:"member.join_date"}),dataIndex:"join_date"},pe.WsBtnPermission()&&{title:(0,n.jsx)(d._H,{id:"Table.columns.operation"}),align:"center",render:function(r){return r.user_info.is_self||!r.user_info.can_update?(0,n.jsx)(fe.Z,{type:"link",disabled:!0,children:(0,n.jsx)(d._H,{id:"member.remove"})}):(0,n.jsx)(Ie.Z,{title:(0,n.jsx)(d._H,{id:"member.Are.you.sure.remove.user"}),okText:(0,n.jsx)(d._H,{id:"operation.ok"}),cancelText:(0,n.jsx)(d._H,{id:"operation.cancel"}),onConfirm:function(){return xe(r.user_info.id)},children:(0,n.jsx)(fe.Z,{type:"link",children:(0,n.jsx)(d._H,{id:"member.remove"})})})}}].filter(Boolean),xe=function(){var S=(0,O.Z)((0,u.Z)().mark(function r(P){var Y;return(0,u.Z)().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:return x.prev=0,x.next=3,(0,ae.A7)({ws_id:se,user_id:P});case 3:Y=x.sent,Y.code===200?(J.default.success(m({id:"operation.success"})),M()):(0,te.EV)(Y.code,Y.msg),ce(),x.next=12;break;case 8:x.prev=8,x.t0=x.catch(0),console.log(x.t0),J.default.error(m({id:"member.an.error.occurred,please.try.again"}));case 12:case"end":return x.stop()}},r,null,[[0,8]])}));return function(P){return S.apply(this,arguments)}}();return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(Ae.Z,{size:"small",loading:q,rowKey:function(r){return r.user_info.id},rowClassName:function(){return"editable-row"},columns:Oe,dataSource:k.data,pagination:!1}),(0,n.jsx)(ze.Z,{pageSize:de.page_size,total:k.total,currentPage:de.page_num,onPageChange:function(r,P){return Ee({page_num:r,page_size:P})}})]})},Pe=e(66804),Ge=e(75073),ve,Ve,Xe=function(L){var U=(0,d.YB)(),m=U.formatMessage,_=L.match.params.ws_id,re=(0,d.md)(),z=(0,v.useState)("ws_owner"),M=(0,f.Z)(z,2),F=M[0],se=M[1],pe=(0,v.useState)(""),oe=(0,f.Z)(pe,2),ie=oe[0],k=oe[1],R=(0,v.useState)({all_count:0,ws_owner:0,ws_admin:0,ws_test_admin:0,ws_member:0}),le=(0,f.Z)(R,2),g=le[0],q=le[1],he=(0,v.useState)([]),A=(0,f.Z)(he,2),ue=A[0],de=A[1],Ee=(0,v.useState)([]),ce=(0,f.Z)(Ee,2),Oe=ce[0],xe=ce[1],S=(0,v.useState)(!1),r=(0,f.Z)(S,2),P=r[0],Y=r[1],ee=(0,v.useState)(new Date().getTime()),x=(0,f.Z)(ee,2),we=x[0],Qe=x[1],Je=(0,v.useState)(!1),De=(0,f.Z)(Je,2),ke=De[0],Ce=De[1],qe=(0,v.useState)([]),Te=(0,f.Z)(qe,2),en=Te[0],nn=Te[1],an=(0,v.useState)([]),Le=(0,f.Z)(an,2),tn=Le[0],rn=Le[1],sn=H.Z.useForm(),ln=(0,f.Z)(sn,1),Me=ln[0],Re=function(){var a=(0,O.Z)((0,u.Z)().mark(function t(){var l,s,p,i=arguments;return(0,u.Z)().wrap(function(_e){for(;;)switch(_e.prev=_e.next){case 0:return l=i.length>0&&i[0]!==void 0?i[0]:"",_e.next=3,(0,ae.tR)({keyword:l,scope:"aligroup"});case 3:s=_e.sent,p=s.data,ve&&(clearTimeout(ve),ve=null),ve=setTimeout(function(){de(p)},300);case 7:case"end":return _e.stop()}},t)}));return function(){return a.apply(this,arguments)}}(),on=function(){var a=(0,O.Z)((0,u.Z)().mark(function t(){var l,s;return(0,u.Z)().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,(0,Pe.Uy)({role_type:"workspace",ws_id:_,is_filter:"1"});case 2:l=i.sent,s=l.data,s&&rn(s.list);case 5:case"end":return i.stop()}},t)}));return function(){return a.apply(this,arguments)}}();(0,v.useEffect)(function(){on()},[_]);var un=function(){var a=(0,O.Z)((0,u.Z)().mark(function t(){var l,s;return(0,u.Z)().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,(0,Pe.Uy)({role_type:"workspace",ws_id:_});case 2:l=i.sent,s=l.data,s&&nn(s.list);case 5:case"end":return i.stop()}},t)}));return function(){return a.apply(this,arguments)}}();(0,v.useEffect)(function(){return un(),function(){clearTimeout(ve),clearTimeout(Ve)}},[P]);var dn=function(t,l){return t.replace(new RegExp("(".concat(l,")")),'<span style="color:#1890ff">$1</span>')},cn=function(t,l){return t.map(function(s){var p=s.user_info;return{value:p.last_name,label:(0,n.jsx)("div",{style:{display:"flex",justifyContent:"space-between"},children:(0,n.jsx)("div",{dangerouslySetInnerHTML:{__html:dn(p.last_name,l)}})})}})},mn=function(){var a=(0,O.Z)((0,u.Z)().mark(function t(l){var s,p;return(0,u.Z)().wrap(function(j){for(;;)switch(j.prev=j.next){case 0:if(!l){j.next=6;break}return j.next=3,(0,ae.bu)({keyword:l,ws_id:_});case 3:s=j.sent,p=s.data,xe(p?cn(p,l):[]);case 6:case"end":return j.stop()}},t)}));return function(l){return a.apply(this,arguments)}}(),fn=function(t){k(t)},vn=function(){ke||Me.validateFields().then(function(){var t=(0,O.Z)((0,u.Z)().mark(function l(s){var p;return(0,u.Z)().wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return console.log(s),Ce(!0),j.next=4,(0,ae.TP)((0,N.Z)({ws_id:_},s));case 4:p=j.sent,Ce(!1),p.code===200?(J.default.success(m({id:"operation.success"})),Y(!1),Qe(new Date().getTime())):(0,te.EV)(p.code,p.msg);case 7:case"end":return j.stop()}},l)}));return function(l){return t.apply(this,arguments)}}()).catch(function(t){console.log(t),Ce(!1)})},pn=function(){return Y(!1)},hn=function(){var a=(0,O.Z)((0,u.Z)().mark(function t(){return(0,u.Z)().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:Me.resetFields(),Y(!0),Re();case 3:case"end":return s.stop()}},t)}));return function(){return a.apply(this,arguments)}}(),_n=[{name:"".concat(m({id:"member.ws_owner"})," ").concat(g.ws_owner),role:"ws_owner"},{name:"".concat(m({id:"member.ws_admin"})," ").concat(g==null?void 0:g.ws_admin),role:"ws_admin"},{name:"".concat(m({id:"member.ws_test_admin"})," ").concat(g==null?void 0:g.ws_test_admin),role:"ws_test_admin"},{name:"".concat(m({id:"member.ws_member"})," ").concat(g.ws_member),role:"ws_member"}],We=function(){var a=(0,O.Z)((0,u.Z)().mark(function t(){var l,s;return(0,u.Z)().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,(0,ae.X9)({ws_id:_});case 2:l=i.sent,s=l.data,q(s);case 5:case"end":return i.stop()}},t)}));return function(){return a.apply(this,arguments)}}();(0,v.useEffect)(function(){We()},[F,we]);var gn=function(t){k(""),se(t)};return(0,n.jsxs)(b.Z.Content,{children:[(0,n.jsx)(Ge.gM,{title:"".concat(m({id:"all"})," ").concat(g.all_count),extra:(0,n.jsxs)(me.Z,{children:[(0,n.jsx)(Ze.Z,{dropdownMatchSelectWidth:!0,style:{width:200},options:Oe,onSelect:fn,onSearch:mn,children:(0,n.jsx)(ge.Z.Search,{placeholder:m({id:"member.search.users"}),onPressEnter:function(t){return k(t.target.value)}})}),(0,n.jsx)(d.Nv,{accessible:re.WsBtnPermission(),children:(0,n.jsx)(fe.Z,{type:"primary",onClick:hn,children:(0,n.jsx)(d._H,{id:"member.add.member"})})})]}),children:(0,n.jsx)(X.Z,{className:Se().tab_style,onChange:gn,type:"card",children:_n.map(function(a){return(0,n.jsx)(X.Z.TabPane,{tab:a.name,children:F===a.role&&(0,n.jsx)(Ye,(0,N.Z)((0,N.Z)({refresh:we,role:F,keyword:ie},L),{},{roleData:tn,onOk:We}))},a.role)})})}),P&&(0,n.jsx)(w.Z,{title:m({id:"member.add.member"}),open:P,onOk:vn,onCancel:pn,maskClosable:!1,children:(0,n.jsxs)(H.Z,{layout:"vertical",form:Me,children:[(0,n.jsx)(H.Z.Item,{label:(0,n.jsx)(d._H,{id:"member.user"}),name:"emp_id_list",rules:[{required:!0,message:m({id:"member.please.select.user"})}],children:(0,n.jsx)(C.Z,{style:{width:"100%"},optionLabelProp:"label",className:Se().select_baseline,mode:"multiple",defaultActiveFirstOption:!1,filterOption:!1,onSearch:function(t){return Re(t)},children:ue==null?void 0:ue.map(function(a){return(0,n.jsx)(C.Z.Option,{value:a.emp_id,label:a.last_name,children:(0,n.jsxs)(h.Z,{children:[(0,n.jsx)(c.Z,{span:2,children:(0,n.jsx)(V.C,{size:25,src:a.avatar})}),(0,n.jsxs)(c.Z,{span:22,children:[(0,n.jsx)(h.Z,{children:(0,n.jsx)(me.Z,{children:(0,n.jsxs)(E.Z.Text,{children:[a.last_name,"(",a.first_name===""?a.last_name:a.first_name,") - ",a.emp_id]})})}),(0,n.jsx)(h.Z,{children:(0,n.jsx)(E.Z.Text,{children:a.job_desc})}),(0,n.jsx)(h.Z,{children:(0,n.jsx)(E.Z.Text,{children:a.dep_desc})})]})]})},a.emp_id)})})}),(0,n.jsx)(H.Z.Item,{label:(0,n.jsx)(d._H,{id:"member.role"}),name:"role_id",rules:[{required:!0,message:m({id:"member.please.select.role"})}],children:(0,n.jsx)(C.Z,{style:{width:"100%",minHeight:32},placeholder:m({id:"member.please.select.role"}),allowClear:!0,showArrow:!0,children:en.map(function(a){return(0,n.jsx)(C.Z.Option,{value:a.id,children:(0,te.u)(a.name,m)},a.id)})})})]})})]})}},47152:function(G,I,e){"use strict";var Z=e(29700),b=e(42098),y=e(85628),w=e(68591),W=e.n(w),C=e(1155),B=e(12784),h=e(22374),K=e(53532),E=e(33821),$=e(83325),c=E.Z.Option;function D(X){return X&&X.type&&(X.type.isSelectOption||X.type.isSelectOptGroup)}var V=function(Q,me){var je=Q.prefixCls,fe=Q.className,be=Q.popupClassName,Ze=Q.dropdownClassName,ye=Q.children,ge=Q.dataSource,ne=(0,C.Z)(ye),J;if(ne.length===1&&(0,$.l$)(ne[0])&&!D(ne[0])){var N=(0,y.Z)(ne,1);J=N[0]}var u=J?function(){return J}:void 0,O;return ne.length&&D(ne[0])?O=ye:O=ge?ge.map(function(T){if((0,$.l$)(T))return T;switch((0,b.Z)(T)){case"string":return h.createElement(c,{key:T,value:T},T);case"object":{var H=T.value;return h.createElement(c,{key:H,value:H},T.text)}default:return}}):[],h.createElement(K.C,null,function(T){var H=T.getPrefixCls,f=H("select",je);return h.createElement(E.Z,(0,Z.Z)({ref:me},(0,B.Z)(Q,["dataSource"]),{prefixCls:f,popupClassName:be||Ze,className:W()("".concat(f,"-auto-complete"),fe),mode:E.Z.SECRET_COMBOBOX_MODE_DO_NOT_USE},{getInputElement:u}),O)})},o=h.forwardRef(V);o.Option=c,I.Z=o},47721:function(G,I,e){"use strict";var Z=e(49132),b=e.n(Z),y=e(51812),w=e.n(y),W=e(69230)}}]);
