(self.webpackChunktone_front=self.webpackChunktone_front||[]).push([[1047],{59465:function(ie,ue,t){"use strict";t.d(ue,{Z:function(){return _e}});var xe=t(28991),re=t(67294),c={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M696 480H328c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h368c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8z"}},{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}}]},name:"minus-circle",theme:"outlined"},ye=c,U=t(27029),B=function(ve,se){return re.createElement(U.Z,(0,xe.Z)((0,xe.Z)({},ve),{},{ref:se,icon:ye}))},a=re.forwardRef(B),_e=a},12475:function(ie){ie.exports={code_wrapper:"code_wrapper___3eANK"}},54860:function(ie){ie.exports={create_button_wrapper:"create_button_wrapper___GR642",public_ellip:"public_ellip___1oJin",all_script:"all_script___1Y-ZS",text_ellip:"text_ellip___BKN4j",left_title:"left_title___1iIhJ",script_item:"script_item___F73GW",script_item_active:"script_item_active___YrGT0",remove:"remove___29zje",remove_active:"remove_active___3s6vi",filter_icon:"filter_icon___1SwAz",filter_dropdown:"filter_dropdown___yxSQY",filter_search_box:"filter_search_box___3_KsG",filter_dropdown_opt:"filter_dropdown_opt___xq9fi",filter_search_btn:"filter_search_btn___1bjou",right_bottom_options:"right_bottom_options___3ewzm",script_version_modal:"script_version_modal___1Af56",code_view_wrapper:"code_view_wrapper___3MbLG",history_left_item:"history_left_item___1hRc5",history_left_item_active:"history_left_item_active___24dKZ",histroy_active_line:"histroy_active_line___29A3d",histroy_left_time:"histroy_left_time___-7q1G",system_form:"system_form___1P9Hc"}},40893:function(ie){ie.exports={layout:"layout___3rpA5",side:"side___1Eun6",menu:"menu___3HFIQ",menuItem:"menuItem___3mKuU",selected:"selected___1JoUm",tab_style:"tab_style___qheVA"}},13690:function(ie,ue,t){"use strict";var xe=t(23412),re=t.n(xe),c=t(53631),ye=t.n(c),U=t(31149),B=t.n(U),a=t(29656),_e=t(12475),fe=t.n(_e),ve=t(85893);ue.Z=function(se){var be=se.code,pe=se.onChange,Se=se.readOnly,he=Se===void 0?!1:Se,ne=se.mode,ae=ne===void 0?"shell":ne;return(0,ve.jsx)(a.fk,{value:be,className:fe().code_wrapper,options:{theme:"monokai",keyMap:"sublime",lineNumbers:ae==="yaml",mode:ae,readOnly:he},onBeforeChange:function(Ce,Fe,je){return pe(je)}})}},14552:function(ie,ue,t){"use strict";var xe=t(22385),re=t(89456),c=t(11849),ye=t(2824),U=t(93224),B=t(20310),a=t(67294),_e=t(12788),fe=t(60035),ve=t(85893),se=["title","children","width","color","placement","style"],be,pe=_e.ZP.div(be||(be=(0,B.Z)([`
    overflow: hidden;
    white-space: nowrap;
    text-overflow: ellipsis;
`]))),Se=function(ne){var ae=ne.title,Ae=ne.children,Ce=ne.width,Fe=ne.color,je=ne.placement,Ne=je===void 0?"topLeft":je,D=ne.style,Be=(0,U.Z)(ne,se),$=(0,a.useRef)(null),$e=(0,a.useState)(!1),E=(0,ye.Z)($e,2),H=E[0],g=E[1],z=(0,fe.CR)(),We=z.width,ge=function(){var Ee,r,q=$==null||(Ee=$.current)===null||Ee===void 0?void 0:Ee.clientWidth,Ie=$==null||(r=$.current)===null||r===void 0?void 0:r.scrollWidth;g(q<Ie)};(0,a.useEffect)(function(){ge()},[ae,We]);var De=(0,ve.jsx)(pe,(0,c.Z)((0,c.Z)({ref:$,style:(0,c.Z)({width:Ce,color:Fe},D)},Be),{},{children:Ae||ae||"-"}));return H?(0,ve.jsx)(re.Z,{title:ae,placement:Ne,overlayStyle:{wordBreak:"break-all"},children:De}):De};ue.Z=Se},54160:function(ie,ue,t){"use strict";t.r(ue),t.d(ue,{default:function(){return Kt}});var xe=t(18106),re=t(73272),c=t(2824),ye=t(57663),U=t(71577),B=t(20310),a=t(67294),_e=t(20228),fe=t(11382),ve=t(59250),se=t(13013),be=t(30887),pe=t(28682),Se=t(49111),he=t(19650),ne=t(22385),ae=t(89456),Ae=t(62350),Ce=t(24565),Fe=t(48736),je=t(27049),Ne=t(89032),D=t(15746),Be=t(47673),$=t(4107),$e=t(402),E=t(97272),H=t(11849),g=t(39428),z=t(3182),We=t(34792),ge=t(48086),De=t(13062),V=t(71230),Ee=t(54860),r=t.n(Ee),q=t(12788),Ie=t(99069),dt=t(76570),Ke=t(57119),ct=t(59465),ut=t(92977),n=t(16917),Ue=function(){var b=(0,z.Z)((0,g.Z)().mark(function h(u){return(0,g.Z)().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.abrupt("return",(0,n.WY)("/api/sys/config/",{params:u}));case 1:case"end":return s.stop()}},h)}));return function(u){return b.apply(this,arguments)}}(),ze=function(){var b=(0,z.Z)((0,g.Z)().mark(function h(u){return(0,g.Z)().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.abrupt("return",(0,n.WY)("/api/sys/config/",{method:"post",data:u}));case 1:case"end":return s.stop()}},h)}));return function(u){return b.apply(this,arguments)}}(),Re=function(){var b=(0,z.Z)((0,g.Z)().mark(function h(u){return(0,g.Z)().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.abrupt("return",(0,n.WY)("/api/sys/config/",{method:"put",data:u}));case 1:case"end":return s.stop()}},h)}));return function(u){return b.apply(this,arguments)}}(),Ve=function(){var b=(0,z.Z)((0,g.Z)().mark(function h(u){return(0,g.Z)().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.abrupt("return",(0,n.WY)("/api/sys/config/",{method:"delete",data:u}));case 1:case"end":return s.stop()}},h)}));return function(u){return b.apply(this,arguments)}}(),ft=function(){var b=(0,z.Z)((0,g.Z)().mark(function h(u){return(0,g.Z)().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.abrupt("return",(0,n.WY)("/api/sys/config/history/",{params:u}));case 1:case"end":return s.stop()}},h)}));return function(u){return b.apply(this,arguments)}}(),ht=t(14552),Xt=t(57338),Ye=t(440),qt=t(88983),Ze=t(47933),en=t(43358),Ge=t(34041),tn=t(9715),ee=t(20526),Oe=t(24480),e=t(85893),mt=(0,a.forwardRef)(function(b,h){var u,M=(0,n.YB)(),s=M.formatMessage,d=ee.Z.useForm(),j=(0,c.Z)(d,1),S=j[0],W=(0,a.useState)(!1),v=(0,c.Z)(W,2),_=v[0],O=v[1],I=(0,a.useState)(!1),Z=(0,c.Z)(I,2),k=Z[0],w=Z[1],Y=(0,a.useState)("new"),R=(0,c.Z)(Y,2),C=R[0],Q=R[1],J=(0,a.useState)(),f=(0,c.Z)(J,2),l=f[0],A=f[1],F=(0,a.useState)({}),y=(0,c.Z)(F,2),m=y[0],T=y[1];(0,a.useImperativeHandle)(h,function(){return{show:function(){var N=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"new",p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};w(!0),Q(N),T(p),S.setFieldsValue(p)}}});var x=function(){S.resetFields(),O(!1),w(!1),A(void 0)},G=function(N,p){N===200?(b.onOk(),ge.default.success(s({id:"operation.success"})),w(!1),S.resetFields()):N===1362?A(s({id:"basic.config.name.already.exists"})):(0,Oe.EV)(N,p),O(!1)},P=function(){O(!0),S.validateFields().then(function(){var N=(0,z.Z)((0,g.Z)().mark(function p(le){var oe,de,me;return(0,g.Z)().wrap(function(K){for(;;)switch(K.prev=K.next){case 0:if(C!=="new"){K.next=6;break}return K.next=3,ze((0,H.Z)({config_type:"script"},le));case 3:K.t0=K.sent,K.next=7;break;case 6:K.t0=Re((0,H.Z)({config_type:"script",config_id:m.id},le));case 7:oe=K.t0,de=oe.code,me=oe.$msg,G(de,me);case 11:case"end":return K.stop()}},p)}));return function(p){return N.apply(this,arguments)}}()).catch(function(N){O(!1),console.log(N)})};return(0,e.jsx)(Ye.Z,{maskClosable:!1,keyboard:!1,title:(0,e.jsx)(n._H,{id:"basic.addScript.".concat(C)}),width:"380",onClose:x,visible:k,footer:(0,e.jsx)("div",{style:{textAlign:"right"},children:(0,e.jsxs)(he.Z,{children:[(0,e.jsx)(U.Z,{onClick:x,children:(0,e.jsx)(n._H,{id:"operation.cancel"})}),(0,e.jsx)(U.Z,{type:"primary",disabled:_,onClick:P,children:~C.indexOf("edit")?(0,e.jsx)(n._H,{id:"operation.update"}):(0,e.jsx)(n._H,{id:"operation.ok"})})]})}),children:(0,e.jsxs)(ee.Z,{form:S,layout:"vertical",className:r().system_form,children:[(0,e.jsx)(ee.Z.Item,{label:(0,e.jsx)(n._H,{id:"basic.script_name"}),name:"config_key",help:l,rules:[{required:!0,max:32,pattern:/^[A-Za-z0-9\._-]+$/g,message:s({id:"please.enter.message"})}],children:(0,e.jsx)($.Z,{autoComplete:"auto",placeholder:s({id:"basic.please.enter.script_name"})})}),(0,e.jsx)(ee.Z.Item,{label:(0,e.jsx)(n._H,{id:"basic.atomic_step"}),name:"bind_stage",children:(0,e.jsx)(Ge.Z,{children:(u=b.stage)===null||u===void 0?void 0:u.map(function(L){return(0,e.jsx)(Ge.Z.Option,{value:L.value,children:L.name},L.value)})})}),(0,e.jsx)(ee.Z.Item,{label:(0,e.jsx)(n._H,{id:"basic.is_enable"}),name:"enable",initialValue:!0,children:(0,e.jsxs)(Ze.ZP.Group,{children:[(0,e.jsx)(Ze.ZP,{value:!0,children:(0,e.jsx)(n._H,{id:"basic.enable"})}),(0,e.jsx)(Ze.ZP,{value:!1,children:(0,e.jsx)(n._H,{id:"basic.stop"})})]})}),(0,e.jsx)(ee.Z.Item,{label:(0,e.jsx)(n._H,{id:"basic.desc"}),name:"description",children:(0,e.jsx)($.Z.TextArea,{placeholder:s({id:"basic.please.enter.desc"})})})]})})}),vt=t(13690),nn=t(71194),ke=t(50146),an=t(13254),pt=t(14277),gt=t(77869),xt=gt,_t=t(94184),jt=t.n(_t),Zt=(0,a.forwardRef)(function(b,h){var u=b.stage,M=(0,a.useState)(!1),s=(0,c.Z)(M,2),d=s[0],j=s[1],S=(0,a.useState)({}),W=(0,c.Z)(S,2),v=W[0],_=W[1],O=(0,a.useState)(innerHeight*.7),I=(0,c.Z)(O,2),Z=I[0],k=I[1],w=(0,n.QT)(function(m){return ft(m)},{manual:!0,initialData:[]}),Y=w.loading,R=w.run,C=w.data;(0,a.useImperativeHandle)(h,function(){return{show:function(T){j(!0),R({config_key:T.config_key})}}}),(0,a.useEffect)(function(){Object.keys(C).length>0&&_(C[0])},[C]);var Q=function(){return k(innerHeight*.7)};(0,a.useEffect)(function(){return window.addEventListener("resize",Q),function(){window.removeEventListener("resize",Q)}},[]);var J=function(T){return _(T)},f=function(){_({}),j(!1)},l=function(T){var x="";return u.forEach(function(G){var P=G.name,L=G.value;T===L&&(x=P)}),x},A=a.useMemo(function(){return v.config_value?xt.highlightAuto(v.config_value):{}},[v.config_value]),F=A.language,y=A.value;return(0,e.jsx)(ke.Z,{title:(0,e.jsx)(n._H,{id:"basic.historical.version"}),centered:!0,visible:d,onOk:function(){return j(!1)},onCancel:f,width:1e3,className:r().script_version_modal,footer:!1,maskClosable:!1,children:(0,e.jsx)(fe.Z,{spinning:Y,children:(0,e.jsxs)(V.Z,{style:{height:Z},children:[(0,e.jsx)("div",{style:{width:210,borderRight:"1px solid #eee",maxHeight:"100%",overflow:"auto"},children:C==null?void 0:C.map(function(m){return(0,e.jsxs)("div",{className:+v.id==+m.id?r().history_left_item_active:r().history_left_item,onClick:function(){return J(m)},children:[(0,e.jsx)("div",{className:r().histroy_left_time,children:m.source_gmt_created}),(0,e.jsx)("div",{className:r().histroy_left_time,children:m.update_user}),+v.id==+m.id&&(0,e.jsx)("div",{className:r().histroy_active_line})]},m.id)})}),(0,e.jsx)("div",{style:{width:"calc( 100% - 210px )",padding:20},children:C.length===0?(0,e.jsx)(pt.Z,{}):(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(V.Z,{style:{width:"100%",height:50,marginBottom:20},align:"middle",children:(0,e.jsx)(D.Z,{span:24,children:(0,e.jsxs)(V.Z,{children:[(0,e.jsxs)(D.Z,{span:8,className:r().history_top_info,children:[(0,e.jsxs)(E.Z.Text,{className:r().script_right_name,children:[(0,e.jsx)(n._H,{id:"basic.script_name"}),"\uFF1A"]}),(0,e.jsx)(E.Z.Text,{children:(0,e.jsx)(ae.Z,{title:v.config_key,placement:"bottomLeft",children:v.config_key})})]}),(0,e.jsxs)(D.Z,{span:6,className:r().history_top_info,children:[(0,e.jsxs)(E.Z.Text,{className:r().script_right_name,children:[(0,e.jsx)(n._H,{id:"basic.atomic_step"}),"\uFF1A"]}),(0,e.jsx)(E.Z.Text,{children:l(v.bind_stage)})]}),(0,e.jsxs)(D.Z,{span:10,className:r().history_top_info,children:[(0,e.jsxs)(E.Z.Text,{className:r().script_right_name,children:[(0,e.jsx)(n._H,{id:"basic.desc"}),"\uFF1A"]}),(0,e.jsx)(E.Z.Text,{className:r().desc_content_style,children:(0,e.jsx)(ae.Z,{title:v.description,placement:"bottomLeft",children:v.description})})]})]})})}),(0,e.jsx)(V.Z,{style:{height:Z-54.6-70-52,overflow:"hidden"},className:r().code_view_wrapper,children:y&&(0,e.jsx)("pre",{children:(0,e.jsx)("code",{className:jt()("hljs language-".concat(F)),dangerouslySetInnerHTML:{__html:y}})})}),(0,e.jsxs)(V.Z,{style:{height:32,marginTop:20},justify:"space-between",children:[(0,e.jsxs)(E.Z.Text,{children:["Comment\uFF1A",v.commit]}),(0,e.jsx)(U.Z,{onClick:f,children:(0,e.jsx)(n._H,{id:"operation.cancel"})})]})]})})]})})})}),yt=(0,a.forwardRef)(function(b,h){var u=b.onOk,M=(0,n.YB)(),s=M.formatMessage,d={config_type:"script"},j=(0,a.useState)(!1),S=(0,c.Z)(j,2),W=S[0],v=S[1],_=(0,a.useState)(!1),O=(0,c.Z)(_,2),I=O[0],Z=O[1],k=(0,a.useState)(""),w=(0,c.Z)(k,2),Y=w[0],R=w[1],C=(0,a.useState)({}),Q=(0,c.Z)(C,2),J=Q[0],f=Q[1];(0,a.useImperativeHandle)(h,function(){return{show:function(y){v(!0),f(y)}}});var l=function(){v(!1),R(""),f({}),Z(!1)},A=function(){var F=(0,z.Z)((0,g.Z)().mark(function y(){var m,T,x;return(0,g.Z)().wrap(function(P){for(;;)switch(P.prev=P.next){case 0:if(!I){P.next=2;break}return P.abrupt("return");case 2:return Z(!0),P.next=5,Re((0,H.Z)((0,H.Z)({},d),{},{commit:Y,config_value:J.config_value,config_id:J.id}));case 5:m=P.sent,T=m.code,x=m.msg,T===200?(u(),l()):((0,Oe.EV)(T,x),Z(!1));case 9:case"end":return P.stop()}},y)}));return function(){return F.apply(this,arguments)}}();return(0,e.jsx)(ke.Z,{title:"Comment",visible:W,onOk:A,onCancel:l,okText:(0,e.jsx)(n._H,{id:"operation.confirm"}),cancelText:(0,e.jsx)(n._H,{id:"operation.cancel"}),maskClosable:!1,children:(0,e.jsx)($.Z.TextArea,{placeholder:s({id:"basic.please.enter.comment"}),value:Y,rows:4,onChange:function(y){var m=y.target;return R(m.value)}})})}),Qe,Je,Xe,qe,et,tt,bt=q.ZP.div(Qe||(Qe=(0,B.Z)([`
    height: calc(`,`px - 96px - 90px);
    width: 100%;
    overflow: hidden;
    display: flex;
    gap: 20px;
`])),innerHeight),St=q.ZP.div(Je||(Je=(0,B.Z)([`
    position: absolute;
    left: 0;
    top: 48px;
    right: 0;
    bottom: 0;
    z-index: 999;
    display: flex;
    justify-content: center;
    align-items: center;
    background-color: #fff;
`]))),Ct=q.ZP.div(Xe||(Xe=(0,B.Z)([`
    width: 300px;
    border: 1px solid #eee;
    height: 100%;
`]))),Et=q.ZP.div(qe||(qe=(0,B.Z)([`
    width: calc(100% - 320px);
    height: calc(`,`px - 48px - 48px - 40px - 50px);
    display: flex;
    flex-direction: column;
    gap: 16px;
`])),innerHeight),Ot=(0,q.ZP)(V.Z)(et||(et=(0,B.Z)([`
    width: 100%;
    height: 74px;
    padding-top: 8px;
    padding-bottom: 8px;
    padding-right: 15px;
    border-top: 1px solid rgba(0,0,0,.06);
    border-bottom: 1px solid rgba(0,0,0,.06);
    position: relative;
`]))),Ht=q.ZP.div(tt||(tt=(0,B.Z)([`
    width: 100%;
    height: calc(100% - 74px - 52px);
`]))),Tt=function(){var b=(0,n.YB)(),h=b.formatMessage,u={config_type:"script",page_num:1,page_size:500},M=(0,a.useState)({}),s=(0,c.Z)(M,2),d=s[0],j=s[1],S=(0,a.useState)(null),W=(0,c.Z)(S,2),v=W[0],_=W[1],O=(0,a.useState)(!1),I=(0,c.Z)(O,2),Z=I[0],k=I[1],w=(0,a.useState)(""),Y=(0,c.Z)(w,2),R=Y[0],C=Y[1],Q=(0,a.useState)(!1),J=(0,c.Z)(Q,2),f=J[0],l=J[1],A=(0,a.useState)([]),F=(0,c.Z)(A,2),y=F[0],m=F[1],T=(0,a.useRef)(null),x=(0,a.useRef)(null),G=(0,a.useRef)(null),P=(0,n.QT)(function(o){return Ue(o)},{defaultParams:[u],initialData:{data:[],bind_stage:{}},formatResult:function(i){return i}}),L=P.data,N=L.bind_stage,p=L.data,le=P.refresh,oe=P.loading,de=P.run,me=function(i){return j(i)};(0,a.useEffect)(function(){if(p.length>0)if("id"in d){var o=p.findIndex(function(i){var X=i.id;return X===d.id});j(p[o])}else j(p[0]);else j({});JSON.stringify(N)!=="{}"&&m(Object.keys(N).map(function(i){return{name:N[i],value:i}}))},[p]);var Te=function(){var i;(i=x.current)===null||i===void 0||i.show("new")},K=function(i,X){i===200?(j({}),ge.default.success(h({id:"operation.success"})),le()):(0,Oe.EV)(i,X)},rt=function(){var o=(0,z.Z)((0,g.Z)().mark(function i(X){var ce,Pe,ot;return(0,g.Z)().wrap(function(Me){for(;;)switch(Me.prev=Me.next){case 0:return Me.next=2,Ve({config_type:"script",config_id:X.id});case 2:ce=Me.sent,Pe=ce.code,ot=ce.msg,K(Pe,ot);case 6:case"end":return Me.stop()}},i)}));return function(X){return o.apply(this,arguments)}}(),te=function(){var i;(i=x.current)===null||i===void 0||i.show("edit",d)},Ut=function(){G.current.show(d)},zt=function(){var o=(0,z.Z)((0,g.Z)().mark(function i(){return(0,g.Z)().wrap(function(ce){for(;;)switch(ce.prev=ce.next){case 0:de(u).then(function(Pe){Pe.code===200&&j(Pe.data[0])});case 1:case"end":return ce.stop()}},i)}));return function(){return o.apply(this,arguments)}}(),Vt=function(){ge.default.success(h({id:"operation.success"})),le()},Yt=function(){k(!Z)},Gt=function(){de((0,H.Z)((0,H.Z)({},u),{},{config_key:R})),k(!Z)},kt=function(){R&&de(u),C(""),k(!Z)},Qt=function(){T.current.show(d)};(0,a.useEffect)(function(){if("id"in d){var o=p.findIndex(function(i){var X=i.id;return X===d.id});l(p[o].config_value==d.config_value)}},[d]);var Jt=(0,a.useMemo)(function(){var o="";return y.forEach(function(i){var X=i.name,ce=i.value;d.bind_stage===ce&&(o=X)}),o},[y,d]),lt=function(i){return f?!1:(i.preventDefault(),i.returnValue=h({id:"basic.save.warning"}))};(0,a.useEffect)(function(){return window.addEventListener("beforeunload",lt),function(){window.removeEventListener("beforeunload",lt)}},[f]);var we=function(i){return i&&i.indexOf("TONE_")!==0?"TONE_".concat(i):i};return(0,e.jsxs)(bt,{children:[(0,e.jsxs)(Ct,{children:[(0,e.jsx)("div",{className:r().create_button_wrapper,children:(0,e.jsx)(U.Z,{type:"primary",onClick:Te,children:(0,e.jsx)(n._H,{id:"basic.addScript.new"})})}),(0,e.jsxs)(V.Z,{justify:"space-between",className:r().left_title,children:[(0,e.jsxs)(E.Z.Text,{children:[(0,e.jsx)(n._H,{id:"basic.all.script"}),(p==null?void 0:p.length)&&"(".concat(p==null?void 0:p.length,")")]}),(0,e.jsx)("div",{className:r().filter_icon,onClick:Yt,children:(0,e.jsx)(Ie.Z,{style:{color:"rgba(0 , 0 , 0 ,.45)"}})}),(0,e.jsxs)(V.Z,{className:r().filter_dropdown,style:Z?{display:"block"}:{display:"none"},children:[(0,e.jsx)(D.Z,{span:24,className:r().filter_search_box,children:(0,e.jsx)($.Z,{placeholder:h({id:"basic.support.searching.by.script"}),value:R,onChange:function(i){var X=i.target;return C(X.value)},suffix:(0,e.jsx)(dt.Z,{})})}),(0,e.jsx)(je.Z,{style:{margin:0}}),(0,e.jsx)(D.Z,{span:24,children:(0,e.jsxs)(V.Z,{justify:"space-between",children:[(0,e.jsx)(D.Z,{span:12,onClick:Gt,className:"".concat(r().filter_dropdown_opt," ").concat(r().filter_search_btn),children:(0,e.jsx)(n._H,{id:"operation.search"})}),(0,e.jsx)(D.Z,{span:12,onClick:kt,className:r().filter_dropdown_opt,children:(0,e.jsx)(n._H,{id:"operation.reset"})})]})})]})]}),(0,e.jsx)(V.Z,{className:r().all_script,children:p==null?void 0:p.map(function(o){return(0,e.jsx)(D.Z,{span:24,className:+d.id==+o.id?r().script_item_active:r().script_item,onClick:function(){return me(o)},onMouseEnter:function(){return _(o.id)},onMouseLeave:function(){return _(null)},children:(0,e.jsxs)(V.Z,{justify:"space-between",children:[(0,e.jsx)(E.Z.Text,{children:(0,e.jsx)(ht.Z,{width:200,title:we(o.config_key),children:we(o.config_key)})}),(0,e.jsx)(Ce.Z,{title:(0,e.jsx)("div",{style:{color:"red",width:"280px"},children:(0,e.jsx)(n._H,{id:"basic.delete.the.script.warning"})}),onCancel:function(){return rt(o)},okText:(0,e.jsx)(n._H,{id:"operation.cancel"}),cancelText:(0,e.jsx)(n._H,{id:"operation.confirm.delete"}),icon:(0,e.jsx)(Ke.Z,{style:{color:"red"}}),children:(0,e.jsx)(ct.Z,{className:v===o.id?r().remove_active:r().remove})})]})},o.id)})})]}),(0,e.jsxs)(Et,{children:[(0,e.jsxs)(Ot,{children:[(0,e.jsx)(D.Z,{span:24,children:(0,e.jsxs)(V.Z,{children:[(0,e.jsxs)(D.Z,{span:8,className:r().history_top_info,children:[(0,e.jsxs)("span",{className:r().script_right_name,children:[(0,e.jsx)(n._H,{id:"basic.script_name"}),"\uFF1A"]}),(0,e.jsx)(E.Z.Text,{children:(0,e.jsx)(ae.Z,{title:we(d.config_key),placement:"bottomLeft",children:we(d.config_key)})})]}),(0,e.jsxs)(D.Z,{span:6,className:r().history_top_info,children:[(0,e.jsxs)("span",{className:r().script_right_name,children:[(0,e.jsx)(n._H,{id:"basic.atomic_step"}),"\uFF1A"]}),(0,e.jsx)(E.Z.Text,{children:Jt||"-"})]}),(0,e.jsxs)(D.Z,{span:10,className:r().history_top_info,children:[(0,e.jsxs)("span",{className:r().script_right_name,children:[(0,e.jsx)(n._H,{id:"basic.desc"}),"\uFF1A"]}),(0,e.jsx)(E.Z.Text,{className:r().desc_content_style,children:(0,e.jsx)(ae.Z,{title:d.description,placement:"bottomLeft",children:d.description})})]})]})}),(0,e.jsx)(D.Z,{span:24,children:(0,e.jsxs)(he.Z,{children:[(0,e.jsxs)(E.Z.Text,{className:r().script_right_name,children:[(0,e.jsx)(n._H,{id:"basic.is_enable"}),"\uFF1A"]}),(0,e.jsx)(E.Z.Text,{children:d.enable?(0,e.jsx)("span",{style:{color:"#10CF2D"},children:(0,e.jsx)(n._H,{id:"basic.enable"})}):(0,e.jsx)("span",{style:{color:"#F5222D"},children:(0,e.jsx)(n._H,{id:"basic.stop"})})})]})}),(0,e.jsx)(se.Z,{overlayStyle:{cursor:"pointer"},overlay:(0,e.jsxs)(pe.Z,{children:[(0,e.jsx)(pe.Z.Item,{onClick:te,children:(0,e.jsx)(n._H,{id:"basic.edit.information"})}),(0,e.jsx)(pe.Z.Item,{onClick:Qt,children:(0,e.jsx)(n._H,{id:"basic.historical.version"})})]}),children:(0,e.jsx)(ut.Z,{style:{cursor:"pointer",position:"absolute",right:0,top:5}})})]}),(0,e.jsx)(Ht,{children:(0,e.jsx)(vt.Z,{code:d.config_value,onChange:function(i){return j((0,H.Z)((0,H.Z)({},d),{},{config_value:i}))}})}),(0,e.jsx)(V.Z,{className:r().right_bottom_options,children:(0,e.jsxs)(he.Z,{children:[(0,e.jsx)(U.Z,{style:{width:80,marginRight:20},onClick:Ut,disabled:f,type:"primary",children:(0,e.jsx)(n._H,{id:"basic.submit"})}),(0,e.jsxs)(E.Z.Text,{style:{fontSize:12,color:"rgba( 0 , 0 , 0 , .65 )",marginRight:20},children:[(0,e.jsx)(n._H,{id:"basic.last.modified.time"}),"\uFF1A",d.gmt_modified]}),(0,e.jsxs)(E.Z.Text,{style:{fontSize:12,color:"rgba( 0 , 0 , 0 , .65 )",marginRight:20},children:[(0,e.jsx)(n._H,{id:"basic.last.modified.person"}),"\uFF1A",d.update_user]}),d.commit&&(0,e.jsxs)(E.Z.Text,{style:{fontSize:12,color:"rgba( 0 , 0 , 0 , .65 )"},children:["Comment\uFF1A",d.commit]})]})})]}),oe&&(0,e.jsx)(St,{children:(0,e.jsx)(fe.Z,{spinning:oe})}),(0,e.jsx)(mt,{stage:y,ref:x,onOk:zt}),(0,e.jsx)(Zt,{stage:y,ref:T}),(0,e.jsx)(yt,{ref:G,onOk:Vt})]})},sn=t(24793),Pt=t(97183),rn=t(66456),Mt=t(79764),ln=t(54029),wt=t(79166),He=t(78037),At=t(86213),Ft=(0,a.forwardRef)(function(b,h){var u=b.onOk,M=(0,n.YB)(),s=M.formatMessage,d=ee.Z.useForm(),j=(0,c.Z)(d,1),S=j[0],W=(0,a.useState)(!1),v=(0,c.Z)(W,2),_=v[0],O=v[1],I=(0,a.useState)(!1),Z=(0,c.Z)(I,2),k=Z[0],w=Z[1],Y=(0,a.useState)("new"),R=(0,c.Z)(Y,2),C=R[0],Q=R[1],J=(0,a.useState)({}),f=(0,c.Z)(J,2),l=f[0],A=f[1];(0,a.useImperativeHandle)(h,function(){return{show:function(){var x=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"new",G=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};A(G),S.setFieldsValue(G),Q(x),O(!0)}}});var F=function(){O(!1),S.resetFields()},y=function(x,G){x===200?(ge.default.success(s({id:"operation.success"})),S.resetFields(),O(!1),u()):(0,Oe.EV)(x,G)},m=function(){var T=(0,z.Z)((0,g.Z)().mark(function x(){return(0,g.Z)().wrap(function(P){for(;;)switch(P.prev=P.next){case 0:w(!0),S.validateFields().then(function(){var L=(0,z.Z)((0,g.Z)().mark(function N(p){var le,oe,de,me,Te,K;return(0,g.Z)().wrap(function(te){for(;;)switch(te.prev=te.next){case 0:if(C!=="new"){te.next=9;break}return te.next=3,ze((0,H.Z)({config_type:"sys"},p));case 3:le=te.sent,oe=le.code,de=le.msg,y(oe,de),te.next=16;break;case 9:if(C!=="edit"){te.next=16;break}return te.next=12,Re((0,H.Z)({config_type:"sys",config_id:l.id},p));case 12:me=te.sent,Te=me.code,K=me.msg,y(Te,K);case 16:w(!1);case 17:case"end":return te.stop()}},N)}));return function(N){return L.apply(this,arguments)}}()).catch(function(L){console.log(L),w(!1)});case 2:case"end":return P.stop()}},x)}));return function(){return T.apply(this,arguments)}}();return(0,e.jsx)(Ye.Z,{maskClosable:!1,keyboard:!1,open:_,width:"376",title:(0,e.jsx)(n._H,{id:"basic.addConfig.".concat(C)}),onClose:F,footer:(0,e.jsx)("div",{style:{textAlign:"right"},children:(0,e.jsxs)(he.Z,{children:[(0,e.jsx)(U.Z,{onClick:F,children:(0,e.jsx)(n._H,{id:"operation.cancel"})}),(0,e.jsx)(U.Z,{type:"primary",disabled:k,onClick:m,children:C==="edit"?(0,e.jsx)(n._H,{id:"operation.update"}):(0,e.jsx)(n._H,{id:"operation.ok"})})]})}),children:(0,e.jsxs)(ee.Z,{layout:"vertical",form:S,initialValues:{enable:!0},children:[(0,e.jsx)(ee.Z.Item,{label:(0,e.jsx)(n._H,{id:"basic.config_key"}),name:"config_key",rules:[{required:!0,min:1,max:32,pattern:/^[A-Za-z0-9\._-]+$/g,message:s({id:"please.enter.message"})}],children:(0,e.jsx)($.Z,{autoComplete:"off",placeholder:s({id:"basic.please.enter.config_key"})})}),(0,e.jsx)(ee.Z.Item,{label:(0,e.jsx)(n._H,{id:"basic.is_enable"}),name:"enable",children:(0,e.jsxs)(Ze.ZP.Group,{children:[(0,e.jsx)(Ze.ZP,{value:!0,children:(0,e.jsx)(n._H,{id:"basic.enable"})}),(0,e.jsx)(Ze.ZP,{value:!1,children:(0,e.jsx)(n._H,{id:"basic.stop"})})]})}),(0,e.jsx)(ee.Z.Item,{label:(0,e.jsx)(n._H,{id:"basic.config_value"}),name:"config_value",children:(0,e.jsx)($.Z.TextArea,{style:{height:400},placeholder:s({id:"basic.please.enter.config_value"})})}),(0,e.jsx)(ee.Z.Item,{label:(0,e.jsx)(n._H,{id:"basic.desc"}),name:"description",children:(0,e.jsx)($.Z.TextArea,{style:{height:110},placeholder:s({id:"basic.please.enter.desc"})})})]})})}),Le=t(10753),Dt=function(h,u){var M=(0,n.YB)(),s=M.formatMessage,d=(0,n.Kd)()==="en-US",j=(0,a.useRef)();(0,a.useImperativeHandle)(u,function(){return{openSetting:function(){return j.current.show()}}});var S={config_type:"sys",page_size:10,page_num:1},W=(0,a.useState)(S),v=(0,c.Z)(W,2),_=v[0],O=v[1],I=(0,n.QT)(function(f){return Ue(f)},{formatResult:function(l){return l},initialData:{data:[],total:0},defaultParams:[S]}),Z=I.data,k=I.loading,w=I.refresh,Y=I.run;(0,a.useEffect)(function(){Y(_)},[_]);var R=function(l){j.current.show("edit",l)},C=function(){var f=(0,z.Z)((0,g.Z)().mark(function l(A){var F,y,m;return(0,g.Z)().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:return x.next=2,Ve({config_id:A.id});case 2:F=x.sent,y=F.code,m=F.msg,y===200?(w(),ge.default.success(s({id:"operation.success"}))):(0,Oe.EV)(y,m);case 6:case"end":return x.stop()}},l)}));return function(A){return f.apply(this,arguments)}}(),Q=[(0,H.Z)({dataIndex:"config_key",title:(0,e.jsx)(n._H,{id:"basic.config_key"}),ellipsis:{showTitle:!1},render:function(l){return(0,e.jsx)(Le.K,{ellipsis:{tooltip:!0},placement:"topLeft",title:l,children:l})}},(0,He.QT)(_,O,"config_key")),(0,H.Z)({dataIndex:"config_value",title:(0,e.jsx)(n._H,{id:"basic.config_value"}),width:160,ellipsis:{showTitle:!1},render:function(l){return(0,e.jsx)(Le.K,{ellipsis:{tooltip:!0},placement:"topLeft",title:l,children:l})}},(0,He.QT)(_,O,"config_value")),(0,H.Z)({dataIndex:"enable",title:(0,e.jsx)(n._H,{id:"basic.is_enable"}),width:100,render:function(l){return(0,e.jsx)(wt.Z,{status:l?"success":"error",text:(0,e.jsx)(E.Z.Text,{children:l?(0,e.jsx)(n._H,{id:"basic.enable"}):(0,e.jsx)(n._H,{id:"basic.stop"})})})}},(0,He.KW)(_,O,[{name:(0,e.jsx)(n._H,{id:"basic.enable"}),value:1},{name:(0,e.jsx)(n._H,{id:"basic.stop"}),value:0}],"enable")),{dataIndex:"gmt_created",title:(0,e.jsx)(n._H,{id:"basic.gmt_created"}),width:175},{dataIndex:"gmt_modified",title:(0,e.jsx)(n._H,{id:"basic.gmt_modified"}),width:175},(0,H.Z)((0,H.Z)({dataIndex:"creator_name",title:(0,e.jsx)(n._H,{id:"basic.creator"})},(0,He.ln)(_,O,"creator")),{},{render:function(l){return(0,e.jsx)(e.Fragment,{children:l||"-"})}}),(0,H.Z)((0,H.Z)({dataIndex:"update_user",title:(0,e.jsx)(n._H,{id:"basic.update_user"})},(0,He.ln)(_,O,"update_user")),{},{render:function(l){return(0,e.jsx)(e.Fragment,{children:l||"-"})}}),{dataIndex:"description",title:(0,e.jsx)(n._H,{id:"basic.desc"}),ellipsis:{showTitle:!1},render:function(l){return(0,e.jsx)(Le.K,{ellipsis:{tooltip:!0},placement:"topLeft",title:l,children:l||"-"})}},{title:(0,e.jsx)(n._H,{id:"Table.columns.operation"}),width:100,fixed:"right",render:function(l){return(0,e.jsxs)(he.Z,{children:[(0,e.jsx)("span",{onClick:function(){return R(l)},style:{color:"#1890FF",cursor:"pointer"},children:(0,e.jsx)(n._H,{id:"operation.edit"})}),(0,e.jsx)(Ce.Z,{title:(0,e.jsx)("div",{style:{color:"red"},children:(0,e.jsx)(n._H,{id:"basic.delete.popconfirm.title"})}),onCancel:function(){return C(l)},okText:(0,e.jsx)(n._H,{id:"operation.cancel"}),cancelText:(0,e.jsx)(n._H,{id:"operation.confirm.delete"}),icon:(0,e.jsx)(Ke.Z,{style:{color:"red"}}),children:(0,e.jsx)(E.Z.Text,{style:{color:"#1890FF",cursor:"pointer"},children:(0,e.jsx)(n._H,{id:"operation.delete"})})})]})}}],J=function(){return w()};return(0,e.jsxs)(Pt.Z.Content,{children:[(0,e.jsxs)(fe.Z,{spinning:k,children:[(0,e.jsx)(Mt.Z,{rowKey:"id",dataSource:Z==null?void 0:Z.data,columns:Q,pagination:!1,size:"small",scroll:d?{x:1200}:void 0}),(0,e.jsx)(At.Z,{pageSize:_.page_size,currentPage:_.page_num,total:(Z==null?void 0:Z.total)||0,onPageChange:function(l){var A=arguments.length>1&&arguments[1]!==void 0?arguments[1]:_.page_num;O((0,H.Z)((0,H.Z)({},_),{},{page_size:A,page_num:l})),Y(_)}})]}),(0,e.jsx)(Ft,{ref:j,onOk:J})]})},It=(0,a.forwardRef)(Dt),Rt=t(40893),Lt=t.n(Rt),nt,at,st,it,Nt=q.ZP.div(nt||(nt=(0,B.Z)([`
    width: 100%;
    height: 100%;
    overflow: hidden;
    position: relative;
`]))),Bt=q.ZP.div(at||(at=(0,B.Z)([`
    width: 100%;
    height: 48px;
    display: flex;
    justify-content: space-between;
    border: 1px solid #f0f0f0;
    padding: 0 24px;
    margin-bottom: -1px;
`]))),$t=(0,q.ZP)(U.Z)(st||(st=(0,B.Z)([`
    margin-top: 8px;
`]))),Wt=q.ZP.div(it||(it=(0,B.Z)([`
    width: 100%;
    height: calc(100% - 48px - 16px);
    padding: 24px;
`]))),Kt=function(b){var h=b.location,u=(0,a.useState)(h.query.t||"script"),M=(0,c.Z)(u,2),s=M[0],d=M[1],j=(0,a.useRef)(),S=function(v){d(v)};return(0,e.jsxs)(Nt,{children:[(0,e.jsxs)(Bt,{children:[(0,e.jsxs)(re.Z,{defaultActiveKey:"script",onTabClick:S,className:Lt().tab_style,children:[(0,e.jsx)(re.Z.TabPane,{tab:(0,e.jsx)(n._H,{id:"basic.script"})},"script"),(0,e.jsx)(re.Z.TabPane,{tab:(0,e.jsx)(n._H,{id:"basic.sys"})},"sys")]}),s==="sys"&&(0,e.jsx)($t,{type:"primary",onClick:function(){return j.current.openSetting()},children:(0,e.jsx)(n._H,{id:"basic.new.config"})})]}),(0,e.jsx)(Wt,{children:s==="sys"?(0,e.jsx)(It,{ref:j}):(0,e.jsx)(Tt,{})})]})}}}]);
