(self.webpackChunktone_front=self.webpackChunktone_front||[]).push([[3044],{99491:function(V){V.exports={create_layout:"create_layout___3WAVM",systerm_init:"systerm_init___1UTPY",create_main:"create_main___1hAqa",title:"title___3apRx",red:"red___3VnqD",mb_8:"mb_8___2bk5m",mb_16:"mb_16___2LzdW",ml_97:"ml_97___1oAnL",mb_55:"mb_55___2OoKp",form_layout:"form_layout___2QDDM",full_width:"full_width___330c9",line:"line___3GlT2",create_banner:"create_banner___3yyFE",rigth_content:"rigth_content___1QKa8",issue_title:"issue_title___1i0g3",performance_ul:"performance_ul___3n1iZ",performace_more:"performace_more___1K_IM",close_btn:"close_btn___4_Wkf",upload_style:"upload_style___2LEu-",question_icon:"question_icon___11JAi",question_tip_wrapper:"question_tip_wrapper___3_aWX",question_tip_layout:"question_tip_layout___3RkKh",w_384:"w_384___cP7u3",init_box:"init_box___1IwnL",init_container:"init_container___3RZrR",init_text:"init_text___3MYIA",icon_gif:"icon_gif___dttQN",init_sucess_text:"init_sucess_text___1ttsu",init_sucess_opreate:"init_sucess_opreate___3hChT",icon:"icon___qfcqn",desc:"desc___3or4A",last_line:"last_line___19fIw",create_doc:"create_doc___2WcXq",button:"button___3C83h",init_success_box:"init_success_box___3Q6Vb",init_sucess_box:"init_sucess_box___3MYty"}},49229:function(V,U,s){"use strict";var Pe=s(71194),Q=s(50146),Me=s(13062),W=s(71230),z=s(39428),Y=s(3182),G=s(2824),C=s(20310),Z=s(67294),y=s(55761),re=s(16917),K=s(12788),b=s(85893),S,H,m=K.ZP.div(S||(S=(0,C.Z)([`
    width: calc(100% - 200px - 20px);
    height: 100px;
    overflow: hidden;
    margin-left: 20px;
`]))),oe=(0,K.ZP)(y.Z)(H||(H=(0,C.Z)([`
    & {
        height: 200px;
        width: 200px;  
    }
`]))),J=function(j,le){var u=j.onCancel,ie=j.onOk,E=Z.useState(""),X=(0,G.Z)(E,2),h=X[0],q=X[1],O=Z.useState(!1),P=(0,G.Z)(O,2),p=P[0],t=P[1];Z.useImperativeHandle(le,function(){return{show:function(A){t(!0),q(A)}}});var N=(0,Z.useRef)(null),k=function(){t(!1),q(""),u&&u()},ee=function(){N.current.getCroppedCanvas().toBlob(function(){var A=(0,Y.Z)((0,z.Z)().mark(function F(se){var L,g;return(0,z.Z)().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:return L=new FormData,L.append("file",se),x.next=4,(0,re.WY)("/api/sys/upload/",{method:"post",data:L});case 4:g=x.sent,ie(g),k();case 7:case"end":return x.stop()}},F)}));return function(F){return A.apply(this,arguments)}}())};return(0,b.jsx)(Q.Z,{open:p,onCancel:k,onOk:ee,title:"\u56FE\u7247\u88C1\u5207",maskClosable:!1,children:(0,b.jsxs)(W.Z,{children:[(0,b.jsx)(oe,{ref:N,src:h,aspectRatio:1,guides:!0,preview:".preview"}),(0,b.jsx)(m,{className:"preview"})]})})};U.Z=(0,Z.forwardRef)(J)},92868:function(V,U,s){"use strict";s.r(U);var Pe=s(24793),Q=s(97183),Me=s(57663),W=s(71577),z=s(43185),Y=s(78661),G=s(88983),C=s(47933),Z=s(47673),y=s(4107),re=s(49111),K=s(19650),b=s(74379),S=s(38648),H=s(32059),m=s(39428),oe=s(34792),J=s(48086),I=s(3182),j=s(11849),le=s(9715),u=s(20526),ie=s(13062),E=s(71230),X=s(89032),h=s(15746),q=s(402),O=s(97272),P=s(2824),p=s(67294),t=s(16917),N=s(94184),k=s.n(N),ee=s(99491),r=s.n(ee),A=s(1870),F=s(49101),se=s(54549),L=s(38819),g=s(90105),ce=s(49229),x=s(96486),M=s.n(x),Oe=s(24480),e=s(85893),de=function(f){var _e=(0,p.useState)(!1),B=(0,P.Z)(_e,2),D=B[0],R=B[1];return(0,e.jsx)(E.Z,{children:(0,e.jsxs)(h.Z,{span:24,children:[(0,e.jsx)(O.Z.Text,{children:f.name}),(0,e.jsxs)("span",{className:r().question_tip_layout,onMouseEnter:function(){return R(!0)},onMouseLeave:function(){return R(!1)},children:[(0,e.jsx)(A.Z,{className:r().question_icon}),(0,e.jsx)("div",{style:{display:D?"block":"none"},className:k()(r().question_tip_wrapper,r().w_384),children:(0,e.jsx)("p",{children:f.tip})})]})]})})};U.default=function(){var ue=(0,t.YB)(),f=ue.formatMessage,_e=(0,p.useState)({path:"",link:""}),B=(0,P.Z)(_e,2),D=B[0],R=B[1],te=(0,t.md)(),xe=(0,p.useState)(!1),me=(0,P.Z)(xe,2),ae=me[0],pe=me[1],De=u.Z.useForm(),Ce=(0,P.Z)(De,1),ne=Ce[0],Ze=(0,p.useState)(!1),fe=(0,P.Z)(Ze,2),ye=fe[0],T=fe[1],Ie=(0,p.useState)(innerHeight),Ee=(0,P.Z)(Ie,2),ge=Ee[0],Re=Ee[1],$=(0,p.useRef)(null),he=p.useRef();(0,p.useEffect)(function(){var _=window.sessionStorage.getItem("create_ws_info");_&&(window.sessionStorage.removeItem("create_ws_info"),_=JSON.parse(_),ne.setFieldsValue({show_name:M().get(_,"ws_info.show_name")&&M().get(_,"ws_info.show_name").split("[")[0],name:M().get(_,"ws_info.name")&&M().get(_,"ws_info.name").split("[")[0],description:M().get(_,"ws_info.description"),reason:M().get(_,"reason"),is_public:M().get(_,"ws_info.is_public"),logo:M().get(_,"ws_info.logo")}),R((0,j.Z)((0,j.Z)({},D),{},{link:M().get(_,"ws_info.logo")})))},[]);var Te=function(a){var o=new FileReader;return o.onload=function(i){var l;(l=he.current)===null||l===void 0||l.show(i.target.result)},o.readAsDataURL(a),!1},we=function(){var _=(0,I.Z)((0,m.Z)().mark(function a(o){var i,l,v,n;return(0,m.Z)().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,(0,g.MB)(o);case 2:i=c.sent,l=i.data,v=i.code,n=i.msg,v===200?(clearInterval($.current),t.m8.push("/ws/".concat(l.id,"/workspace/initSuccess"))):J.default.error(n||f({id:"workspace.submit.failed"}),2,function(){clearInterval($.current),pe(!1)});case 7:case"end":return c.stop()}},a)}));return function(o){return _.apply(this,arguments)}}();(0,p.useEffect)(function(){var _=document.querySelector("#createWs #rigthContent");_&&Re(_.offsetHeight+26)},[]);var ve=function(){var a=document.querySelectorAll("#createWs .dot");if(a)return Array.from(a).forEach(function(o){o.style.opacity=0}),a};(0,p.useEffect)(function(){if(ae){var _=ve();if(_&&_.length){_[0].style.opacity=1;var a=0;$.current=setInterval(function(){a=a+1<3?a+1:0,a===0&&ve(),_[a].style.opacity=1},500)}}return function(){clearInterval($.current)}},[ae]);var je=function(){var _=(0,I.Z)((0,m.Z)().mark(function a(o,i){var l,v,n;return(0,m.Z)().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,(0,g.Ex)((0,H.Z)({},o,i));case 2:if(l=c.sent,v=l.code,n=l.msg,v===200){c.next=8;break}return ne.setFields([{name:o,errors:[n]}]),c.abrupt("return");case 8:return c.abrupt("return",!0);case 9:case"end":return c.stop()}},a)}));return function(o,i){return _.apply(this,arguments)}}();return(0,e.jsxs)(Q.Z.Content,{className:r().create_layout,id:"createWs",children:[(0,e.jsxs)(E.Z,{className:r().create_main,gutter:8,justify:"space-between",children:[(0,e.jsx)(h.Z,{span:10,className:r().mb_55,style:{marginTop:20},children:(0,e.jsx)(h.Z,{span:18,offset:6,children:(0,e.jsxs)(u.Z,{form:ne,layout:"vertical",className:r().full_width,initialValues:{is_public:!1},onFinish:function(){var _=(0,I.Z)((0,m.Z)().mark(function a(o){var i,l,v,n,w;return(0,m.Z)().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return T(!0),i=o.show_name,l=o.name,d.next=4,je("show_name",i);case 4:if(v=d.sent,v){d.next=7;break}return d.abrupt("return",T(!1));case 7:return d.next=9,je("name",l);case 9:if(n=d.sent,n){d.next=12;break}return d.abrupt("return",T(!1));case 12:if(!te.IsAdmin()){d.next=18;break}pe(!0),we((0,j.Z)((0,j.Z)({},o),{},{logo:D.path})),T(!1),d.next=22;break;case 18:return d.next=20,(0,g.MB)((0,j.Z)((0,j.Z)({},o),{},{logo:D.path}));case 20:w=d.sent,w.code===200?(S.default.open({message:(0,e.jsx)(t._H,{id:"workspace.submit.success"}),description:(0,e.jsxs)("span",{children:[(0,e.jsx)(t._H,{id:"workspace.submit.desc1"}),(0,e.jsx)("span",{style:{color:"#1890FF",cursor:"pointer"},onClick:function(){return t.m8.push("/personCenter?person=approve")},children:(0,e.jsx)(t._H,{id:"workspace.submit.desc2"})})]}),icon:(0,e.jsx)(L.Z,{style:{color:"#52c41a"}}),duration:3}),T(!1),t.m8.go(-1)):((0,Oe.EV)(w.code,w.msg),T(!1));case 22:case"end":return d.stop()}},a)}));return function(a){return _.apply(this,arguments)}}(),children:[(0,e.jsx)(u.Z.Item,{label:" ",children:(0,e.jsx)(K.Z,{children:(0,e.jsx)(O.Z.Title,{level:3,children:(0,e.jsx)(t._H,{id:"workspace.ws.create"})})})}),(0,e.jsx)(u.Z.Item,{rules:[{required:!0,validator:function(){var _=(0,I.Z)((0,m.Z)().mark(function o(i,l){return(0,m.Z)().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(l){n.next=2;break}return n.abrupt("return",Promise.reject(f({id:"workspace.show_name.rules1"})));case 2:if(/^[A-Za-z0-9\u4e00-\u9fa5\._-]{1,30}$/.test(l)){n.next=4;break}return n.abrupt("return",Promise.reject(f({id:"workspace.show_name.rules2"})));case 4:return n.abrupt("return",Promise.resolve());case 5:case"end":return n.stop()}},o)}));function a(o,i){return _.apply(this,arguments)}return a}()}],label:(0,e.jsx)(t._H,{id:"workspace.show_name.s"}),name:"show_name",children:(0,e.jsx)(y.Z,{autoComplete:"off",placeholder:f({id:"workspace.show_name.placeholder"}),allowClear:!0})}),(0,e.jsx)(u.Z.Item,{rules:[{required:!0,validator:function(){var _=(0,I.Z)((0,m.Z)().mark(function o(i,l){return(0,m.Z)().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(l){n.next=2;break}return n.abrupt("return",Promise.reject(f({id:"workspace.ws.name.rules1"})));case 2:if(/^[a-z0-9_-]{0,30}$/.test(l)){n.next=4;break}return n.abrupt("return",Promise.reject(f({id:"workspace.ws.name.rules2"})));case 4:return n.abrupt("return",Promise.resolve());case 5:case"end":return n.stop()}},o)}));function a(o,i){return _.apply(this,arguments)}return a}()}],label:(0,e.jsx)(de,{name:(0,e.jsx)(t._H,{id:"workspace.ws.name"}),tip:(0,e.jsx)(t._H,{id:"workspace.ws.tip"}),path:""}),name:"name",children:(0,e.jsx)(y.Z,{autoComplete:"off",placeholder:f({id:"workspace.ws.name.placeholder"}),allowClear:!0})}),(0,e.jsx)(u.Z.Item,{rules:[{required:!0,max:200}],label:(0,e.jsx)(t._H,{id:"workspace.description"}),name:"description",children:(0,e.jsx)(y.Z.TextArea,{rows:3,allowClear:!0,placeholder:f({id:"workspace.description.placeholder"})})}),(0,e.jsx)(u.Z.Item,{rules:[{required:!0,max:200}],label:(0,e.jsx)(t._H,{id:"workspace.reason"}),name:"reason",children:(0,e.jsx)(y.Z.TextArea,{allowClear:!0,rows:4,placeholder:f({id:"workspace.reason.placeholder"})})}),(0,e.jsx)(u.Z.Item,{rules:[{required:!0}],name:"is_public",label:(0,e.jsx)(de,{name:(0,e.jsx)(t._H,{id:"workspace.is_public"}),tip:(0,e.jsx)(t._H,{id:"workspace.is_public.tip"}),path:""}),children:(0,e.jsxs)(C.ZP.Group,{children:[(0,e.jsx)(C.ZP,{value:!1,className:r().mb_16,children:(0,e.jsx)("span",{children:(0,e.jsx)(t._H,{id:"workspace.private.ps"})})}),(0,e.jsx)("br",{}),(0,e.jsx)(C.ZP,{value:!0,children:(0,e.jsx)("span",{children:(0,e.jsx)(t._H,{id:"workspace.public.ps"})})})]})}),(0,e.jsx)(u.Z.Item,{label:(0,e.jsx)(t._H,{id:"workspace.project.cover"}),children:(0,e.jsx)(u.Z.Item,{name:"logo",noStyle:!0,children:(0,e.jsxs)("div",{style:{display:"flex",justifyContent:"flex-start",alignItems:"center"},children:[(0,e.jsx)("div",{style:{marginRight:16},children:(0,e.jsx)(Y.Z,{name:"file",listType:"picture-card",className:"avatar-uploader",showUploadList:!1,action:"/api/sys/upload/",beforeUpload:Te,onChange:function(a){a.file.status==="done"&&R(a)},children:D.link?(0,e.jsx)("img",{src:D.link,alt:"avatar",style:{width:"100%"}}):(0,e.jsx)(F.Z,{})})}),(0,e.jsx)("div",{style:{display:"flex",alignItems:"center"},children:(0,e.jsxs)(E.Z,{children:[(0,e.jsx)(h.Z,{span:24,children:(0,e.jsx)(t._H,{id:"workspace.cover.drag"})}),(0,e.jsx)(h.Z,{span:24,children:(0,e.jsx)(t._H,{id:"workspace.cover.size"})})]})})]})})}),(0,e.jsx)(u.Z.Item,{style:{marginTop:30},children:(0,e.jsx)(W.Z,{type:"primary",disabled:ye,htmlType:"submit",children:(0,e.jsx)(t._H,{id:"workspace.submit.review"})})})]})})}),(0,e.jsx)(h.Z,{span:14,className:r().rigth_content,id:"rigthContent",children:(0,e.jsxs)(E.Z,{children:[(0,e.jsx)(h.Z,{offset:3,span:3,style:{borderLeft:"1px solid rgba(0,0,0,.06)"}}),(0,e.jsxs)(h.Z,{span:12,children:[(0,e.jsx)(E.Z,{className:r().create_banner}),(0,e.jsx)(E.Z,{className:r().issue_title,children:(0,e.jsx)(t._H,{id:"workspace.ws.about"})}),(0,e.jsx)(E.Z,{children:(0,e.jsxs)("ul",{className:r().performance_ul,children:[(0,e.jsx)("li",{children:(0,e.jsx)(O.Z.Text,{type:"secondary",children:(0,e.jsx)(t._H,{id:"workspace.li1"})})}),(0,e.jsx)("li",{children:(0,e.jsx)(O.Z.Text,{type:"secondary",children:(0,e.jsx)(t._H,{id:"workspace.li2"})})}),(0,e.jsx)("li",{children:(0,e.jsx)(O.Z.Text,{type:"secondary",children:(0,e.jsx)(t._H,{id:"workspace.li3"})})})]})}),(0,e.jsx)(E.Z,{children:(0,e.jsx)(W.Z,{type:"link",onClick:function(){return t.m8.push("/help_doc")},children:(0,e.jsx)(t._H,{id:"workspace.see.more"})})})]})]})}),(0,e.jsxs)(W.Z,{className:r().close_btn,onClick:function(){return t.m8.go(-1)},children:[(0,e.jsx)(se.Z,{}),(0,e.jsx)(t._H,{id:"operation.close"})]}),(0,e.jsx)(ce.Z,{ref:he,onOk:function(a){a&&R(a)}})]}),ae&&(0,e.jsx)("div",{style:{height:ge},className:r().systerm_init,children:(0,e.jsx)("div",{className:r().init_box,children:(0,e.jsxs)("div",{className:r().init_container,children:[(0,e.jsx)("div",{className:r().icon_gif}),(0,e.jsxs)("div",{className:r().init_text,children:[(0,e.jsx)(t._H,{id:"workspace.system.initialization"}),(0,e.jsx)("span",{className:"dot"}),(0,e.jsx)("span",{className:"dot"}),(0,e.jsx)("span",{className:"dot"})]})]})})})]})}}}]);
