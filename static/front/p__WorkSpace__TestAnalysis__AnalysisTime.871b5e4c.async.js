(self.webpackChunktone_front=self.webpackChunktone_front||[]).push([[3005,2485],{88444:function(Be){Be.exports={selectMertricTable:"selectMertricTable___2Bj7A",checkboxAllStyle:"checkboxAllStyle___1teqH",selectItem:"selectItem___1oTDh",selectItemName:"selectItemName___1_fIG",activeStyle:"activeStyle___30xWh",select_inner_span:"select_inner_span___1QlbI",select_left_title:"select_left_title___399WJ",selectTable:"selectTable___9NvaM",formInlineStyles:"formInlineStyles___3Z0fP",table_question_tooltip:"table_question_tooltip___3JYrj"}},41253:function(Be){Be.exports={timeAnalysisTabs:"timeAnalysisTabs___123JK",timeAnalysisExtraBtnContent:"timeAnalysisExtraBtnContent___2QpVD",btnActive:"btnActive___jxnp0"}},52953:function(){},22928:function(Be,He,t){"use strict";t.d(He,{oG:function(){return Ie},_U:function(){return _},tk:function(){return dt},D8:function(){return vt}});var fe=t(11849),F=t(39428),Ee=t(3182),Te=t(16917);function Ie(K){return Y.apply(this,arguments)}function Y(){return Y=(0,Ee.Z)((0,F.Z)().mark(function K(N){return(0,F.Z)().wrap(function(k){for(;;)switch(k.prev=k.next){case 0:return k.abrupt("return",(0,Te.WY)("/api/job/tag/",{params:N}));case 1:case"end":return k.stop()}},K)})),Y.apply(this,arguments)}function _(K){return We.apply(this,arguments)}function We(){return We=(0,Ee.Z)((0,F.Z)().mark(function K(N){return(0,F.Z)().wrap(function(k){for(;;)switch(k.prev=k.next){case 0:return k.abrupt("return",(0,Te.WY)("/api/job/tag/",{method:"POST",data:(0,fe.Z)({},N)}));case 1:case"end":return k.stop()}},K)})),We.apply(this,arguments)}function dt(K,N){return re.apply(this,arguments)}function re(){return re=(0,Ee.Z)((0,F.Z)().mark(function K(N,me){return(0,F.Z)().wrap(function(le){for(;;)switch(le.prev=le.next){case 0:return le.abrupt("return",(0,Te.WY)("/api/job/tag/",{method:"PUT",data:(0,fe.Z)((0,fe.Z)({},me),{tag_id:N})}));case 1:case"end":return le.stop()}},K)})),re.apply(this,arguments)}var vt=function(){var K=(0,Ee.Z)((0,F.Z)().mark(function N(me){return(0,F.Z)().wrap(function(le){for(;;)switch(le.prev=le.next){case 0:return le.abrupt("return",(0,Te.WY)("/api/job/tag/",{method:"DELETE",data:me}));case 1:case"end":return le.stop()}},N)}));return function(me){return K.apply(this,arguments)}}()},82085:function(Be,He,t){"use strict";t.r(He),t.d(He,{default:function(){return vn}});var fe=t(89032),F=t(15746),Ee=t(18106),Te=t(73272),Ie=t(13062),Y=t(71230),_=t(20136),We=t(55241),dt=t(57663),re=t(71577),vt=t(88983),K=t(47933),N=t(402),me=t(97272),k=t(32059),le=t(34792),Je=t(48086),ft=t(93224),v=t(11849),xe=t(39428),Ke=t(3182),H=t(2824),Zt=t(24793),xt=t(97183),Qe=t(20310),r=t(67294),Z=t(60035),y=t(41253),g=t.n(y),f=t(16917),W=t(20009),J=t(49111),I=t(19650),Se=t(14965),he=t(36577),De=t(22385),Q=t(89456),je=t(43358),oe=t(34041),we=t(9715),U=t(20526),Xe=t(98858),Pe=t(4914),qe=t(30381),R=t.n(qe),ee=t(12788),Ue=t(68470),Ve=t(97015),Me=t(21401),et=t(22928),nt=t(71194),Ge=t(50146),Mt=t(20228),at=t(11382),st=t(66456),jt=t(79764),Dt=t(88444),$e=t.n(Dt),it=t(30171),e=t(85893),$t=function(m){var V,a=m.suiteList,B=m.onChange,l=m.runGetMetrics,ce=m.visible,x=m.basicValues,te=(0,f.YB)(),_e=te.formatMessage,se=(0,it.J)(),C=se.metrics,ye=C===void 0?[]:C,ie=r.useState(),P=(0,H.Z)(ie,2),u=P[0],j=P[1],G=r.useState(),b=(0,H.Z)(G,2),h=b[0],w=b[1],ue=r.useState(),Ce=(0,H.Z)(ue,2),O=Ce[0],n=Ce[1];r.useEffect(function(){if((a==null?void 0:a.length)>0)if(x){var d=x.test_suite_id,s=x.test_case_id;d&&s&&(j(+d),w(+s),n(x==null?void 0:x.metric))}else{var p=a==null?void 0:a[0];if(p){var A,q;j(p==null?void 0:p.test_suite_id),w(p==null||(A=p.test_case_list)===null||A===void 0||(q=A[0])===null||q===void 0?void 0:q.test_case_id)}}return function(){w(void 0),j(void 0),n([])}},[x,a]),r.useEffect(function(){ce||n([])},[ce]);var X=r.useMemo(function(){if(!!a)return a.filter(function(d){return d.test_suite_id===u})[0]},[a,u]);return r.useEffect(function(){h&&u&&l({test_suite_id:u,test_case_id:h})},[h,u]),r.useMemo(function(){if(!!X){var d=X.test_case_list,s=h?d.filter(function(p){return p.test_case_id===h})[0]:d[0];return s&&!h&&w(s.test_case_id),s}},[X,h]),r.useEffect(function(){B==null||B({activeSuite:u,activeConf:h,selectMetric:O})},[u,h,O]),(0,e.jsxs)(Y.Z,{style:{height:400},children:[(0,e.jsx)(F.Z,{span:24,style:{marginBottom:10},children:(0,e.jsxs)(Y.Z,{children:[(0,e.jsx)(F.Z,{span:12,children:(0,e.jsxs)(Y.Z,{align:"middle",children:[(0,e.jsx)("span",{style:{width:76,display:"inline-block"},children:"Test Suite:"}),(0,e.jsx)(oe.Z,{style:{width:"calc(100% - 91px - 8px)"},onChange:function(s){j(s),w(null),n([])},placeholder:"\u8BF7\u9009\u62E9Test Suite",value:u,filterOption:function(s,p){var A;return((A=p.label)===null||A===void 0?void 0:A.toLowerCase().indexOf(s.toLowerCase()))>=0},showSearch:!0,options:a==null?void 0:a.map(function(d){return{value:d.test_suite_id,label:d.test_suite_name}})})]})}),(0,e.jsx)(F.Z,{span:12,children:(0,e.jsxs)(Y.Z,{align:"middle",children:[(0,e.jsx)("span",{style:{width:76,display:"inline-block"},children:"Test Conf:"}),(0,e.jsx)(oe.Z,{style:{width:"calc(100% - 91px - 8px)"},onChange:function(s){w(s),n([])},filterOption:function(s,p){var A;return((A=p.label)===null||A===void 0?void 0:A.toLowerCase().indexOf(s.toLowerCase()))>=0},showSearch:!0,placeholder:"\u8BF7\u9009\u62E9Test Conf",value:h,options:X==null||(V=X.test_case_list)===null||V===void 0?void 0:V.map(function(d){return{value:d.test_case_id,label:d.test_case_name}})})]})})]})}),(0,e.jsx)(F.Z,{span:24,style:{height:350},children:(0,e.jsx)(jt.Z,{dataSource:ye,columns:[{dataIndex:"",title:_e({id:"analysis.metric"})}],rowKey:function(s){return s},size:"small",scroll:{y:320},rowSelection:{selectedRowKeys:O,onChange:function(s){n(s)}},onRow:function(s){return{onClick:function(){O.includes(s)?n(O.filter(function(A){return A!==s})):n(O.concat(s))}}},className:$e().selectTable,pagination:!1})})]})},Ft=$t,It=function(m){var V=m.suiteList,a=V===void 0?[]:V,B=m.test_type,l=m.isFetching,ce=m.onChange,x=m.basicValues,te=r.useState(void 0),_e=(0,H.Z)(te,2),se=_e[0],C=_e[1],ye=r.useState(void 0),ie=(0,H.Z)(ye,2),P=ie[0],u=ie[1];r.useEffect(function(){if((a==null?void 0:a.length)>0)if(x){var G=x.test_suite_id,b=x.test_case_id;G&&b&&(C(+G),u(+b))}else{var h=a==null?void 0:a[0];if(h){var w,ue;C(h==null?void 0:h.test_suite_id),u(h==null||(w=h.test_case_list)===null||w===void 0||(ue=w[0])===null||ue===void 0?void 0:ue.test_case_id)}}return function(){C(void 0),u(void 0)}},[a,x]),r.useEffect(function(){ce==null||ce({activeSuite:se,activeConf:P})},[se,P]);var j=r.useMemo(function(){if(!a)return[];for(var G=a.length,b=0;b<G;b++)if(a[b].test_suite_id===se){if(a[b].test_case_list.length>0){var h=P||a[b].test_case_list[0].test_case_id;return P||u(h),a[b].test_case_list}return[]}return[]},[se,a,B]);return(0,e.jsxs)(Y.Z,{style:{height:400},children:[(0,e.jsx)(F.Z,{span:24,style:{marginBottom:10},children:(0,e.jsxs)(Y.Z,{align:"middle",children:[(0,e.jsx)("span",{style:{width:76,display:"inline-block"},children:"Test Suite:"}),(0,e.jsx)(oe.Z,{style:{width:"calc(100% - 91px - 8px)"},onChange:function(b){C(b),u(null)},filterOption:function(b,h){var w;return((w=h.label)===null||w===void 0?void 0:w.toLowerCase().indexOf(b==null?void 0:b.toLowerCase()))>=0},showSearch:!0,placeholder:"\u8BF7\u9009\u62E9Test Suite",value:se,options:a==null?void 0:a.map(function(G){return{value:G.test_suite_id,label:G.test_suite_name}})})]})}),(0,e.jsx)(F.Z,{span:24,style:{height:350},children:(0,e.jsx)(jt.Z,{dataSource:j,columns:[{dataIndex:"test_case_name",title:"Test Conf"}],rowKey:"test_case_id",size:"small",loading:l,scroll:{y:320},className:$e().selectTable,rowSelection:{type:"radio",selectedRowKeys:[P],onChange:function(b){return u(b[0])}},onRow:function(b){return{onClick:function(){u(b.test_case_id)}}},pagination:!1})})]})},Nt=It,Yt=function(m){var V=m.suiteList,a=V===void 0?[]:V,B=m.test_type,l=m.isFetching,ce=m.show_type,x=m.onChange,te=m.basicValues,_e=m.runGetMetrics,se=(0,it.J)(),C=se.metrics,ye=C===void 0?[]:C,ie=r.useState(void 0),P=(0,H.Z)(ie,2),u=P[0],j=P[1],G=r.useState(void 0),b=(0,H.Z)(G,2),h=b[0],w=b[1],ue=r.useState(void 0),Ce=(0,H.Z)(ue,2),O=Ce[0],n=Ce[1];r.useEffect(function(){if((a==null?void 0:a.length)>0)if(te){var d=te.test_suite_id,s=te.test_case_id;d&&s&&(j(+d),w(+s))}else{var p=a==null?void 0:a[0];if(p){var A,q;j(p==null?void 0:p.test_suite_id),w(p==null||(A=p.test_case_list)===null||A===void 0||(q=A[0])===null||q===void 0?void 0:q.test_case_id)}}return function(){j(void 0),w(void 0),n(void 0)}},[a,te]),r.useEffect(function(){x==null||x({activeSuite:u,activeConf:h,selectSubcase:O})},[u,h,O]),r.useEffect(function(){h&&u&&_e({test_suite_id:u,test_case_id:h})},[h,u]);var X=r.useMemo(function(){if(!a)return[];for(var d=a.length,s=0;s<d;s++)if(a[s].test_suite_id===u){if(a[s].test_case_list.length>0){var p=h||a[s].test_case_list[0].test_case_id;return h||w(p),a[s].test_case_list}return[]}return[]},[u,a,B]);return(0,e.jsxs)(Y.Z,{children:[(0,e.jsx)(F.Z,{span:24,style:{marginBottom:10},children:(0,e.jsxs)(Y.Z,{children:[(0,e.jsx)(F.Z,{span:12,children:(0,e.jsxs)(Y.Z,{align:"middle",children:[(0,e.jsx)("span",{style:{width:76,display:"inline-block"},children:"Test Suite:"}),(0,e.jsx)(oe.Z,{style:{width:"calc(100% - 91px - 8px)"},onChange:function(s){j(s),w(null),n([])},placeholder:"\u8BF7\u9009\u62E9Test Suite",value:u,filterOption:function(s,p){var A;return((A=p.label)===null||A===void 0?void 0:A.toLowerCase().indexOf(s.toLowerCase()))>=0},showSearch:!0,options:a==null?void 0:a.map(function(d){return{value:d.test_suite_id,label:d.test_suite_name}})})]})}),(0,e.jsx)(F.Z,{span:12,children:(0,e.jsxs)(Y.Z,{align:"middle",children:[(0,e.jsx)("span",{style:{width:76,display:"inline-block"},children:"Test Conf:"}),(0,e.jsx)(oe.Z,{style:{width:"calc(100% - 91px - 8px)"},onChange:function(s){w(s),B!=="performance"&&ce!=="pass_rate"&&n([])},filterOption:function(s,p){return p.label.toLowerCase().indexOf(s.toLowerCase())>=0},showSearch:!0,placeholder:"\u8BF7\u9009\u62E9Test Conf",value:h,options:X==null?void 0:X.map(function(d){return{value:d.test_case_id,label:d.test_case_name}})})]})})]})}),(0,e.jsx)(F.Z,{span:24,children:(0,e.jsx)(jt.Z,{dataSource:ye,columns:[{dataIndex:"",title:"Test Case"}],rowKey:function(s){return s},size:"small",loading:l,scroll:{y:320},className:$e().selectTable,rowSelection:{type:"radio",selectedRowKeys:[O],onChange:function(s){n(s==null?void 0:s[0])}},onRow:function(s){return{onClick:function(){n(s)}}},pagination:{hideOnSinglePage:!0,pageSize:2e3,style:{marginBottom:0}}})})]})},Bt=Yt,Ht=function(m,V){var a=m.test_type,B=m.project_id,l=m.provider_env,ce=m.onOk,x=m.show_type,te=m.tag,_e=m.start_time,se=m.end_time,C=m.metricData,ye=(0,W.UO)(),ie=ye.ws_id,P=(0,it.J)(),u=P.suiteList,j=P.suiteListLoading,G=P.setMetrics,b=r.useState(!1),h=(0,H.Z)(b,2),w=h[0],ue=h[1],Ce=r.useState({}),O=(0,H.Z)(Ce,2),n=O[0],X=O[1],d={ws_id:ie,test_type:a,provider_env:l},s=(0,f.QT)(function(o){return(0,Me.a8)((0,v.Z)((0,v.Z)({},d),{},{project_id:B,start_time:_e,end_time:se,tag:te},o))},{manual:!0}),p=s.data,A=s.run;r.useEffect(function(){G(p)},[p]),r.useImperativeHandle(V,function(){return{show:function(){var o=(0,Ke.Z)((0,xe.Z)().mark(function S(de){return(0,xe.Z)().wrap(function(D){for(;;)switch(D.prev=D.next){case 0:ue(!0);case 1:case"end":return D.stop()}},S)}));function i(S){return o.apply(this,arguments)}return i}()}});var q=r.useCallback(function(){ue(!1),X({})},[]),rt=r.useMemo(function(){var o=n.selectMetric;return a==="performance"?"Metric".concat(o!=null&&o.length?"(".concat(o==null?void 0:o.length,")"):""):x==="pass_rate"?"Test Conf":"Test Case"},[a,x,n]),Fe=r.useMemo(function(){var o=n.selectMetric,i=n.selectSubcase,S=n.activeConf;return a==="performance"?(o==null?void 0:o.length)>0:x!=="pass_rate"?(i==null?void 0:i.length)>0:S||!1},[a,x,n]),ze=r.useMemo(function(){if(!!u){for(var o=u.length,i=0;i<o;i++)if(u[i].test_suite_id===(n==null?void 0:n.activeSuite))return u[i].test_suite_name}},[u,n]),Oe=r.useMemo(function(){if(!!u){for(var o=u.length,i=0;i<o;i++)if(u[i].test_suite_id===(n==null?void 0:n.activeSuite))return u[i].test_case_list.length>0?u[i].test_case_list:[];return[]}},[u,n]),ne=r.useMemo(function(){if(!!Oe){for(var o=Oe.length,i=0;i<o;i++)if(Oe[i].test_case_id===(n==null?void 0:n.activeConf))return Oe[i].test_case_name}},[Oe,n]),be=function(){var i=n.activeSuite,S=n.activeConf,de=n.selectMetric,ge=n.selectSubcase,D={test_suite_id:i};a==="performance"&&(D.test_case_id=S,D.metric=de,D.title="".concat(ze,"/").concat(ne)),a==="functional"&&(D.test_case_id=S,D.title="".concat(ze,"/").concat(ne),x!=="pass_rate"&&(D.sub_case_name=ge,D.test_case_id=S,D.title="".concat(ze,"/").concat(ne))),ce(D),q()},E={test_type:a,show_type:x,basicValues:C,project_id:B,provider_env:l,suiteList:u,loading:j,visible:w,runGetMetrics:A,metrics:p,onChange:function(i){X(function(S){return(0,v.Z)((0,v.Z)({},S),i)})}};return(0,e.jsx)(Ge.Z,{title:rt,width:940,open:w,onCancel:q,destroyOnClose:!0,footer:(0,e.jsxs)(I.Z,{children:[(0,e.jsx)(re.Z,{onClick:q,children:(0,e.jsx)(f._H,{id:"operation.cancel"})}),(0,e.jsx)(re.Z,{type:"primary",onClick:be,disabled:!Fe,children:(0,e.jsx)(f._H,{id:"operation.ok"})})]}),children:(0,e.jsxs)(at.Z,{spinning:j,children:[a==="performance"&&(0,e.jsx)(Ft,(0,v.Z)({},E)),a!=="performance"&&(x==="pass_rate"?(0,e.jsx)(Nt,(0,v.Z)({},E)):(0,e.jsx)(Bt,(0,v.Z)({},E)))]})})},Wt=r.forwardRef(Ht),Kt=t(1870),Ut=t(65923),Vt=t(27807),Gt=t(99846),zt=t(14780),mt=t(44586),kt=["time"],Lt,Jt=(0,ee.ZP)(Y.Z)(Lt||(Lt=(0,Qe.Z)([`
    position:relative;
    width:100%;
    .tootip_pos {
        position:absolute;
        left:330px;
        top:4px;
    }
`]))),_t={fontWeight:"bold"},Qt=function(m){var V,a,B=(V=m.title)===null||V===void 0?void 0:V.split("/");return(0,e.jsx)("div",{style:{color:"#000"},children:(0,e.jsxs)(Pe.Z,{column:1,children:[(0,e.jsx)(Pe.Z.Item,{label:"Suite",labelStyle:(0,v.Z)((0,v.Z)({},_t),{},{paddingLeft:10}),children:B==null?void 0:B[0]}),(0,e.jsx)(Pe.Z.Item,{label:"Conf",labelStyle:(0,v.Z)((0,v.Z)({},_t),{},{paddingLeft:12}),children:B==null?void 0:B[1]}),(0,e.jsx)(Pe.Z.Item,{label:"Metric",contentStyle:{display:"inline-block",paddingBottom:8},labelStyle:(0,v.Z)({},_t),children:m==null||(a=m.metric)===null||a===void 0?void 0:a.map(function(l){return(0,e.jsx)("div",{children:l},l)})})]})})},Xt=function(m,V){var a,B=(0,f.YB)(),l=B.formatMessage,ce=(0,W.UO)(),x=ce.ws_id,te=(0,it.J)(),_e=te.setMetrics,se=(0,W.TH)(),C=se.query,ye=m.info,ie=m.setInfo,P=ye.show_type,u=ye.provider_env,j=ye.test_type,G=(0,r.useState)({}),b=(0,H.Z)(G,2),h=b[0],w=b[1],ue=(0,r.useState)([]),Ce=(0,H.Z)(ue,2),O=Ce[0],n=Ce[1],X=(0,r.useState)(null),d=(0,H.Z)(X,2),s=d[0],p=d[1],A=(0,r.useState)(JSON.stringify(C)!=="{}"),q=(0,H.Z)(A,2),rt=q[0],Fe=q[1],ze=r.useState([]),Oe=(0,H.Z)(ze,2),ne=Oe[0],be=Oe[1],E=(0,r.useRef)(),o=U.Z.useForm(),i=(0,H.Z)(o,1),S=i[0],de=U.Z.useWatch("project_id",S),ge=U.Z.useWatch("tag",S),D=U.Z.useWatch("time",S);r.useImperativeHandle(V,function(){return{reset:function(){S.resetFields(),p(void 0)}}});var Le=(0,f.QT)(function(){var M=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{ws_id:x,page_size:999};return(0,et.oG)(M)},{initialData:[]}),Ze=Le.data,lt=(0,f.QT)(function(){return(0,Me.YK)({ws_id:x,page_size:500})},{initialData:[]}),Ne=lt.data,tt=function(){var M=(0,Ke.Z)((0,xe.Z)().mark(function c(L){var $,T,ae,ve,Ae,ke;return(0,xe.Z)().wrap(function(z){for(;;)switch(z.prev=z.next){case 0:if(ie(L),Fe(!0),n([]),w({}),j!=="performance"){z.next=10;break}return z.next=7,(0,Me.ie)(L);case 7:z.t0=z.sent,z.next=13;break;case 10:return z.next=12,(0,Me.mq)(L);case 12:z.t0=z.sent;case 13:if($=z.t0,T=$.data,ae=$.code,Fe(!1),ae===200){z.next=19;break}return z.abrupt("return");case 19:if(T){z.next=21;break}return z.abrupt("return");case 21:if(ve=T.job_list,Ae=T.metric_map,ke=T.case_map,!(ve&&ve.length>0)){z.next=26;break}return w(j==="performance"?Ae:ke),n(ve),z.abrupt("return");case 26:case"end":return z.stop()}},c)}));return function(L){return M.apply(this,arguments)}}(),ot=function(){S.getFieldValue("project_id")?E.current.show():Je.default.error(l({id:"analysis.selected.error"}))},Re=function(){var c=j==="functional"?{show_type:P}:{provider_env:u},L=S.getFieldsValue(),$=L.time,T=(0,ft.Z)(L,kt);if($&&$.length>0){var ae=(0,H.Z)($,2),ve=ae[0],Ae=ae[1];c.start_time=R()(ve).format("YYYY-MM-DD"),c.end_time=R()(Ae).format("YYYY-MM-DD")}return(0,v.Z)((0,v.Z)({},c),T)},Ye=function(c){var L=c.test_suite_id,$=c.test_case_id,T=Re(),ae=T.project_id;ae&&L&&$&&tt((0,v.Z)((0,v.Z)({ws_id:x},T),c))};r.useEffect(function(){var M,c=Re(),L=(0,v.Z)((0,v.Z)((0,v.Z)({},c),s),{},{metric:s==null||(M=s.metric)===null||M===void 0?void 0:M.toString()});(ne==null?void 0:ne.length)!==0&&(ne==null||ne.forEach(function($){var T=$.metric,ae=T==null?void 0:T[0];L[ae]=T.toString()})),ie(L)},[ne,s]);var ht=function(c){if(p(c),j!=="performance")Ye(c);else{var L=c.metric,$=Re(),T=L.map(function(ae){return(0,v.Z)((0,v.Z)((0,v.Z)({},$),c),{},{metric:[ae],key:(0,mt.Z)(),ws_id:x})});n([]),be(T)}},pt=function(c){var L;if(_e([]),(c==null||(L=c[0].name)===null||L===void 0?void 0:L[0])==="project_id"){p(null),n([]),w(null),be([]);return}var $=Re();if(n([]),w(null),be([]),s){var T=s.test_suite_id,ae=s.test_case_id,ve=s.metric,Ae=$.project_id;if(T&&ae&&Ae){if(j==="performance"){var ke=ve.map(function(ct){return(0,v.Z)((0,v.Z)((0,v.Z)({},$),s),{},{metric:[ct],key:(0,mt.Z)(),ws_id:x})});be(ke);return}tt((0,v.Z)((0,v.Z)({ws_id:x},$),s))}}};(0,r.useEffect)(function(){return function(){w(null),n([]),be([])}},[u,P,j]),(0,r.useEffect)(function(){if(C&&JSON.stringify(C)!=="{}"){var M=C.test_type,c=C.project_id,L=C.tag,$=C.start_time,T=C.end_time,ae=C.provider_env,ve=C.metric,Ae=C.title,ke=C.test_suite_id,ct=C.test_case_id,z=C.sub_case_name,Ct=C.days,ut=Object.prototype.toString.call(ve)==="[object Array]"?ve:ve==null?void 0:ve.split(",");if(j===M){var gt={metric:ut,project_id:c,tag:L,test_suite_id:ke,test_case_id:ct,sub_case_name:z,show_type:P,provider_env:ae,ws_id:x},bt=$,Ot=T||R()().format("YYYY-MM-DD"),At=!isNaN(+Ct)&&Object.prototype.toString.call(+Ct)==="[object Number]";if(At&&(bt=R()().subtract(Ct-1,"days"),Ot=R()()),gt.start_time=R()(bt).format("YYYY-MM-DD"),gt.end_time=R()(Ot).format("YYYY-MM-DD"),Ae)if(j!=="performance")Fe(!1),tt(gt);else{var fn=ut==null?void 0:ut.map(function(St){var wt;return(0,v.Z)((0,v.Z)({},gt),{},{metric:C[St]?(wt=C[St])===null||wt===void 0?void 0:wt.split(","):[St],key:(0,mt.Z)()})});n([]),be(fn)}Ae||Fe(!1),p({title:Ae,metric:ut,sub_case_name:z,test_suite_id:ke,test_case_id:ct}),At?S.setFieldsValue({time:[R()(bt),R()()]}):$&&S.setFieldsValue({time:[R()($),T?R()(T):R()()]}),S.setFieldsValue({project_id:+c||void 0,tag:+L||""})}}},[]);var yt=function(c){n(function(L){var $=c.map(function(T){return T.id});return L.filter(function(T){return!$.includes(T.id)}).concat(c).sort(function(T,ae){return ae.id-T.id})})};return(0,e.jsxs)("div",{style:{width:"100%",background:"rgba(0, 0, 0, 0.04)",position:"relative"},children:[rt&&(0,e.jsx)(zt.Z,{}),(0,e.jsxs)(Y.Z,{style:{padding:"0 20px 10px",background:"#fff",marginBottom:10},children:[(0,e.jsx)(F.Z,{span:24,children:(0,e.jsxs)(U.Z,{layout:"inline",form:S,colon:!0,onFieldsChange:pt,className:$e().formInlineStyles,wrapperCol:{span:20},initialValues:{time:[R()().subtract(29,"days"),R()().startOf("day")],tag:""},children:[(0,e.jsx)(U.Z.Item,{label:(0,e.jsx)(f._H,{id:"analysis.project"}),name:"project_id",children:(0,e.jsx)(oe.Z,{placeholder:l({id:"analysis.project.placeholder"}),showSearch:!0,filterOption:function(c,L){return L.label.toLowerCase().indexOf(c.toLowerCase())>=0},options:Ne.map(function(M){return{value:M.id,label:M.name}})})}),(0,e.jsx)(U.Z.Item,{label:(0,e.jsx)(f._H,{id:"analysis.tag"}),children:(0,e.jsxs)(Jt,{children:[(0,e.jsx)(U.Z.Item,{name:"tag",children:(0,e.jsx)(oe.Z,{allowClear:!0,style:{width:330},placeholder:l({id:"analysis.tag.placeholder"}),showSearch:!0,filterOption:function(c,L){return L.label.toLowerCase().indexOf(c.toLowerCase())>=0},options:[{value:"",label:l({id:"analysis.indistinguishable"})}].concat(Ze.filter(function(M){var c=M.creator;return Object.prototype.toString.call(c)==="[object Number]"}).map(function(M){return{value:M.id,label:M.name}}))})}),(0,e.jsx)("div",{className:"tootip_pos",children:(0,e.jsx)(Q.Z,{overlayClassName:$e().table_question_tooltip,color:"#fff",placement:"top",arrowPointAtCenter:!0,title:l({id:"analysis.only.the.job.data"}),children:(0,e.jsx)(Kt.Z,{style:{color:"rgba(0, 0, 0, 0.65)",marginLeft:5}})})})]})}),(0,e.jsx)(U.Z.Item,{label:(0,e.jsx)(f._H,{id:"analysis.date"}),name:"time",children:(0,e.jsx)(he.Z.RangePicker,{ranges:(a={},(0,k.Z)(a,l({id:"analysis.7days"}),[R()().subtract(6,"days"),R()().startOf("day")]),(0,k.Z)(a,l({id:"analysis.30days"}),[R()().subtract(29,"days"),R()().startOf("day")]),(0,k.Z)(a,l({id:"analysis.60days"}),[R()().subtract(59,"days"),R()().startOf("day")]),(0,k.Z)(a,l({id:"analysis.90days"}),[R()().subtract(89,"days"),R()().startOf("day")]),a)})})]})}),(0,e.jsx)(F.Z,{span:24,children:(0,e.jsxs)(Y.Z,{style:{marginTop:12},align:"middle",children:[j==="functional"&&P==="pass_rate"&&(0,e.jsx)("span",{className:$e().select_left_title,children:"Test Conf\uFF1A"}),j==="functional"&&P==="result_trend"&&(0,e.jsx)("span",{className:$e().select_left_title,children:"Test Case\uFF1A"}),j!=="functional"&&(0,e.jsxs)("span",{className:$e().select_left_title,children:[(0,e.jsx)(f._H,{id:"analysis.metric"}),"\uFF1A"]}),s&&(0,e.jsx)(Q.Z,{title:P==="result_trend"?s.sub_case_name:(0,e.jsx)(Qt,(0,v.Z)({},s)),autoAdjustOverflow:!0,placement:"bottomLeft",color:"#fff",overlayInnerStyle:{minWidth:300,maxHeight:300,overflowY:"auto",color:"#333"},children:(0,e.jsx)("span",{className:$e().select_inner_span,children:s.title})}),(0,e.jsx)(re.Z,{style:{padding:0,marginLeft:8},type:"link",onClick:ot,children:(0,e.jsx)(f._H,{id:"analysis.select"})})]})})]}),j==="performance"&&(0,e.jsx)(Y.Z,{children:(0,e.jsx)(I.Z,{style:{width:"100%",background:"rgba(0, 0, 0, 0.04)"},direction:"vertical",children:ne==null?void 0:ne.map(function(M){var c={fetchData:M,key:M.key,provider_env:u,valueChange:yt,setFetchData:be,setLoading:Fe};return u==="aliyun"?(0,e.jsx)(Ut.Z,(0,v.Z)({},c)):(0,e.jsx)(Vt.ZP,(0,v.Z)({},c))})})}),(0,e.jsx)(Y.Z,{children:(0,e.jsxs)(I.Z,{style:{width:"100%",background:"rgba(0, 0, 0, 0.04)"},direction:"vertical",children:[j!=="performance"&&(O==null?void 0:O.length)>0&&(0,e.jsx)(Ve.Z,{test_type:j,provider_env:u,show_type:P,dataSource:h}),(O==null?void 0:O.length)===0&&(0,e.jsx)(Gt.Z,{}),(O==null?void 0:O.length)>0&&(0,e.jsx)(Ue.Z,{refresh:function(){if(j==="performance"){be(function(c){return c.map(function(L){return(0,v.Z)((0,v.Z)({},L),{},{key:(0,mt.Z)()})})});return}Ye(s)},dataSource:O,test_type:j,show_type:P})]})}),(0,e.jsx)(Wt,{ref:E,project_id:de,start_time:D&&R()(D[0]).format("YYYY-MM-DD"),end_time:D&&R()(D[1]).format("YYYY-MM-DD"),tag:ge,show_type:P,provider_env:u,test_type:j,metricData:s,onOk:ht})]})},qt=r.forwardRef(Xt),en=t(87735),tn=t(4424),Rt=t(28991),nn={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M574 665.4a8.03 8.03 0 00-11.3 0L446.5 781.6c-53.8 53.8-144.6 59.5-204 0-59.5-59.5-53.8-150.2 0-204l116.2-116.2c3.1-3.1 3.1-8.2 0-11.3l-39.8-39.8a8.03 8.03 0 00-11.3 0L191.4 526.5c-84.6 84.6-84.6 221.5 0 306s221.5 84.6 306 0l116.2-116.2c3.1-3.1 3.1-8.2 0-11.3L574 665.4zm258.6-474c-84.6-84.6-221.5-84.6-306 0L410.3 307.6a8.03 8.03 0 000 11.3l39.7 39.7c3.1 3.1 8.2 3.1 11.3 0l116.2-116.2c53.8-53.8 144.6-59.5 204 0 59.5 59.5 53.8 150.2 0 204L665.3 562.6a8.03 8.03 0 000 11.3l39.8 39.8c3.1 3.1 8.2 3.1 11.3 0l116.2-116.2c84.5-84.6 84.5-221.5 0-306.1zM610.1 372.3a8.03 8.03 0 00-11.3 0L372.3 598.7a8.03 8.03 0 000 11.3l39.6 39.6c3.1 3.1 8.2 3.1 11.3 0l226.4-226.4c3.1-3.1 3.1-8.2 0-11.3l-39.5-39.6z"}}]},name:"link",theme:"outlined"},an=nn,sn=t(27029),rn=function(m,V){return r.createElement(sn.Z,(0,Rt.Z)((0,Rt.Z)({},m),{},{ref:V,icon:an}))},ln=r.forwardRef(rn),on=ln,cn=["test_type","show_type","provider_env","metric"],Et,Tt,un=(0,ee.ZP)(xt.Z.Content).attrs(function(pe){return{style:{minHeight:pe==null?void 0:pe.minHeight}}})(Et||(Et=(0,Qe.Z)([`
    overflow: auto;
    margin-bottom: 10px;
    background: #fff;
`]))),Pt=ee.ZP.div(Tt||(Tt=(0,Qe.Z)([`
    display: flex;
    flex-direction: column;
    gap: `,`px;
`])),function(pe){var m=pe.gap;return m||10}),dn=function(m){var V=(0,f.YB)(),a=V.formatMessage,B=(0,W.TH)(),l=B.query,ce=B.key,x=(0,W.UO)(),te=x.ws_id,_e=m.route,se=r.useState([]),C=(0,H.Z)(se,2),ye=C[0],ie=C[1],P=r.useRef(null),u="aligroup",j="Workspace.TestAnalysis.".concat(_e.name),G=r.useState(1),b=(0,H.Z)(G,2),h=b[0],w=b[1],ue=function(){var E=(0,Ke.Z)((0,xe.Z)().mark(function o(i){var S,de,ge,D;return(0,xe.Z)().wrap(function(Ze){for(;;)switch(Ze.prev=Ze.next){case 0:return Ze.next=2,(0,Me.Hz)(i);case 2:if(S=Ze.sent,de=S.data,ge=S.code,D=S.msg,ge===200){Ze.next=8;break}return Ze.abrupt("return",console.log(D));case 8:ie(de||[]);case 9:case"end":return Ze.stop()}},o)}));return function(i){return E.apply(this,arguments)}}();r.useEffect(function(){if(JSON.stringify(l)!=="{}"){var E=l.test_suite_id,o=l.test_case_id,i=l.project_id;E&&o&&i&&ue((0,v.Z)((0,v.Z)({},l),{},{ws_id:te}))}},[l,te]),(0,Z.jk)(j);var Ce=r.useState({test_type:(l==null?void 0:l.test_type)||"performance",provider_env:(l==null?void 0:l.provider_env)||u,show_type:(l==null?void 0:l.show_type)||"pass_rate",project_id:(l==null?void 0:l.project_id)||void 0,tag:(l==null?void 0:l.tag)||void 0,start_time:(l==null?void 0:l.start_time)||void 0,end_time:(l==null?void 0:l.end_time)||void 0}),O=(0,H.Z)(Ce,2),n=O[0],X=O[1],d=(0,f.QT)(Me.Uz,{manual:!0,debounceInterval:500}),s=d.data,p=d.loading,A=d.run;r.useEffect(function(){var E=n.test_type,o=n.provider_env,i=n.project_id;E&&o&&i&&A({ws_id:te,test_type:E,provider_env:o,project_id:i})},[n==null?void 0:n.test_type,n==null?void 0:n.provider_env,n==null?void 0:n.project_id]);var q=function(o){var i,S=n.test_type,de=n.provider_env,ge=de===void 0?"aliyun":de,D=n.show_type,Le=D===void 0?"pass_rate":D;X((0,v.Z)({test_type:S,provider_env:ge,show_type:["pass_rate","result_trend"].includes(Le)?Le:"pass_rate"},o)),ie([]),(i=P.current)===null||i===void 0||i.reset()},rt=function(o){var i=o.target;q({provider_env:i==null?void 0:i.value})},Fe=function(o){q({test_type:o})},ze=function(o){var i=o.target;q({show_type:i==null?void 0:i.value})},Oe=[{key:"performance",tab:a({id:"analysis.performance"})},{key:"functional",tab:a({id:"analysis.functional"})}],ne=(0,Z.oM)(a({id:"analysis.copy.to.clipboard"})),be=function(){var E=(0,Ke.Z)((0,xe.Z)().mark(function o(i){var S,de,ge,D,Le,Ze,lt,Ne,tt,ot,Re,Ye,ht,pt,yt;return(0,xe.Z)().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:if(de=window.location,ge=de.origin,D=de.pathname,Le=n.test_type,Ze=n.show_type,lt=n.provider_env,Ne=n.metric,tt=(0,ft.Z)(n,cn),n.project_id){c.next=4;break}return c.abrupt("return",Je.default.error(a({id:"analysis.selected.error"})));case 4:if(ot=Le==="functional",Re=(0,v.Z)((0,v.Z)({},tt),{},(S={test_type:Le,provider_env:lt,show_type:Ze},(0,k.Z)(S,ot?"show_type":"provider_env",ot?Ze:lt),(0,k.Z)(S,"ws_id",te),S)),i!==1&&Le!=="functional"&&Ne&&(Ye=Ne==null?void 0:Ne.split(","),Re.metricList=Ye,Re.fetchData=Ye==null?void 0:Ye.map(function(L){var $;return{metric:n==null||($=n[L])===null||$===void 0?void 0:$.split(",")}})),i===1&&Le==="performance"&&(Re.metric=Ne),i===1){c.next=15;break}return c.next=11,(0,tn.Et)(Re);case 11:return ht=c.sent,pt=ht.data,ne("".concat(ge,"/share/analysis/").concat(pt)),c.abrupt("return");case 15:yt=ge+D+"?"+(0,en.stringify)(Re),ne(yt);case 17:case"end":return c.stop()}},o)}));return function(i){return E.apply(this,arguments)}}();return(0,e.jsx)(it.u.Provider,{value:{metrics:ye,setMetrics:ie,suiteList:s,suiteListLoading:p},children:(0,e.jsx)(un,{minHeight:innerHeight-40,children:(0,e.jsxs)(Y.Z,{style:{background:"#fff"},children:[(0,e.jsx)(F.Z,{span:24,children:(0,e.jsx)(Te.Z,{activeKey:n==null?void 0:n.test_type,style:{width:"100%"},className:g().timeAnalysisTabs,onTabClick:Fe,tabBarExtraContent:(0,e.jsxs)(Y.Z,{justify:"center",align:"middle",children:[(0,e.jsx)(We.Z,{placement:"bottomRight",title:(0,e.jsx)(f._H,{id:"analysis.share_link"}),content:(0,e.jsxs)(Pt,{children:[(0,e.jsx)(me.Z.Text,{strong:!0,children:(0,e.jsx)(f._H,{id:"analysis.share_link.desc"})}),(0,e.jsx)(K.ZP.Group,{value:h,defaultValue:1,onChange:function(o){var i;return w(o==null||(i=o.target)===null||i===void 0?void 0:i.value)},children:(0,e.jsx)(Pt,{children:[{value:1,label:a({id:"analysis.share_link.radio1"})},{value:2,label:a({id:"analysis.share_link.radio2"})}].map(function(E){return(0,e.jsx)("div",{children:(0,e.jsx)(K.ZP,{value:E.value,children:E.label})},E.value)})})}),(0,e.jsx)(re.Z,{onClick:function(){return be(h)},children:(0,e.jsx)(f._H,{id:"ws.test.job.copy.link"})})]}),children:(0,e.jsxs)(re.Z,{style:{marginRight:24},children:[(0,e.jsx)("span",{style:{marginRight:10},children:(0,e.jsx)(on,{})}),(0,e.jsx)(f._H,{id:"analysis.share"})]})}),(n==null?void 0:n.test_type)==="performance"?(0,e.jsxs)(K.ZP.Group,{value:n==null?void 0:n.provider_env,style:{marginRight:20},onChange:rt,children:[(0,e.jsx)(K.ZP.Button,{style:{textAlign:"center"},value:"aligroup",children:a({id:"aligroupServer"})}),(0,e.jsx)(K.ZP.Button,{style:{textAlign:"center"},value:"aliyun",children:a({id:"aliyunServer"})})]}):(0,e.jsxs)(K.ZP.Group,{value:n==null?void 0:n.show_type,style:{marginRight:20},onChange:ze,children:[(0,e.jsx)(K.ZP.Button,{style:{width:120,textAlign:"center"},value:"pass_rate",children:(0,e.jsx)(f._H,{id:"analysis.pass_rate"})}),(0,e.jsx)(K.ZP.Button,{style:{width:120,textAlign:"center"},value:"result_trend",children:(0,e.jsx)(f._H,{id:"analysis.result_trend"})})]})]}),children:Oe.map(function(E){return(0,r.createElement)(Te.Z.TabPane,(0,v.Z)((0,v.Z)({},E),{},{key:E.key}))})})}),(0,e.jsx)(F.Z,{span:24,children:(0,e.jsx)(qt,{ref:P,info:n,setInfo:function(o){X(function(i){return(0,v.Z)((0,v.Z)({},i),o)})}})})]})})},ce)},vn=dn},4914:function(Be,He,t){"use strict";t.d(He,{K:function(){return xe},Z:function(){return r}});var fe=t(96156),F=t(28481),Ee=t(90484),Te=t(94184),Ie=t.n(Te),Y=t(37419),_=t(67294),We=t(53124),dt=t(96159),re=t(24308),vt=function(y){var g=y.children;return g},K=vt,N=t(22122);function me(Z){return Z!=null}var k=function(y){var g=y.itemPrefixCls,f=y.component,W=y.span,J=y.className,I=y.style,Se=y.labelStyle,he=y.contentStyle,De=y.bordered,Q=y.label,je=y.content,oe=y.colon,we=f;return De?_.createElement(we,{className:Ie()((0,fe.Z)((0,fe.Z)({},"".concat(g,"-item-label"),me(Q)),"".concat(g,"-item-content"),me(je)),J),style:I,colSpan:W},me(Q)&&_.createElement("span",{style:Se},Q),me(je)&&_.createElement("span",{style:he},je)):_.createElement(we,{className:Ie()("".concat(g,"-item"),J),style:I,colSpan:W},_.createElement("div",{className:"".concat(g,"-item-container")},(Q||Q===0)&&_.createElement("span",{className:Ie()("".concat(g,"-item-label"),(0,fe.Z)({},"".concat(g,"-item-no-colon"),!oe)),style:Se},Q),(je||je===0)&&_.createElement("span",{className:Ie()("".concat(g,"-item-content")),style:he},je)))},le=k;function Je(Z,y,g){var f=y.colon,W=y.prefixCls,J=y.bordered,I=g.component,Se=g.type,he=g.showLabel,De=g.showContent,Q=g.labelStyle,je=g.contentStyle;return Z.map(function(oe,we){var U=oe.props,Xe=U.label,Pe=U.children,qe=U.prefixCls,R=qe===void 0?W:qe,ee=U.className,Ue=U.style,Ve=U.labelStyle,Me=U.contentStyle,et=U.span,nt=et===void 0?1:et,Ge=oe.key;return typeof I=="string"?_.createElement(le,{key:"".concat(Se,"-").concat(Ge||we),className:ee,style:Ue,labelStyle:(0,N.Z)((0,N.Z)({},Q),Ve),contentStyle:(0,N.Z)((0,N.Z)({},je),Me),span:nt,colon:f,component:I,itemPrefixCls:R,bordered:J,label:he?Xe:null,content:De?Pe:null}):[_.createElement(le,{key:"label-".concat(Ge||we),className:ee,style:(0,N.Z)((0,N.Z)((0,N.Z)({},Q),Ue),Ve),span:1,colon:f,component:I[0],itemPrefixCls:R,bordered:J,label:Xe}),_.createElement(le,{key:"content-".concat(Ge||we),className:ee,style:(0,N.Z)((0,N.Z)((0,N.Z)({},je),Ue),Me),span:nt*2-1,component:I[1],itemPrefixCls:R,bordered:J,content:Pe})]})}var ft=function(y){var g=_.useContext(xe),f=y.prefixCls,W=y.vertical,J=y.row,I=y.index,Se=y.bordered;return W?_.createElement(_.Fragment,null,_.createElement("tr",{key:"label-".concat(I),className:"".concat(f,"-row")},Je(J,y,(0,N.Z)({component:"th",type:"label",showLabel:!0},g))),_.createElement("tr",{key:"content-".concat(I),className:"".concat(f,"-row")},Je(J,y,(0,N.Z)({component:"td",type:"content",showContent:!0},g)))):_.createElement("tr",{key:I,className:"".concat(f,"-row")},Je(J,y,(0,N.Z)({component:Se?["th","td"]:"td",type:"item",showLabel:!0,showContent:!0},g)))},v=ft,xe=_.createContext({}),Ke={xxl:3,xl:3,lg:3,md:3,sm:2,xs:1};function H(Z,y){if(typeof Z=="number")return Z;if((0,Ee.Z)(Z)==="object")for(var g=0;g<re.c4.length;g++){var f=re.c4[g];if(y[f]&&Z[f]!==void 0)return Z[f]||Ke[f]}return 3}function Zt(Z,y,g){var f=Z;return(y===void 0||y>g)&&(f=(0,dt.Tm)(Z,{span:g})),f}function xt(Z,y){var g=(0,Y.Z)(Z).filter(function(I){return I}),f=[],W=[],J=y;return g.forEach(function(I,Se){var he,De=(he=I.props)===null||he===void 0?void 0:he.span,Q=De||1;if(Se===g.length-1){W.push(Zt(I,De,J)),f.push(W);return}Q<J?(J-=Q,W.push(I)):(W.push(Zt(I,Q,J)),f.push(W),J=y,W=[])}),f}function Qe(Z){var y=Z.prefixCls,g=Z.title,f=Z.extra,W=Z.column,J=W===void 0?Ke:W,I=Z.colon,Se=I===void 0?!0:I,he=Z.bordered,De=Z.layout,Q=Z.children,je=Z.className,oe=Z.style,we=Z.size,U=Z.labelStyle,Xe=Z.contentStyle,Pe=_.useContext(We.E_),qe=Pe.getPrefixCls,R=Pe.direction,ee=qe("descriptions",y),Ue=_.useState({}),Ve=(0,F.Z)(Ue,2),Me=Ve[0],et=Ve[1],nt=H(J,Me);_.useEffect(function(){var at=re.ZP.subscribe(function(st){(0,Ee.Z)(J)==="object"&&et(st)});return function(){re.ZP.unsubscribe(at)}},[]);var Ge=xt(Q,nt),Mt=_.useMemo(function(){return{labelStyle:U,contentStyle:Xe}},[U,Xe]);return _.createElement(xe.Provider,{value:Mt},_.createElement("div",{className:Ie()(ee,(0,fe.Z)((0,fe.Z)((0,fe.Z)({},"".concat(ee,"-").concat(we),we&&we!=="default"),"".concat(ee,"-bordered"),!!he),"".concat(ee,"-rtl"),R==="rtl"),je),style:oe},(g||f)&&_.createElement("div",{className:"".concat(ee,"-header")},g&&_.createElement("div",{className:"".concat(ee,"-title")},g),f&&_.createElement("div",{className:"".concat(ee,"-extra")},f)),_.createElement("div",{className:"".concat(ee,"-view")},_.createElement("table",null,_.createElement("tbody",null,Ge.map(function(at,st){return _.createElement(v,{key:st,index:st,colon:Se,prefixCls:ee,vertical:De==="vertical",bordered:he,row:at})}))))))}Qe.Item=K;var r=Qe},98858:function(Be,He,t){"use strict";var fe=t(38663),F=t.n(fe),Ee=t(52953),Te=t.n(Ee)}}]);
