(self.webpackChunktone_front=self.webpackChunktone_front||[]).push([[4864,2485],{60645:function(G){G.exports={roleStyle:"roleStyle___36aEv"}},60363:function(G){G.exports={layout:"layout___2yFTo",ws_slider:"ws_slider___1zVuy",ws_menu_styles:"ws_menu_styles___3L0T1",ws_sb_st:"ws_sb_st___3rvCe",content:"content___2Oc8K",tab_style:"tab_style___3GIsz",select_baseline:"select_baseline___1y8k4"}},51812:function(){},75073:function(G,I,e){"use strict";e.d(I,{mQ:function(){return K},gM:function(){return E},nU:function(){return c}});var Z=e(40204),S=e(10724),y=e(41428),D=e(97939),W,C,B,h,K=(0,D.ZP)(S.Z)(W||(W=(0,y.Z)([`
    border:none !important;
    .ant-card-head {
        min-height: 48px;
        .ant-tabs-tab { min-height : 48px; }
        .ant-card-head-title{
            padding: 0;
        }
        .ant-card-extra {
            padding: 0;
        }
    }
    .common_pagination { padding-bottom:0 ;}
`]))),E=(0,D.ZP)(K)(C||(C=(0,y.Z)([`
    border:none!important;
    .ant-card-head .ant-card-head-wrapper { min-height:48px; }
    .ant-card-head-title { font-weight: normal; font-size:14px;}
    .commom_pagination { margin-bottom:0 ;}
    .ant-tabs-nav { margin : 0 ;}
    .ant-spin-nested-loading > div > .ant-spin {
        position: fixed;
        left: 50%;
        top: 50%;
        transform: translate(-50%, -50%);
    }
`]))),$=(0,D.ZP)(S.Z)(B||(B=(0,y.Z)([`
    border:none !important;
    .ant-card-head {
        min-height: 48px;
        padding: 0 32px;
        .ant-tabs-tab { min-height : 48px; }
        .ant-card-head-title{
            padding: 0;
        }
        .ant-card-extra {
            padding: 0;
        }
    }
    .ant-card-body{
        padding: 24px 24px 24px 0px;
    }
    .common_pagination { padding-bottom:0 ;}
`]))),c=(0,D.ZP)($)(h||(h=(0,y.Z)([`
    border:none!important;
    .ant-card-head .ant-card-head-wrapper { min-height:48px; }
    .ant-card-head-title { font-weight: normal; font-size:14px;}
    .commom_pagination { margin-bottom:0 ;}
    .ant-tabs-nav { margin : 0 ;}
    .ant-spin-nested-loading > div > .ant-spin {
        position: fixed;
        left: 50%;
        top: 50%;
        transform: translate(-50%, -50%);
    }
`])))},66804:function(G,I,e){"use strict";e.d(I,{Uy:function(){return D},wD:function(){return C},C2:function(){return h},VK:function(){return E}});var Z=e(35832),S=e(32326),y=e(22812);function D(c){return W.apply(this,arguments)}function W(){return W=(0,S.Z)((0,Z.Z)().mark(function c(w){return(0,Z.Z)().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",(0,y.WY)("/api/auth/role/",{params:w}));case 1:case"end":return l.stop()}},c)})),W.apply(this,arguments)}function C(c){return B.apply(this,arguments)}function B(){return B=(0,S.Z)((0,Z.Z)().mark(function c(w){return(0,Z.Z)().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",(0,y.WY)("/api/auth/user/",{params:w}));case 1:case"end":return l.stop()}},c)})),B.apply(this,arguments)}function h(c){return K.apply(this,arguments)}function K(){return K=(0,S.Z)((0,Z.Z)().mark(function c(w){return(0,Z.Z)().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",(0,y.WY)("/api/auth/user/",{method:"POST",data:w}));case 1:case"end":return l.stop()}},c)})),K.apply(this,arguments)}function E(c){return $.apply(this,arguments)}function $(){return $=(0,S.Z)((0,Z.Z)().mark(function c(w){return(0,Z.Z)().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",(0,y.WY)("/api/auth/reset_password/",{method:"POST",data:w}));case 1:case"end":return l.stop()}},c)})),$.apply(this,arguments)}},81415:function(G,I,e){"use strict";e.r(I),e.d(I,{default:function(){return Je}});var Z=e(16832),S=e(69827),y=e(67515),D=e(41083),W=e(69230),C=e(33821),B=e(14320),h=e(53479),K=e(31650),E=e(25100),$=e(70772),c=e(6701),w=e(98604),V=e(68917),l=e(54905),X=e(90087),Q=e(57359),me=e(34423),Me=e(46721),fe=e(94867),je=e(47721),ge=e(47152),Ze=e(20693),_e=e(3278),ne=e(81138),J=e(96146),N=e(20418),u=e(35832),O=e(32326),T=e(65790),H=e(17187),f=e(39190),v=e(22374),d=e(22812),ae=e(29197),We=e(60363),Se=e.n(We),En=e(11407),Ue=e(41604),On=e(20632),Ae=e(71853),xn=e(51937),Ie=e(34516),Be=e(60645),Ke=e.n(Be),te=e(39935),$e=e(24812),n=e(52454),Ne=function(U){var m=(0,d.YB)(),_=m.formatMessage,re=(0,$e.UO)(),z=re.ws_id,M=U.user_info,F=U.select,se=M.role_list,ve=M.id,oe=M.can_update,ie=se.map(function(R){return R.name}),k=function(){var R=(0,O.Z)((0,u.Z)().mark(function le(g){var q;return(0,u.Z)().wrap(function(A){for(;;)switch(A.prev=A.next){case 0:return A.next=2,(0,ae.Am)({ws_id:z,role_id:g,user_id:ve});case 2:q=A.sent,q.code===200?(J.default.success(_({id:"member.role.modified.success"})),U.handleOk(),U.onOk()):(0,te.EV)(q.code,q.msg);case 4:case"end":return A.stop()}},le)}));return function(g){return R.apply(this,arguments)}}();return oe?(0,n.jsx)("div",{className:Ke().roleStyle,children:(0,n.jsx)(C.Z,{size:"small",value:(0,te.u)(ie[0],_),showSearch:!1,bordered:!1,dropdownMatchSelectWidth:!1,style:{fontSize:14,marginLeft:-10},onSelect:k,children:F==null?void 0:F.map(function(R){return(0,n.jsx)(C.Z.Option,{value:R.id,children:(0,te.u)(R.name,_)},R.id)})})}):(0,n.jsx)("span",{children:(0,te.u)(se[0].name,_)})},He=e(76742),ze=function(U){var m=U.user_info,_=(0,d.YB)(),re=_.formatMessage,z=m.first_name,M=m.last_name;return z&&M?(0,n.jsx)(E.Z.Text,{children:z+"(".concat(M,")")}):(0,n.jsx)(E.Z.Text,{children:z||M})},Fe=function(L){var U=(0,d.YB)(),m=U.formatMessage,_=L.role,re=L.keyword,z=L.refresh,M=L.onOk,F=L.roleData,se=L.match.params.ws_id,ve=(0,d.md)(),oe=(0,v.useState)({}),ie=(0,f.Z)(oe,2),k=ie[0],R=ie[1],le=(0,v.useState)(!0),g=(0,f.Z)(le,2),q=g[0],pe=g[1],A=(0,v.useState)({page_num:1,page_size:10}),ue=(0,f.Z)(A,2),de=ue[0],ye=ue[1],ce=function(){var b=(0,O.Z)((0,u.Z)().mark(function r(){var P;return(0,u.Z)().wrap(function(ee){for(;;)switch(ee.prev=ee.next){case 0:return pe(!0),ee.next=3,(0,ae.bu)((0,N.Z)((0,N.Z)({},de),{},{ws_id:se,role:_,keyword:re}));case 3:P=ee.sent,R(P),pe(!1);case 6:case"end":return ee.stop()}},r)}));return function(){return b.apply(this,arguments)}}();(0,v.useEffect)(function(){ce()},[de,re,z]);var Ee=[{title:(0,n.jsx)(d._H,{id:"member.member"}),render:function(r){return(0,n.jsxs)(me.Z,{children:[(0,n.jsx)(V.C,{src:r.user_info.avatar}),(0,n.jsx)(ze,{user_info:r.user_info}),r.user_info.is_admin?(0,n.jsx)("div",{style:{backgroundColor:"#F9AD10",borderRadius:2,fontSize:12,padding:"0 4px"},children:(0,n.jsx)("span",{style:{color:"#fff"},children:(0,n.jsx)(d._H,{id:"member.manage.tag"})})}):null,r.user_info.is_self?(0,n.jsx)(Ie.Z,{color:"rgba(140,140,140,0.1)",style:{color:"rgba(0,0,0,0.65)",marginRight:0},children:(0,n.jsx)(d._H,{id:"member.oneself"})}):null]})}},{title:(0,n.jsx)(d._H,{id:"member.account"}),render:function(r){return(0,n.jsx)(E.Z.Text,{children:r.user_info.username})}},{title:(0,n.jsx)(d._H,{id:"member.role"}),render:function(r){return(0,n.jsx)(Ne,(0,N.Z)((0,N.Z)({},r),{},{select:F,handleOk:ce,onOk:M}))}},{title:(0,n.jsx)(d._H,{id:"member.join_date"}),dataIndex:"join_date"},ve.WsBtnPermission()&&{title:(0,n.jsx)(d._H,{id:"Table.columns.operation"}),align:"center",render:function(r){return r.user_info.is_self||!r.user_info.can_update?(0,n.jsx)(fe.Z,{type:"link",disabled:!0,children:(0,n.jsx)(d._H,{id:"member.remove"})}):(0,n.jsx)(Ae.Z,{title:(0,n.jsx)(d._H,{id:"member.Are.you.sure.remove.user"}),okText:(0,n.jsx)(d._H,{id:"operation.ok"}),cancelText:(0,n.jsx)(d._H,{id:"operation.cancel"}),onConfirm:function(){return Oe(r.user_info.id)},children:(0,n.jsx)(fe.Z,{type:"link",children:(0,n.jsx)(d._H,{id:"member.remove"})})})}}].filter(Boolean),Oe=function(){var b=(0,O.Z)((0,u.Z)().mark(function r(P){var Y;return(0,u.Z)().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:return x.prev=0,x.next=3,(0,ae.A7)({ws_id:se,user_id:P});case 3:Y=x.sent,Y.code===200?(J.default.success(m({id:"operation.success"})),M()):(0,te.EV)(Y.code,Y.msg),ce(),x.next=12;break;case 8:x.prev=8,x.t0=x.catch(0),console.log(x.t0),J.default.error(m({id:"member.an.error.occurred,please.try.again"}));case 12:case"end":return x.stop()}},r,null,[[0,8]])}));return function(P){return b.apply(this,arguments)}}();return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(Ue.Z,{size:"small",loading:q,rowKey:function(r){return r.user_info.id},rowClassName:function(){return"editable-row"},columns:Ee,dataSource:k.data,pagination:!1}),(0,n.jsx)(He.Z,{pageSize:de.page_size,total:k.total,currentPage:de.page_num,onPageChange:function(r,P){return ye({page_num:r,page_size:P})}})]})},be=e(66804),Ye=e(75073),Ge=e(97207),Ve=e.n(Ge),Xe,Qe,Je=function(L){var U=(0,d.YB)(),m=U.formatMessage,_=L.match.params.ws_id,re=(0,d.md)(),z=(0,v.useState)("ws_owner"),M=(0,f.Z)(z,2),F=M[0],se=M[1],ve=(0,v.useState)(""),oe=(0,f.Z)(ve,2),ie=oe[0],k=oe[1],R=(0,v.useState)({all_count:0,ws_owner:0,ws_admin:0,ws_test_admin:0,ws_member:0}),le=(0,f.Z)(R,2),g=le[0],q=le[1],pe=(0,v.useState)([]),A=(0,f.Z)(pe,2),ue=A[0],de=A[1],ye=(0,v.useState)([]),ce=(0,f.Z)(ye,2),Ee=ce[0],Oe=ce[1],b=(0,v.useState)(!1),r=(0,f.Z)(b,2),P=r[0],Y=r[1],ee=(0,v.useState)(new Date().getTime()),x=(0,f.Z)(ee,2),Pe=x[0],ke=x[1],qe=(0,v.useState)(!1),De=(0,f.Z)(qe,2),en=De[0],xe=De[1],nn=(0,v.useState)([]),we=(0,f.Z)(nn,2),an=we[0],tn=we[1],rn=(0,v.useState)([]),Te=(0,f.Z)(rn,2),sn=Te[0],ln=Te[1],on=H.Z.useForm(),un=(0,f.Z)(on,1),Ce=un[0],Le=function(){var a=(0,O.Z)((0,u.Z)().mark(function t(){var o,s,p,i=arguments;return(0,u.Z)().wrap(function(he){for(;;)switch(he.prev=he.next){case 0:return o=i.length>0&&i[0]!==void 0?i[0]:"",he.next=3,(0,ae.tR)({keyword:o,scope:"aligroup"});case 3:s=he.sent,p=s.data,de(p);case 6:case"end":return he.stop()}},t)}));return function(){return a.apply(this,arguments)}}(),dn=function(){var a=(0,O.Z)((0,u.Z)().mark(function t(){var o,s;return(0,u.Z)().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,(0,be.Uy)({role_type:"workspace",ws_id:_,is_filter:"1"});case 2:o=i.sent,s=o.data,s&&ln(s.list);case 5:case"end":return i.stop()}},t)}));return function(){return a.apply(this,arguments)}}();(0,v.useEffect)(function(){dn()},[_]);var cn=function(){var a=(0,O.Z)((0,u.Z)().mark(function t(){var o,s;return(0,u.Z)().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,(0,be.Uy)({role_type:"workspace",ws_id:_});case 2:o=i.sent,s=o.data,s&&tn(s.list);case 5:case"end":return i.stop()}},t)}));return function(){return a.apply(this,arguments)}}();(0,v.useEffect)(function(){return cn(),function(){clearTimeout(Xe),clearTimeout(Qe)}},[P]);var mn=function(t,o){return t.replace(new RegExp("(".concat(o,")")),'<span style="color:#1890ff">$1</span>')},fn=function(t,o){return t.map(function(s){var p=s.user_info;return{value:p.last_name,label:(0,n.jsx)("div",{style:{display:"flex",justifyContent:"space-between"},children:(0,n.jsx)("div",{dangerouslySetInnerHTML:{__html:mn(p.last_name,o)}})})}})},vn=Ve().debounce(function(){var a=(0,O.Z)((0,u.Z)().mark(function t(o){var s,p;return(0,u.Z)().wrap(function(j){for(;;)switch(j.prev=j.next){case 0:if(!o){j.next=6;break}return j.next=3,(0,ae.bu)({keyword:o,ws_id:_});case 3:s=j.sent,p=s.data,Oe(p?fn(p,o):[]);case 6:case"end":return j.stop()}},t)}));return function(t){return a.apply(this,arguments)}}(),200),pn=function(t){k(t)},hn=function(){en||Ce.validateFields().then(function(){var t=(0,O.Z)((0,u.Z)().mark(function o(s){var p;return(0,u.Z)().wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return console.log(s),xe(!0),j.next=4,(0,ae.TP)((0,N.Z)({ws_id:_},s));case 4:p=j.sent,xe(!1),p.code===200?(J.default.success(m({id:"operation.success"})),Y(!1),ke(new Date().getTime())):(0,te.EV)(p.code,p.msg);case 7:case"end":return j.stop()}},o)}));return function(o){return t.apply(this,arguments)}}()).catch(function(t){console.log(t),xe(!1)})},_n=function(){return Y(!1)},gn=function(){var a=(0,O.Z)((0,u.Z)().mark(function t(){return(0,u.Z)().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:Ce.resetFields(),Y(!0),Le();case 3:case"end":return s.stop()}},t)}));return function(){return a.apply(this,arguments)}}(),Zn=[{name:"".concat(m({id:"member.ws_owner"})," ").concat(g.ws_owner),role:"ws_owner"},{name:"".concat(m({id:"member.ws_admin"})," ").concat(g==null?void 0:g.ws_admin),role:"ws_admin"},{name:"".concat(m({id:"member.ws_test_admin"})," ").concat(g==null?void 0:g.ws_test_admin),role:"ws_test_admin"},{name:"".concat(m({id:"member.ws_member"})," ").concat(g.ws_member),role:"ws_member"}],Re=function(){var a=(0,O.Z)((0,u.Z)().mark(function t(){var o,s;return(0,u.Z)().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,(0,ae.X9)({ws_id:_});case 2:o=i.sent,s=o.data,q(s);case 5:case"end":return i.stop()}},t)}));return function(){return a.apply(this,arguments)}}();(0,v.useEffect)(function(){Re()},[F,Pe]);var yn=function(t){k(""),se(t)};return(0,n.jsxs)(S.Z.Content,{children:[(0,n.jsx)(Ye.gM,{title:"".concat(m({id:"all"})," ").concat(g.all_count),extra:(0,n.jsxs)(me.Z,{children:[(0,n.jsx)(ge.Z,{dropdownMatchSelectWidth:!0,style:{width:200},options:Ee,onSelect:pn,onSearch:vn,children:(0,n.jsx)(_e.Z.Search,{placeholder:m({id:"member.search.users"}),onPressEnter:function(t){return k(t.target.value)}})}),(0,n.jsx)(d.Nv,{accessible:re.WsBtnPermission(),children:(0,n.jsx)(fe.Z,{type:"primary",onClick:gn,children:(0,n.jsx)(d._H,{id:"member.add.member"})})})]}),children:(0,n.jsx)(X.Z,{className:Se().tab_style,onChange:yn,type:"card",children:Zn.map(function(a){return(0,n.jsx)(X.Z.TabPane,{tab:a.name,children:F===a.role&&(0,n.jsx)(Fe,(0,N.Z)((0,N.Z)({refresh:Pe,role:F,keyword:ie},L),{},{roleData:sn,onOk:Re}))},a.role)})})}),P&&(0,n.jsx)(D.Z,{title:m({id:"member.add.member"}),open:P,onOk:hn,onCancel:_n,maskClosable:!1,children:(0,n.jsxs)(H.Z,{layout:"vertical",form:Ce,children:[(0,n.jsx)(H.Z.Item,{label:(0,n.jsx)(d._H,{id:"member.user"}),name:"emp_id_list",rules:[{required:!0,message:m({id:"member.please.select.user"})}],children:(0,n.jsx)(C.Z,{style:{width:"100%"},optionLabelProp:"label",className:Se().select_baseline,mode:"multiple",defaultActiveFirstOption:!1,filterOption:!1,onSearch:function(t){return Le(t)},children:ue==null?void 0:ue.map(function(a){return(0,n.jsx)(C.Z.Option,{value:a.emp_id,label:a.last_name,children:(0,n.jsxs)(h.Z,{children:[(0,n.jsx)(c.Z,{span:2,children:(0,n.jsx)(V.C,{size:25,src:a.avatar})}),(0,n.jsxs)(c.Z,{span:22,children:[(0,n.jsx)(h.Z,{children:(0,n.jsx)(me.Z,{children:(0,n.jsxs)(E.Z.Text,{children:[a.last_name,"(",a.first_name===""?a.last_name:a.first_name,") - ",a.emp_id]})})}),(0,n.jsx)(h.Z,{children:(0,n.jsx)(E.Z.Text,{children:a.job_desc})}),(0,n.jsx)(h.Z,{children:(0,n.jsx)(E.Z.Text,{children:a.dep_desc})})]})]})},a.id)})})}),(0,n.jsx)(H.Z.Item,{label:(0,n.jsx)(d._H,{id:"member.role"}),name:"role_id",rules:[{required:!0,message:m({id:"member.please.select.role"})}],children:(0,n.jsx)(C.Z,{style:{width:"100%",minHeight:32},placeholder:m({id:"member.please.select.role"}),allowClear:!0,showArrow:!0,children:an.map(function(a){return(0,n.jsx)(C.Z.Option,{value:a.id,children:(0,te.u)(a.name,m)},a.id)})})})]})})]})}},47152:function(G,I,e){"use strict";var Z=e(29700),S=e(42098),y=e(85628),D=e(68591),W=e.n(D),C=e(1155),B=e(12784),h=e(22374),K=e(53532),E=e(33821),$=e(83325),c=E.Z.Option;function w(X){return X&&X.type&&(X.type.isSelectOption||X.type.isSelectOptGroup)}var V=function(Q,me){var Me=Q.prefixCls,fe=Q.className,je=Q.popupClassName,ge=Q.dropdownClassName,Ze=Q.children,_e=Q.dataSource,ne=(0,C.Z)(Ze),J;if(ne.length===1&&(0,$.l$)(ne[0])&&!w(ne[0])){var N=(0,y.Z)(ne,1);J=N[0]}var u=J?function(){return J}:void 0,O;return ne.length&&w(ne[0])?O=Ze:O=_e?_e.map(function(T){if((0,$.l$)(T))return T;switch((0,S.Z)(T)){case"string":return h.createElement(c,{key:T,value:T},T);case"object":{var H=T.value;return h.createElement(c,{key:H,value:H},T.text)}default:return}}):[],h.createElement(K.C,null,function(T){var H=T.getPrefixCls,f=H("select",Me);return h.createElement(E.Z,(0,Z.Z)({ref:me},(0,B.Z)(Q,["dataSource"]),{prefixCls:f,popupClassName:je||ge,className:W()("".concat(f,"-auto-complete"),fe),mode:E.Z.SECRET_COMBOBOX_MODE_DO_NOT_USE},{getInputElement:u}),O)})},l=h.forwardRef(V);l.Option=c,I.Z=l},47721:function(G,I,e){"use strict";var Z=e(49132),S=e.n(Z),y=e(51812),D=e.n(y),W=e(69230)}}]);
