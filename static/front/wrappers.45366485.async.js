(self.webpackChunktone_front=self.webpackChunktone_front||[]).push([[5275],{88989:function($,E,r){"use strict";r.r(E);var b=r(35832),s=r(20418),y=r(32326),A=r(22374),l=r(24812),M=r(22812),B=r(20049),t=r(39935),I=r(526);E.default=function(R){var g=R.children,K=(0,l.TH)(),i=K.pathname,O=(0,l.$B)(),W=O.url,k=O.path,S=(0,l.UO)(),_=S.ws_id,w=(0,M.tT)("@@initialState"),D=w.initialState,o=w.setInitialState,P=D.authList,j=function(){var d=(0,y.Z)((0,b.Z)().mark(function L(){var m,c,T,n,a,u,f,C,h,v,U,Z;return(0,b.Z)().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(m=P,c=P.ws_id,!(!c||c!==_)){e.next=20;break}return o(function(p){return(0,s.Z)((0,s.Z)({},p),{},{listFetchLoading:!0,wsList:void 0})}),e.next=6,(0,B.Z9)({ws_id:_});case 6:return T=e.sent,n=T.data,o((0,s.Z)((0,s.Z)({},D),{},{authList:(0,s.Z)((0,s.Z)({},n),{},{ws_id:_}),listFetchLoading:!0})),m=n,e.next=12,(0,I.lB)(_);case 12:if(a=e.sent,o(function(p){return(0,s.Z)((0,s.Z)((0,s.Z)({},p),a),{},{listFetchLoading:!1})}),!(a!=null&&a.first_entry&&(n==null?void 0:n.ws_role_title)==="ws_owner")){e.next=17;break}return M.m8.push("/ws/".concat(_,"/workspace/initSuccess")),e.abrupt("return");case 17:if(n){e.next=20;break}return(0,t.CT)(500),e.abrupt("return");case 20:if(u=m,f=u.ws_role_title,C=u.ws_is_exist,h=u.sys_role_title,e.prev=21,!(!!~(i==null||(v=i.replace(W,k))===null||v===void 0?void 0:v.indexOf("/ws/:ws_id/device"))&&(0,t.Jq)().includes(_))){e.next=27;break}if(U=["ws_member","ws_tourist"].includes(f),Z=["sys_admin"].includes(h),!(!Z&&U)){e.next=27;break}return e.abrupt("return",(0,t.CT)(401));case 27:e.next=31;break;case 29:e.prev=29,e.t0=e.catch(21);case 31:if(C){e.next=33;break}return e.abrupt("return",(0,t.CT)(404));case 33:if(!(h!=="sys_admin"&&!f)){e.next=35;break}return e.abrupt("return",(0,t.CT)(401));case 35:case"end":return e.stop()}},L,null,[[21,29]])}));return function(){return d.apply(this,arguments)}}();return(0,A.useEffect)(function(){[404,401,500].map(function(d){return"/ws/".concat(_,"/").concat(d)}).includes(i)||j()},[i,_]),g}}}]);
